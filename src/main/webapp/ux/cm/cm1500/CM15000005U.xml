<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
			    <w2:dataList baseNode="list" id="dsUpperActbgtConfmList" repeatNode="map" saveRemovedData="true"
			        style="">
			        <w2:columnInfo>
			            <w2:column dataType="text" id="bgtItemiCd" name="공종코드"></w2:column>
			            <w2:column dataType="text" id="bgtItemiNm" name="공종명"></w2:column>
			            <w2:column dataType="text" id="upperBgtItemiCd" name="상위공종코드"></w2:column>
			            <w2:column dataType="number" id="bgtItemiLv" name="공종레벨"></w2:column>
			            <w2:column dataType="text" id="itemiYn" name="내역여부"></w2:column>
			            <w2:column dataType="text" id="sortOdr" name="정렬"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="true"></w2:data>
			    </w2:dataList>
			    <w2:dataMap baseNode="map" id="dsSearchMap" style="">
			        <w2:keyInfo>
			            <w2:key dataType="text" id="siteCd" name="현장코드"></w2:key>
			            <w2:key id="siteNm" name="현장코드명" dataType="text"></w2:key>
			            <w2:key id="publCvlGbCd" name="공사구분" dataType="text"></w2:key>
			            <w2:key id="actbgtConfmStusCd" name="진행상태" dataType="text"></w2:key>
			            <w2:key id="bzpjGbCd" name="사업구분코드" dataType="text"></w2:key>
			            <w2:key id="chgStusGbCdCnt" name="실행예산작업 추초과건수" dataType="number"></w2:key>
			            <w2:key id="delYn" name="삭제포함여부" dataType="text"></w2:key>
			            <w2:key id="actbgtConfmStusNm" name="결재진행코드명" dataType="text"></w2:key>
			            <w2:key id="fstRegprEmpno" name="결재등록시간(결재등록자)" dataType="text"></w2:key>
			            <w2:key id="chrgrEmpnoCnt" name="견적계획담당자 명수" dataType="number"></w2:key>
			            <w2:key id="firstPrgsYn" name="확정작업완료 시작유무" dataType="text"></w2:key>
			            <w2:key id="actbgtPrgsYn" name="변경결재진행건수유무" dataType="text"></w2:key>
			            <w2:key id="searhSiteNm" name="목록화면 현장명" dataType="text"></w2:key>
			            <w2:key id="searhPublCvlGbCd" name="목록화면 공사구분" dataType="text"></w2:key>
			            <w2:key id="searhActbgtConfmStusCd" name="목록화면 진행상태" dataType="text"></w2:key>
			            <w2:key id="searhBzpjGbCd" name="목록화면 사업구분코드" dataType="text"></w2:key>
			        </w2:keyInfo>
			    </w2:dataMap>
			    <w2:dataList baseNode="list" id="dsActbgtConfmList" repeatNode="map" saveRemovedData="true" style=""
			        ev:oncelldatachange="scwin.dsActbgtConfmList_oncelldatachange" ev:ondataload="scwin.dsActbgtConfmList_ondataload"
			        ev:onbeforecelldatachange="scwin.dsActbgtConfmList_onbeforecelldatachange">
			        <w2:columnInfo>
			            <w2:column id="rowStatus" name="상태값" dataType="text"></w2:column>
			            <w2:column id="chk" name="체크박스" dataType="text"></w2:column>
			            <w2:column id="gubun" name="구분" dataType="text"></w2:column>
			            <w2:column id="siteCd" name="현장코드" dataType="text"></w2:column>
			            <w2:column dataType="text" id="bgtItemiCd" name="예산내역코드"></w2:column>
			            <w2:column dataType="text" id="bgtItemiNm" name="품명"></w2:column>
			            <w2:column dataType="text" id="upperBgtItemiCd" name="상위공종코드"></w2:column>
			            <w2:column id="itemiYn" name="내역_여부" dataType="text"></w2:column>
			            <w2:column dataType="text" id="bgtItemiStdr" name="규격"></w2:column>
			            <w2:column dataType="text" id="bgtItemiUnit" name="단위"></w2:column>
			            <w2:column id="itexpGb" name="비목" dataType="text"></w2:column>
			            <w2:column id="contQty" name="도급_수량 " dataType="number"></w2:column>
			            <w2:column id="contUct" name="도급_단가" dataType="number"></w2:column>
			            <w2:column id="contAmt" name="도급_금액" dataType="number"></w2:column>
			            <w2:column id="actbgtQty" name="실행예산_수량" dataType="number"></w2:column>
			            <w2:column id="actbgtUct" name="실행예산_단가" dataType="number"></w2:column>
			            <w2:column id="actbgtAmt" name="실행예산_금액" dataType="number"></w2:column>
			            <w2:column id="actbgtRt" name="실행원가율" dataType="number"></w2:column>
			            <w2:column id="scPrItemiYn" name="계약진행여부" dataType="text"></w2:column>
			            <w2:column id="pcostQty" name="집행_원가_수량" dataType="number"></w2:column>
			            <w2:column id="pcostAmt" name="집행_원가_금액" dataType="number"></w2:column>
			            <w2:column id="rmkCn" name="비고_내용" dataType="text"></w2:column>
			            <w2:column id="stndItemiCd" name="표준_내역_코드" dataType="text"></w2:column>
			            <w2:column id="stndItemiNm" name="표준_내역_명" dataType="text"></w2:column>
			            <w2:column id="sortOdr" name="정렬_순서" dataType="number"></w2:column>

			            <w2:column id="lowCnt" name="하위레벨건수" dataType="number"></w2:column>
			            <w2:column id="bgtItemiLv" name="예산_내역_레벨" dataType="number"></w2:column>
			            <w2:column id="itemiYnNext" name="다음로우의 내역구분" dataType="text"></w2:column>
			            <w2:column id="popStndJobtypCd" name="표준공통팝업버튼" dataType="text"></w2:column>
			            <w2:column id="mngctBgtAmt" name="현장관리비 예산금액" dataType="number"></w2:column>
			            <w2:column id="workStusCd" name="작업상태코드" dataType="text"></w2:column>

			            <w2:column id="dirmgExistYn" name="직영집행승인유무" dataType="text"></w2:column>
			            <w2:column id="cntrtPoGbCd" name="자재계약발주구분코드" dataType="text"></w2:column>
			            <w2:column id="contMtrctUct" name="도급_재료비_단가" dataType="number"></w2:column>
			            <w2:column id="contMtrctAmt" name="도급_재료비_금액" dataType="number"></w2:column>
			            <w2:column id="contLbctUct" name="도급_노무비_단가" dataType="number"></w2:column>
			            <w2:column id="contLbctAmt" name="도급_노무비_금액" dataType="number"></w2:column>
			            <w2:column id="contExpnsUct" name="도급_경비_단가" dataType="number"></w2:column>
			            <w2:column id="contExpnsAmt" name="도급_경비_금액" dataType="number"></w2:column>
			            <w2:column id="actbgtMtrctUct" name="실행예산_재료비_단가" dataType="number"></w2:column>
			            <w2:column id="actbgtMtrctAmt" name="실행예산_재료비_금액" dataType="number"></w2:column>
			            <w2:column id="actbgtLbctUct" name="실행예산_노무비_단가" dataType="number"></w2:column>
			            <w2:column id="actbgtLbctAmt" name="실행예산_노무비_금액" dataType="number"></w2:column>
			            <w2:column id="actbgtExpnsUct" name="실행예산_경비_단가" dataType="number"></w2:column>
			            <w2:column id="actbgtExpnsAmt" name="실행예산_경비_금액" dataType="number"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="false"></w2:data>
			    </w2:dataList>
			    <w2:dataList baseNode="list" id="dsCdES020" repeatNode="map" saveRemovedData="true" style="">
			        <w2:columnInfo>
			            <w2:column dataType="text" id="cd" name="코드"></w2:column>
			            <w2:column dataType="text" id="cdNm" name="코드명"></w2:column>
			            <w2:column dataType="text" id="engNm" name="영문_명"></w2:column>
			            <w2:column dataType="text" id="abbNm" name="약어_명"></w2:column>
			            <w2:column dataType="text" id="upperCd" name="상위코드"></w2:column>
			            <w2:column dataType="text" id="cdLv" name="코드레벨"></w2:column>
			            <w2:column dataType="text" id="cdOdr" name="코드순서"></w2:column>
			            <w2:column dataType="text" id="charValN1" name="문자_값_1"></w2:column>
			            <w2:column dataType="text" id="charValN2" name="문자_값_2"></w2:column>
			            <w2:column dataType="text" id="charValN3" name="문자_값_3"></w2:column>
			            <w2:column dataType="text" id="charValN4" name="문자_값_4"></w2:column>
			            <w2:column dataType="text" id="charValN5" name="문자_값_5"></w2:column>
			            <w2:column dataType="text" id="nmbrValN1" name="숫자_값_1"></w2:column>
			            <w2:column dataType="text" id="nmbrValN2" name="숫자_값_2"></w2:column>
			            <w2:column dataType="text" id="nmbrValN3" name="숫자_값_3"></w2:column>
			            <w2:column dataType="text" id="nmbrValN4" name="숫자_값_4"></w2:column>
			            <w2:column dataType="text" id="nmbrValN5" name="숫자_값_5"></w2:column>
			            <w2:column dataType="text" id="useYn" name="사용유무"></w2:column>
			            <w2:column dataType="text" id="epntYn" name="말단_여부"></w2:column>
			            <w2:column dataType="text" id="commCd" name="공통코드"></w2:column>
			            <w2:column dataType="text" id="commDtlCd" name="공통상세코드"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="false"></w2:data>
			    </w2:dataList>
			    <w2:dataList baseNode="list" ev:oncelldatachange="scwin.dsActbgtConfmList_oncelldatachange"
			        id="dsActbgtConfmTotalList" repeatNode="map" saveRemovedData="true" style="">
			        <w2:columnInfo>
			            <w2:column dataType="text" id="rowStatus" name="상태값"></w2:column>
			            <w2:column dataType="text" id="siteCd" name="현장코드"></w2:column>
			            <w2:column dataType="text" id="bgtItemiCd" name="예산내역코드"></w2:column>
			            <w2:column dataType="text" id="bgtItemiNm" name="품명"></w2:column>
			            <w2:column id="bgtItemiLv" name="예산_내역_레벨" dataType="text"></w2:column>
			            <w2:column dataType="text" id="upperBgtItemiCd" name="상위공종코드"></w2:column>
			            <w2:column dataType="text" id="itemiYn" name="내역_여부"></w2:column>
			            <w2:column dataType="number" id="chgbfContAmt" name="변경전_도급_금액"></w2:column>
			            <w2:column dataType="number" id="chgbfActbgtAmt" name="변경전_실행예산_금액"></w2:column>
			            <w2:column dataType="number" id="contAmt" name="도급_금액"></w2:column>
			            <w2:column dataType="number" id="actbgtAmt" name="실행예산_금액"></w2:column>
			            <w2:column dataType="number" id="incContAmt" name="증감_도급"></w2:column>
			            <w2:column dataType="number" id="incActbgtAmt" name="증감_실행"></w2:column>
			            <w2:column id="chgbfActbgtRt" name="변경전 실행원가율" dataType="number"></w2:column>
			            <w2:column dataType="number" id="actbgtRt" name="실행원가율"></w2:column>
			            <w2:column dataType="number" id="sortOdr" name="정렬_순서"></w2:column>


			            <w2:column dataType="number" id="lowCnt" name="하위레벨건수"></w2:column>
			            <w2:column id="diff" name="금액차이여부" dataType="text"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="false"></w2:data>
			    </w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
		</xf:model>

		<script type="javascript" lazy="false"><![CDATA[
/**************************************************************************
    컬럼별 disable 처리 관련 사항.
    1. 내역에서 계약이 된 건은 모든 수정 불가.
    2. 계약이 되지 않은 건은 모든 수정 가능.
       단, 변경 전 수량이 1식인 경우는 단가만 수정가능.
           내역추가 건은 변경 전 수량이 없으므로 모든 컬럼 수정가능.
    3. 손익실행예산 컬럼들은 실행예산 컬럼이 변경되는 대로 같이 변경해준다.
       단, 계약이 된 건은 수정이 불가하기 때문에 손익도 역시 변경되지 않는다.


**************************************************************************/

/**************************************************************************
 * [1] onpageload(초기화포함)
 **************************************************************************/

    scwin.onpageload = function() {
        btnStndJob.hide();      //표준코드 사용안함에 따라 처리.
        com.selCdListVrbl("grdActbgtConfmList:itexpGb", {
            "upperCd": "CM004100",
            "setCd": "charValN1"
        });                

        //파라미터 셋팅
        dsSearchMap.setJSON(com.getAllParam());
        scwin.fnSearch(0);
        scwin.chkContColHidden_onchange();
    };

/**************************************************************************
 * [2] 사용자정의 함수
 **************************************************************************/

    //확정 작업 완료 or 시작 저장
    scwin.fnUpdateTcmActbgtConfmStart = function(sFlag) {
        dsSearchMap.set("firstPrgsYn", sFlag);
        ajaxLib.ajax("/cm/cm1500/CM15000005U/updateTcmActbgtConfmStart", {
            method: "POST",
            requestData: dsSearchMap.getJSON(),
            callback: function(result, e) {
                scwin.fnSearch(0);
            },
            errCallback: function(result, e) {
                com.showMessage("CFE0112"); //작업 중 에러가 발생하였습니다. 관리자에게 문의하십시오
            }
        });
    };

    //금액 체크 함수
    scwin.fnAmtCheck = function(info) {

        var sColumnName = grdActbgtConfmList.getColumnID(info.colID);
        var row = info.rowIndex;
        var value = info.newValue;
        var nPcostAmt = dsActbgtConfmList.getCellData(row, "pcostAmt"); //집행원가금액

        function fnPcostAmtCheck(row, sColumnName, oldValue, sumAmt){
            if (nPcostAmt > sumAmt){
                com.showMessage("CMW0098", "", "", "", grdActbgtConfmList.id, row, sColumnName);// 집행원가금액보다 적은 금액을 입력할 수 없습니다.
                dsActbgtConfmList.setCellData(row, sColumnName, oldValue); //이전 값으로 되돌린다.
                return false;
            }
            return true;
        }

        //집행금액이 0 인 경우는 체크하지 않는다.
        if ((nPcostAmt=="") || (nPcostAmt==0)){
            return true;
        } else {
            //기집행금액 이하로 수정한 것 체크..
            if (sColumnName == "contQty") {
                if (!fnPcostAmtCheck(row, sColumnName, info.oldValue, parseInt( ((value * 1000) * dsActbgtConfmList.getCellData(row, "contUct"))/1000) )){
                    return false;
                }
            } else if (sColumnName == "contUct") {
                if (!fnPcostAmtCheck(row, sColumnName, info.oldValue, parseInt( ( value * (dsActbgtConfmList.getCellData(row, "contQty")*1000))/1000) )){
                    return false;
                }
            } else if (sColumnName == "actbgtQty") {
                if (!fnPcostAmtCheck(row, sColumnName, info.oldValue, parseInt( ((value * 1000) * dsActbgtConfmList.getCellData(row, "actbgtUct"))/1000) )){
                    return false;
                }
            } else if (sColumnName == "actbgtUct") {
                if (!fnPcostAmtCheck(row, sColumnName, info.oldValue, parseInt( ( value * (dsActbgtConfmList.getCellData(row, "actbgtQty")*1000))/1000) )){
                    return false;
                }
            }
        }

        return true;
    };

/**************************************************************************
 * Event: scwin.fnInsertJSON
 * 기 능: 입력한 숫자만큼 행을 추가한다.
 **************************************************************************/
    scwin.fnInsertJSON = function(nFocusRow, sUpperBgtItemiCd, sFlag){
        
        var nThisOrd = dsActbgtConfmList.getCellData(nFocusRow, "sortOdr");  //선택한 정렬번호
        var nStdOrd = Math.ceil((nThisOrd+1)/10)*10;
        nStdOrd = (nThisOrd == nStdOrd) ? nStdOrd + 10 : nStdOrd;           //계산한 번호와 같으면 10을 더한다.
        var objAddJson = [];

        for (var i=0; i<sbxInsertRowNumber.getValue(); i++){
            var arrAddJson = {
                "siteCd": sbxSiteCd.getValue(),
                "upperBgtItemiCd": sUpperBgtItemiCd,
                "gubun": "추가",
                "itemiYn": sFlag,
                "sortOdr": nStdOrd + (i*10)
            };
            objAddJson.push(arrAddJson);
        }
        dsActbgtConfmList.insertJSON(nFocusRow + 1, objAddJson);            //insert row
    }

    //추가행 다음행부터 마지막행까지 자동순번(10 단위로 한다.)
    scwin.fnSetNextSortOrd = function(nFocusRow){
        var nUpperBgtItemiCd = dsActbgtConfmList.getCellData(nFocusRow, "upperBgtItemiCd");  //추가된 마지막행 상위공종코드
        var nStdOrd = dsActbgtConfmList.getCellData(nFocusRow, "sortOdr");                  //추가된 마지막행 정렬번호
        var arrMatchList = dsActbgtConfmList.getMatchedIndex("upperBgtItemiCd", nUpperBgtItemiCd, true, nFocusRow+1, dsActbgtConfmList.getTotalRow());
        for (var i=0; i<arrMatchList.length; i++){
            dsActbgtConfmList.setCellData(arrMatchList[i], "sortOdr", nStdOrd + ((i+1)*10));
        }
    }

/**************************************************************************
 * Event: scwin.fnInsertRow
 * 기 능: 공종, 내역 추가시 라인추가와 체크
 **************************************************************************/
    scwin.fnInsertRowCheck = function(sFlag) {

        var nFocusRow = grdActbgtConfmList.getRealRowIndex(grdActbgtConfmList.getFocusedRowIndex());
        var sItemYnNext = dsActbgtConfmList.getCellData(nFocusRow+1, "itemiYn");
        var sItemYn = dsActbgtConfmList.getCellData(nFocusRow, "itemiYn");
        var sUpperBgtItemiCd = dsActbgtConfmList.getCellData(nFocusRow, "upperBgtItemiCd");
        var sUpperBgtItemiCdNext = dsActbgtConfmList.getCellData(nFocusRow+1, "upperBgtItemiCd");
        var sBgtItemiCd = dsActbgtConfmList.getCellData(nFocusRow, "bgtItemiCd");

        if (grdActbgtConfmList.getFocusedRowIndex() < 0){
            com.showMessage("CMW0099"); //"먼저 상세내역을 선택 후 추가 버튼을 클릭하세요.
            return false;
        }

        //공종 추가일 경우
        if (sFlag == "N") {
            var arrMatchedIndex = dsActbgtConfmList.getMatchedIndex("bgtItemiCd", sUpperBgtItemiCd);
            for (i=0; i<arrMatchedIndex.length; i++){
                var sMatchItemiYn = dsActbgtConfmList.getCellData(arrMatchedIndex[i], "itemiYn");
                if (sMatchItemiYn == "Y"){
                    com.showMessage("CMW0100"); //"공종과 내역을 같이 추가할 수 없습니다."
                    return false;
                }
            }
            /*
            if (dsActbgtConfmList.getCellData(nFocusRow, "bgtItemiCd") == ""){
                com.showMessage("CMW0100"); //"공종과 내역을 같이 추가할 수 없습니다."
                return false;
            }
            */

            if (sItemYn == "Y") {
                com.showMessage("CMW0101"); //"내역에서는 공종을 추가할 수 없습니다."
                return false;
            } else if (sItemYn == "N") {
                if (sItemYnNext == "Y") {
                    com.showMessage("CMW0102"); //하위 내역이 있을 경우 공종을 추가할 수 없습니다.
                    return false;
                }
            }
        //내역 추가일 경우
        } else {
            if (sItemYn == "Y") {
                //내역에서는 무조건 내역추가 가능
            } else if (sItemYn == "N") {

                if (sBgtItemiCd == "") {
                    com.showMessage("CMW0100"); //공종과 내역을 같이 추가할 수 없습니다.
                    return false;
                } else if (sUpperBgtItemiCd == sUpperBgtItemiCdNext) {
                    //다음 로우가 같은 상위공종이면.. 즉 하위에 내역이나 공종이 없다면. 내역추가 가능
                } else {
                    if ((sItemYnNext == "N") && (sBgtItemiCd==sUpperBgtItemiCdNext)){
                        com.showMessage("CMW0103"); //하위 공종이 있을 경우 내역을 추가할 수 없습니다.
                        return false;
                    }
                }
            } else {
                //이외는 추가할 수 있음.
            }
        }
        return true;
    };
/**************************************************************************
 * Event: scwin.fnInsertRow
 * 기 능: 공종, 내역 추가
 **************************************************************************/
    scwin.fnInsertRow = function(sFlag) {

        //공종, 내역 추가시 체크사항
        if (!scwin.fnInsertRowCheck(sFlag)){
            return false;
        }

        var nFocusRow = grdActbgtConfmList.getRealRowIndex(grdActbgtConfmList.getFocusedRowIndex());
        var sItemYnNext = dsActbgtConfmList.getCellData(nFocusRow+1, "itemiYn");
        var sItemYn = dsActbgtConfmList.getCellData(nFocusRow, "itemiYn");
        var sUpperBgtItemiCdNext = dsActbgtConfmList.getCellData(nFocusRow+1, "upperBgtItemiCd");

        // "N" 공종 "Y" 내역
        if (sFlag == "N") {
            var sUpperBgtItemiCd = dsActbgtConfmList.getCellData(nFocusRow, "bgtItemiCd");
        } else {
            //선택한 행이 내역이면 같은 상위내역코드, 공종이면 공종의 내역코드를 상위내역코드로.
            if (sItemYn == "Y"){
                var sUpperBgtItemiCd = dsActbgtConfmList.getCellData(nFocusRow, "upperBgtItemiCd") ;
            }else{
                var sUpperBgtItemiCd = dsActbgtConfmList.getCellData(nFocusRow, "bgtItemiCd");
            }
        }

        scwin.fnInsertJSON(nFocusRow, sUpperBgtItemiCd, sFlag);  //행추가
        scwin.fnSetNextSortOrd(nFocusRow + Number(sbxInsertRowNumber.getValue()));  //추가된 행 이후 자동순번
        scwin.grdActbgtConfmList_updateDepthInfo();
        grdActbgtConfmList.setFocusedCell(nFocusRow, "chk", false);//선택된 ROW로 focus 이동
        //컬럼별 Disable
        for (var i=0; i<sbxInsertRowNumber.getValue(); i++){
            var nRowIndex = nFocusRow + 1 + i;

            // "N" 공종 "Y" 내역
            if (sFlag == "N") {
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "bgtItemiStdr", true);    //규격
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "bgtItemiUnit", true);    //단위
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "itexpGb", true);         //비목
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "contQty", true);         //도급예산(변경 후) 수량
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "contUct", true);         //도급예산(변경 후) 단가
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "contMtrctUct", true);    //도급_재료비_단가
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "contLbctUct", true);     //도급_노무비_단가
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "contExpnsUct", true);    //도급_경비_단가                
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "actbgtQty", true);       //실행예산(변경 후) 수량
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "actbgtUct", true);       //실행예산(변경 후) 단가
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "actbgtMtrctUct", true);  //실행예산_재료비_단가
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "actbgtLbctUct", true);   //실행예산_노무비_단가
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "actbgtExpnsUct", true);  //실행예산_경비_단가
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "rmkCn", true);           //비고
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "popStndJobtypCd", true);
            } else {
                grdActbgtConfmList.setCellReadOnly(nRowIndex, "popStndJobtypCd", true);
            }
        }

    }

    //그리드 배열 선언
    scwin.grdActbgtConfmList_depthInfo = {};

    //그리드 부모 자식 내역의 배열생성
    scwin.grdActbgtConfmList_updateDepthInfo = function() {        
        scwin.grdActbgtConfmList_depthInfo["root"] = {
            "parent": null,
            "child": []
        };
        scwin.grdActbgtConfmList_depthInfo[0] = {
            "parent": "root",
            "child": []
        };

        //버튼 컨트롤
        var sPrgsYn = dsSearchMap.get("actbgtPrgsYn");
        // 실행예산확정상태코드가 "결재중", "완료"일 경우 작업불가
        if(["CM00400404","CM00400405"].indexOf(dsSearchMap.get("actbgtConfmStusCd")) > -1) {
            var bFlag = true;
        } else {
            //로그인자와 견적담당자로 지정되어 있을 경우만 버튼 조작.
            if (dsSearchMap.get("chrgrEmpnoCnt") > 0){
                var bFlag = (sPrgsYn == "N") ? true : false;
                btnConfmPrgn.setDisabled(false);
            } else {
                var bFlag = true;
                btnConfmPrgn.setDisabled(true);
            }
        }

        btnUpperItemInsertRow.setDisabled(bFlag);
        btnItemInsertRow.setDisabled(bFlag);
        btnSave.setDisabled(bFlag);
        btnDeleteRow.setDisabled(bFlag);
        //btnStndJob.setDisabled(bFlag);        //표준코드생성 사용안함에 따라 hidden        
        btnAutoOrder.setDisabled(bFlag);

        //확정작업시작 버튼명 SETTING
        sPrgsYn == "Y" ? btnConfmPrgn.setValue("확정작업완료") : btnConfmPrgn.setValue("확정작업시작");

        //그리드 컬럼별, row 별  readonly 셋팅
        scwin.fnGridColumnControl(bFlag);
    }

    /*  그리드 컬럼별, row 별  readonly 셋팅
     */
    scwin.fnGridColumnControl = function(bFlag) {
        var totalRow = grdActbgtConfmList.getTotalRow();
        for (var i = 0; i < totalRow; i++) {
            var currentDepth = parseInt(dsActbgtConfmList.getCellData(i, "bgtItemiLv"), 10);
            var nextDepth = parseInt(dsActbgtConfmList.getCellData(i + 1, "bgtItemiLv"), 10);
            var nextParent;
            scwin.grdActbgtConfmList_depthInfo[i+1] = {
                "child": []
            };
            if (currentDepth < nextDepth) {
                nextParent = i;
            } else {
                var diff = currentDepth - nextDepth;
                nextParent = i;
                for (var st = 0; st <= diff && nextParent !== "root"; st++) {
                    nextParent = scwin.grdActbgtConfmList_depthInfo[nextParent].parent;
                }
            }
            scwin.grdActbgtConfmList_depthInfo[i+1]["parent"] = nextParent;
            scwin.grdActbgtConfmList_depthInfo[nextParent]["child"].push(i+1);

            var sScPrItemiYn = dsActbgtConfmList.getCellData(i, "scPrItemiYn");     //외주자재계약존재여부
            var sCntrtPoGbCd = dsActbgtConfmList.getCellData(i, "cntrtPoGbCd");		//자재 계약발주구분
            var nPcostAmt = dsActbgtConfmList.getCellData(i, "pcostAmt");           //집행_원가_금액
            var nMngctBgtAmt = dsActbgtConfmList.getCellData(i, "mngctBgtAmt");     //현장관리비 예산금액
            var sDirmgExistYn = dsActbgtConfmList.getCellData(i, "dirmgExistYn");   //직영집행승인유무
            var sStndItemiCd = dsActbgtConfmList.getCellData(i, "stndItemiCd");     //표준_내역_코드
            var sWorkStusCd = dsActbgtConfmList.getCellData(i, "workStusCd");       //작업상태코드

            //외주계약, 직영집행승인유무이 존재하면 내역변경 불가!
            //표준내역코드가 공동도급조정분일경우 내역변경 불가
            //확정작업 불가 상태일 경우 불가!
            if ((sScPrItemiYn == "Y") || (sDirmgExistYn == "Y") || (bFlag) ){
                grdActbgtConfmList.setRowReadOnly(i, true);
                grdActbgtConfmList.setReadOnly("cell", i, "popStndJobtypCd", true);
                grdActbgtConfmList.setCellDisabled(i, "popStndJobtypCd", true );
                
                if(sCntrtPoGbCd == "O") // 발주일 경우 실행예산 단가 변경 가능 2020.07.03 정지윤
                	grdActbgtConfmList.setReadOnly("cell", i, "actbgtUct", false);
                	

                //공종일 경우 폰트색깔을 파란색으로..
                if (dsActbgtConfmList.getCellData(i, "itemiYn") == "N") {
                    grdActbgtConfmList.setRowColor(i , "blue");
                }
            } else {            

                //하위내역이 존재할 경우 check disable
                //if (grdActbgtConfmList.getChildrenRowIndexArray(i).length > 0){
                //    grdActbgtConfmList.setDisabled("cell", i, "chk", true);
                //외주자재계약존재여부, 집행_원가, 현장관리비, 직영집행승인유무 존재경우
                if ((sScPrItemiYn == "Y") || (nPcostAmt != 0) || (nMngctBgtAmt != 0) || (currentDepth == "1")){
                    grdActbgtConfmList.setDisabled("cell", i, "chk", true);
                } else {
                    if ((sWorkStusCd != "I") && (sStndItemiCd != "") && (sStndItemiCd != "Z-0001-0001")){  //기존내역이면서 표준코드 맵핑된 내역은 삭제불가.
                        grdActbgtConfmList.setDisabled("cell", i, "chk", true);
                    }
                    //그외는 check able
                }

                //공종일 경우 금액 컬럼 수정 불가
                if (dsActbgtConfmList.getCellData(i, "itemiYn") == "N") {
                    grdActbgtConfmList.setReadOnly("cell", i, "bgtItemiStdr", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "bgtItemiUnit", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "itexpGb", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "contQty", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "contUct", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "contMtrctUct", true);    //도급_재료비_단가
                    grdActbgtConfmList.setReadOnly("cell", i, "contLbctUct", true);     //도급_노무비_단가
                    grdActbgtConfmList.setReadOnly("cell", i, "contExpnsUct", true);    //도급_경비_단가
                    grdActbgtConfmList.setReadOnly("cell", i, "actbgtQty", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "actbgtUct", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "actbgtMtrctUct", true);  //실행예산_재료비_단가
                    grdActbgtConfmList.setReadOnly("cell", i, "actbgtLbctUct", true);   //실행예산_노무비_단가
                    grdActbgtConfmList.setReadOnly("cell", i, "actbgtExpnsUct", true);  //실행예산_경비_단가
                    grdActbgtConfmList.setReadOnly("cell", i, "rmkCn", true);
                    grdActbgtConfmList.setReadOnly("cell", i, "popStndJobtypCd", true);
                    grdActbgtConfmList.setCellDisabled(i, "popStndJobtypCd", true );
                    grdActbgtConfmList.setRowColor(i , "blue");
                }
            }
        }
    }

    /** 표준내역코드 조회 팝업 후처리 **/
    scwin.popStndJobtypCdCallback = function(obj) {        
        dsActbgtConfmList.setRowJSON(grdActbgtConfmList.getFocusedRowIndex(), {
                "stndItemiCd": obj.stndItemiCd,
                "stndItemiNm": obj.stndItemiNm
            },
            true
        );
    };

    /** 표준내역생성 팝업 후처리 **/
    scwin.popStndJobtypCdCreateCallback = function(obj) {
        ajaxLib.ajax("/cm/cm1500/CM15000005U/insertTcmActbgtConfmStndJob", {
            method: "post",
            requestData: {
               tcmActbgtConfmVOs: obj,
               siteCd: dsSearchMap.get("siteCd")
            },
            callback: function(result, e) {
                com.showMessage("CFA0012"); //저장되었습니다.
                scwin.fnSearch(0);
            },
            errCallback: function(result, e) {
                com.showMessage("CFE0112"); //작업 중 에러가 발생하였습니다. 관리자에게 문의하십시오
            }
        });

    };

    //표준공종 call
    /* 표준화면호출  예시
        var popOps = {
            popup_name :"표준내역",
            url :"/ux/cm/cm1500/CM15000015P.xml",
            data : {
                multiSelectYn: true,    --> 표준공종 멀티셀렉트 여부 true, false
                actbgtGb : "A",         --> 가실행내역 "T", 실행예산확정작업 "A"
                siteCd : dsSearchMap.get( "siteCd" ) --> 현장코드
            },
            widType:"L",
            height:"678",
            callbackFn : "scwin.popStndJobtypCdCallback"
        };
        com.popup_open(popOps);
    */
    scwin.fnStndJobCall = function(data, callback) {
        var popOps = {
            popup_name: "표준내역",
            url: "/ux/cm/cm1500/CM15000015P.xml",
            data: data,
            widType: "L",
            height: "678",
            callbackFn: callback
        };
        com.popup_open(popOps);
    };

    /*  저장 ajax */
    scwin.fnSave = function(nLastFocusIndex) {
        ajaxLib.ajax("/cm/cm1500/CM15000005U/saveTcmActbgtConfm", {
            method: "POST",
            requestData: {
               "tcmActbgtConfmVOs": dsActbgtConfmList.getModifiedJSON(true)
            },
            callback: function(result, e) {
                com.showMessage("CFA0012"); //"저장되었습니다."
                scwin.fnSearch(nLastFocusIndex);
            },
            errCallback: function(result, e) {
                com.showMessage("CFE0112"); //작업 중 에러가 발생하였습니다. 관리자에게 문의하십시오
            }
        });
    };

    //저장시 validation 체크
    scwin.fnValidationCheck = function(){
        var bResult = true;
        var arrList = dsActbgtConfmList.getModifiedIndex();
        var sTargetColId = null, sTargetColNm = null;
        for (var i = 0; i < arrList.length; i++) {
            var obj = dsActbgtConfmList.getRowJSON(arrList[i]);
            //1. 변경된 데이터 validation [status : C,U 만해당]
            if (obj.rowStatus == "C" || obj.rowStatus == "U") {
                if (obj.itemiYn == "Y") {//내역여부
                    if (obj.bgtItemiNm == "") {
                        sTargetColId = "bgtItemiNm";
                        sTargetColNm = "품명";
                    } else if (obj.bgtItemiUnit == "") {
                        sTargetColId = "bgtItemiUnit";
                        sTargetColNm = "단위";
                    } else if (obj.sortOdr == "") {
                        sTargetColId = "sortOdr";
                        sTargetColNm = "정렬순서";
                    }
                } else {//공종
                    if (obj.bgtItemiNm == "") {
                        sTargetColId = "bgtItemiNm";
                        sTargetColNm = "품명";
                    } else if (obj.sortOdr == "") {
                        sTargetColId = "sortOdr";
                        sTargetColNm = "정렬순서";
                    }
                }

                if (sTargetColId != null) {
                    com.showMessage("SAA0043", sTargetColNm, "", "", grdActbgtConfmList.id, arrList[i], sTargetColId);//$1은(는) 필수입력사항입니다.
                    bResult = false;
                    break;
                }

            }
        }
        return bResult;
    }

    //조회
    scwin.fnSearch = function(nLastFocusIndex) {
        if (tacActbgtConfm.getSelectedTabID() == "tabActbgtConfm"){
            dsActbgtConfmList.removeAll();
            ajaxLib.ajax("/cm/cm1500/CM15000005U/selectUpperActbgtConfmList", {
                method: "POST",
                requestData: dsSearchMap.getJSON(),
                callback: function(result, e) {
                    dsUpperActbgtConfmList.setJSON(result.data.upperTcmActbgtConfmList);
                    dsSearchMap.setJSON(result.data.selectActbgtPrgsYn);
                    dsSearchMap.set("fstRegprEmpno", result.data.selectActbgtPrgsYn.fstRegDtm + "   " +
                                                     result.data.selectActbgtPrgsYn.fstRegprEmpnm);

                    dsActbgtConfmList.setJSON(result.data.selectActbgtConfmList);
                    com.setUdcValue("dsActbgtConfmListCount", "udcListCount", dsActbgtConfmList.getRowCount());
                    grdActbgtConfmList.setFocusedCell(nLastFocusIndex, "chk", false);//선택된 ROW로 focus 이동
                },
                errCallback: function(result, e) {
                    com.showMessage("CFE0112"); //작업 중 에러가 발생하였습니다. 관리자에게 문의하십시오
                }
            });
        } else {    //tabActbgtConfmTotal
            dsActbgtConfmTotalList.removeAll();
            ajaxLib.ajax("/cm/cm1500/CM15000005U/selectUpperActbgtConfmTotalList", {
                method: "POST",
                requestData: dsSearchMap.getJSON(),
                callback: function(result, e) {
                    dsActbgtConfmTotalList.setJSON(result.data);
                    com.setUdcValue("dsActbgtConfmTotalListCount", "udcListCount", dsActbgtConfmTotalList.getTotalRow());

                    for (var i=0; i < dsActbgtConfmTotalList.getTotalRow(); i++ ){
                        if (dsActbgtConfmTotalList.getCellData(i , "diff") == "F") {
                            grdActbgtConjfmTotalList.setRowColor(i , "red");
                        }
                    }
                },
                errCallback: function(result, e) {
                    com.showMessage("CFE0112"); //작업 중 에러가 발생하였습니다. 관리자에게 문의하십시오
                }
            });
        }
    };

/**************************************************************************
 * [5] Event 정의
 **************************************************************************/

/**************************************************************************
 * Event: scwin.btnFind_onclick()
 * 기 능: 조회버튼 클릭 이벤트
 **************************************************************************/
    scwin.btnFind_onclick = function() {
        scwin.fnSearch(0);
    };

/**************************************************************************
 * Event: scwin.tacActbgtConfm_ontabclick
 * 기 능: 탭 클릭 이벤트
 **************************************************************************/
	scwin.tacActbgtConfm_ontabclick = function(tabID,idx) {
        if( tacActbgtConfm.isLoaded(idx) ) {
            com.commonUI();
        }
	};

/**************************************************************************
 * Event: scwin.tacActbgtConfm_onchange
 * 기 능: 탭 변경 이벤트
 **************************************************************************/
    scwin.tacActbgtConfm_onchange = function(tabID,idx,userTabID) {
        if (userTabID == "tabActbgtConfmTotal"){
            scwin.fnSearch();
        }
    };

/**************************************************************************
 * Event: scwin.trvUpperActbgtConfm_onlabelclick
 * 기 능: 트리 라벨 클릭 이벤트
 **************************************************************************/
	scwin.trvUpperActbgtConfm_onlabelclick = function(value,nodeElement,index) {
        var nIndex = dsActbgtConfmList.getMatchedIndex("bgtItemiCd", value, true, 0, dsActbgtConfmList.getTotalRow());
        if (btnDrillSpanAll.getValue() == "전체 펼치기"){
            scwin.btnDrillSpanAll_onclick();
        }
        grdActbgtConfmList.setFocusedCell(nIndex, 0, false);
	};


/**************************************************************************
 * Event: scwin.btnDeleteRow_onclick
 * 기 능: 그리드 행삭제 클릭 이벤트
 **************************************************************************/
	scwin.btnDeleteRow_onclick = function() {
        var chkArr = grdActbgtConfmList.getCheckedIndex("chk");
        dsActbgtConfmList.removeRows(chkArr);
	};

/**************************************************************************
 * Event: scwin.btnUpperItemInsertRow_onclick
 * 기 능: 공종 추가 클릭 이벤트
 **************************************************************************/
    scwin.btnUpperItemInsertRow_onclick = function() {

        if (grdActbgtConfmList.getFocusedRowStatus() == "C"){
            com.showMessage("CMW0104"); //추가된 공종에서 하위공종을 추가할 수 없습니다. \n 저장한 후 하위공종을 추가하세요.
            return false;
        }
        scwin.fnInsertRow("N");
    };

/**************************************************************************
 * Event: scwin.btnItemInsertRow_onclick
 * 기 능: 그리드 내역추가 클릭 이벤트
 **************************************************************************/
	scwin.btnItemInsertRow_onclick = function() {
        scwin.fnInsertRow("Y");
	};

/**************************************************************************
 * Event: scwin.btnItemInsertRow_onclick
 * 기 능:  확정작업시작 버튼 클릭 이벤트
 **************************************************************************/
	scwin.btnConfmPrgn_onclick = function() {

        //변경결재 진행여부 건수 체크
        ajaxLib.ajax("/cm/cm1500/CM15000005U/selectAprvPrgsCnt", {
            method: "POST",
            requestData: dsSearchMap.getJSON(),
            callback: function(result, e) {

                if (result.data > 0){
                    com.showMessage("CMW0126"); //실행예산 변경 결재 진행 중인 건이 있습니다. \n 결재완료 후 진행할 수 있습니다.
                    return false;
                }
                
                var sPrgsYn = dsSearchMap.get( "actbgtPrgsYn" );
                //확정작업 시작할 경우
                if (sPrgsYn == "N") {

                    if (dsActbgtConfmList.getTotalRow() <= 0){
                        // 가실행예산을 진행하지 않은 현장.
                        com.showMessage("CMW0157"); //가실행예산확정을 진행하지 않은 현장입니다. 먼저 가실행예산을 진행해주세요.
                    } else if (dsSearchMap.get("chgStusGbCdCnt" ) <= 0) {
                        //최초 작업시 .. 실행예산 확정 테이블에 데이터가 없을 경우 데이터 insert.
                        if (confirm("실행예산 확정작업을 시작하시겠습니까?")) {
                            dsSearchMap.set( "actbgtPrgsYn", "Y" );
                            btnConfmPrgn.setValue( "확정작업완료" );
                            scwin.fnUpdateTcmActbgtConfmStart("N");
                        }
                    } else {
                        //추초과 작업 건 여부 체크

                        //재작업 여부 확인.
                        if (confirm("변경된 실행예산 자료가 존재합니다. \n 확정작업을 재시작하시겠습니까?" +
                                    "\n (변경된 부분은 집계표 탭에서 확인하십시오)")) {
                            dsSearchMap.set("actbgtPrgsYn", "Y");
                            btnConfmPrgn.setValue("확정작업완료");
                            scwin.fnUpdateTcmActbgtConfmStart("Y");
                        }
                    }

                //확정작업 종료할 경우
                } else {

                    if (confirm("실행예산 확정작업을 완료 하시겠습니까?")) {
                        dsSearchMap.set("actbgtPrgsYn", "N");
                        btnConfmPrgn.setValue("확정작업시작");

                        ajaxLib.ajax("/cm/cm1500/CM15000005U/updateTcmAcgbgtPrgsYn", {
                            method: "post",
                            requestData: dsSearchMap.getJSON(),
                            callback: function(result, e) {
                                com.showMessage("CFA0016", "확정작업"); //완료되었습니다.
                                scwin.fnSearch();
                            },
                            errCallback: function(result, e) {
                                com.showMessage("CFE0112"); //작업 중 에러가 발생하였습니다. 관리자에게 문의하십시오
                            }
                        });
                    };
                }
            },
            errCallback: function(result, e) {
                com.showMessage("CFE0112"); //작업 중 에러가 발생하였습니다. 관리자에게 문의하십시오
            }
        });

	};

/**************************************************************************
 * Event: scwin.btnItemInsertRow_onclick
 * 기 능:  확정작업시작 버튼 클릭 이벤트
 **************************************************************************/
	scwin.btnExcelDwn_onclick = function() {
		grdActbgtConfmList.advancedExcelDownload({
            fileName: "실행예산확정작업.xlsx",
            removeColumns: "0",
            useSubTotal : true,             // Sub-Total 표시 
            headerFontColor : "#FFFFFF",    // Header Font Color
            headerColor : "#D9D9D9",        // Header Back Color
            subTotalColor : "#FCE4D6",      // SubTotal Back Color
            footerColor : "#BDD7EE"         // Footer Color
        });
	};

/**************************************************************************
 * Event: scwin.sbxInsertRowNumber_onchange
 * 기 능:  라인 추가용 숫자 inputbox 변경 이벤트
 **************************************************************************/
	scwin.sbxInsertRowNumber_onchange = function() {
        if (sbxInsertRowNumber.getValue() <= 0){
            sbxInsertRowNumber.setValue(1);
        }
	};

/**************************************************************************
 * Event: scwin.btnSave_onclick
 * 기 능:  저장 클릭 이벤트
 **************************************************************************/
	scwin.btnSave_onclick = function() {
        if (scwin.fnValidationCheck()){
            if (confirm("저장 하시겠습니까?")) {
                nLastFocusIndex = grdActbgtConfmList.getFocusedRowIndex();  //마지막 그리드 포커스
                scwin.fnSave(nLastFocusIndex);
            }
        }
	};

    //엑셀다운로드
	scwin.btnExcelDwnTotal_onclick = function() {
        grdActbgtConjfmTotalList.advancedExcelDownload({
             fileName: "실행예산_확정작업_집계표.xlsx"
            , useSubTotal : true             // Sub-Total 표시 
            , headerFontColor : "#FFFFFF"    // Header Font Color
            , headerColor : "#D9D9D9"        // Header Back Color
            , subTotalColor : "#FCE4D6"      // SubTotal Back Color
            , footerColor : "#BDD7EE"         // Footer Color
        });
            
	};

    // 체크박스 클릭 시 하위 레벨도 체크
    scwin.fnChkEvent = function(info) {
        var row = dsActbgtConfmList.getRealRowIndex(info.rowIndex);
        var cur_val = info.newValue;
        var cur_depth = dsActbgtConfmList.getCellData(row, "bgtItemiLv");
        var row_cnt = dsActbgtConfmList.getTotalRow();
        var sBgtItemiCd = dsActbgtConfmList.getCellData(row, "bgtItemiCd");

        //저장하지 않은 신규행은 부모,자식이 아직 없으므로 제외.
        if (sBgtItemiCd == "") {
            return;
        }

        //선택한 row 의 하위레벨 체크 및 해제
        for(var ix=1; Number(dsActbgtConfmList.getCellData(row+ix, "bgtItemiLv")) > cur_depth; ix++){
            dsActbgtConfmList.setCellData(row+ix, "chk", cur_val);
            if(row+ix > row_cnt-1) break;
        }

        //체크하는 경우는 하위로직 필요없음.
        if (cur_val == "1"){
            return;
        }

        var sUpperBgtItemiCd = dsActbgtConfmList.getCellData(row, "upperBgtItemiCd");
        var arrMatchList = dsActbgtConfmList.getMatchedIndex("upperBgtItemiCd", sUpperBgtItemiCd, true, 0, dsActbgtConfmList.getTotalRow());
        var nCnt = 0;
        //선택한 행이 같은 부모행을 같은 자식들이 체크가 되어있는 행 체크
        for (var i=0; i<arrMatchList.length; i++){
            if (dsActbgtConfmList.getCellData(i, "chk") == "1"){
                var nCnt = nCnt++;
            }
            if (nCnt > 0) {
                return;
            }
        }

        //선택한 행이 같은 부모행을 같은 자식들이 하나라도 체크가 해제되어 있을 경우 최상위 부모레벨들은 체크해제
        for (var nRow = scwin.grdActbgtConfmList_depthInfo[row].parent; nRow !== "root"; nRow = scwin.grdActbgtConfmList_depthInfo[nRow].parent) {
            if(dsActbgtConfmList.getCellData(nRow, "itemiYn") == "N" && dsActbgtConfmList.getCellData(nRow, "gubun") == ""){
                var sUpperBgtItemiCd = dsActbgtConfmList.getCellData(nRow, "upperBgtItemiCd");
                var arrMatchList = dsActbgtConfmList.getMatchedIndex("upperBgtItemiCd", sUpperBgtItemiCd, true, 0, dsActbgtConfmList.getTotalRow());

                if (arrMatchList > 1) break;

                //상위레벨이 disable 아닐 경우만 체크 및 해제
                if (!grdActbgtConfmList.getCellDisabled(nRow, "chk")){
                    dsActbgtConfmList.setCellData(nRow, "chk", cur_val);
                }
            }
        }
    };

/**************************************************************************
 * Event: scwin.grdActbgtConfmList_oncellclick
 * 기 능: 그리드 oncellclick
 **************************************************************************/
	scwin.grdActbgtConfmList_oncellclick = function(row,col) {
        var sColumnName = grdActbgtConfmList.getColumnID( col );
        if (sColumnName == "popStndJobtypCd") {
            scwin.fnStndJobCall({
                    multiSelectYn: false,
                    bgtNewAddYn: "Y",
                    siteCd: dsSearchMap.get("siteCd")
                },
                "scwin.popStndJobtypCdCallback"
            );
        }
	};

/**************************************************************************
 * Event: scwin.btnStndJob_onclick
 * 기 능: 표준내역생성 버튼 클릭
 **************************************************************************/
	scwin.btnStndJob_onclick = function() {
        scwin.fnStndJobCall({
                multiSelectYn: true,
                actbgtGb: "A",
                siteCd: dsSearchMap.get( "siteCd" )
            },
            "scwin.popStndJobtypCdCreateCallback"
        );
	};

    //하위내역으로 상위공종들의 합계산 .. 속도상 사용하지 않고 SP로 조회변경.
	scwin.dsActbgtConfmList_ondataload = function() {
        scwin.grdActbgtConfmList_updateDepthInfo();
        dsActbgtConfmList.initRowStatus();
	};

    //목록 버튼 클릭
	scwin.btnList_onclick = function() {
        com.detailOpen("실행예산확정작업", "CM15000000", "/ux/cm/cm1500/CM15000000U.xml", "1", {
            siteNm: dsSearchMap.get("searhSiteNm"),
            publCvlGbCd: dsSearchMap.get("searhPublCvlGbCd"),
            actbgtConfmStusCd: dsSearchMap.get("searhActbgtConfmStusCd"),
            bzpjGbCd: dsSearchMap.get("searhBzpjGbCd"),
            listSearchYn: "Y"
        });
	};

    //동일레벨 자동순번 클릭
	scwin.btnAutoOrder_onclick = function() {

        if (grdActbgtConfmList.getFocusedRowIndex() < 0){
            com.showMessage("CMW0105"); //"먼저 내역을 선택하세요."
            return false;
        } else if (grdActbgtConfmList.getFocusedRowIndex() == 0){
            com.showMessage("CMW0022"); //"최상위 공종 기준으로 자동순번 처리할 수 없습니다."
            return false;
        }

        if (confirm("포커스된 내역의 같은 공종(내역)기준으로 \n 자동 순번 처리 하시겠습니까?")) {
            var nUpperBgtItemiCd = dsActbgtConfmList.getCellData(grdActbgtConfmList.getFocusedRowIndex(), "upperBgtItemiCd");
            var arrMatchList = dsActbgtConfmList.getMatchedIndex("upperBgtItemiCd", nUpperBgtItemiCd, true, 0, dsActbgtConfmList.getTotalRow());

            //포커스된 상위내역코드와 같은 내역을 기준으로 순번 처리
            for (var i=0; i<arrMatchList.length; i++){
                dsActbgtConfmList.setCellData(arrMatchList[i], "sortOdr", (i+1)*10);
            }
        }

	};

    //탭 onbeforeselect 이벤트
	scwin.tacActbgtConfm_onbeforeselect = function(selectedIndex,index) {
        if (tacActbgtConfm.getSelectedTabID() == "tabActbgtConfm"){
            if (dsActbgtConfmList.getModifiedIndex().length > 0) {
                if (confirm("변경된 자료가 존재합니다. 작업사항을 저장 하시겠습니까?")){
                    scwin.fnSave();
                    return false;
                }
            }
        }
        return;
	};

    //전체 펼치기, 접기
	scwin.btnTreeSpanAll_onclick = function() {
        if (btnTreeSpanAll.getValue() == "전체 펼치기"){
            btnTreeSpanAll.setValue("전체 접기");
            trvUpperActbgtConfm.spanAll(true);
        } else {
            btnTreeSpanAll.setValue("전체 펼치기");
            trvUpperActbgtConfm.spanNode({depth:2}, false);
        }
	};

    //내역에서부터 상위공종 금액 계산
    function fnUpperAmtSum(changeColName, currentRow, diffValue){
        for (var nRow = scwin.grdActbgtConfmList_depthInfo[currentRow].parent; nRow !== "root"; nRow = scwin.grdActbgtConfmList_depthInfo[nRow].parent) {
            if(dsActbgtConfmList.getCellData( nRow , "itemiYn" ) == "N" && dsActbgtConfmList.getCellData( nRow , "gubun" ) == ""){
                var nUpdateAmt = Number(dsActbgtConfmList.getCellData(nRow, changeColName)) + Number(diffValue);          //증가된 금액
                dsActbgtConfmList.setCellData(nRow, changeColName, nUpdateAmt);                           //상위공종에 증가된 금액 +
                dsActbgtConfmList.modifyRowStatus(nRow , "R");  //합산으로 변경된 row 는 상태값 초기화
            }
        }
        return true;
    }

	scwin.dsActbgtConfmList_oncelldatachange = function(info) {

        let sColumnName = grdActbgtConfmList.getColumnID(info.colID);
        
        let arrCols = ["contQty", "contMtrctUct", "contLbctUct", "contExpnsUct", 
                        "actbgtQty", "actbgtMtrctUct", "actbgtLbctUct", "actbgtExpnsUct"];

        var row = info.rowIndex;
        var value = info.newValue == "" ? 0 : info.newValue;        
        
        if (arrCols.indexOf(sColumnName) >= 0) {//도급수량, 도급(재노경) 단가, 실행예산 수량, 실행(재노경) 단가
    
            // 숫자의 경우 "," 제거
            if (typeof(info.newValue) == "string"){
                value = info.newValue.replaceAll(",","");
                info.newValue = value;
                dsActbgtConfmList.setCellData(row, sColumnName, value);
            }    
    
            // 이전 금액이 0 인 이상인 경우만 체크
            if (info.oldValue > 0){
    
                //실행예산 변경시 현장관리비 예산금액 이하로 수정 못하도록 체크.
                if (["actbgtUct", "actbgtQty"].indexOf(sColumnName) > -1) {
                    var nMngctBgtAmt = dsActbgtConfmList.getCellData(row, "mngctBgtAmt");
                    var nActbgtQty = dsActbgtConfmList.getCellData(row, "actbgtQty");
                    var nActbgtUct = dsActbgtConfmList.getCellData(row, "actbgtUct");
    
                    if (nMngctBgtAmt > 0) {
                        if (nMngctBgtAmt > Math.floor(nActbgtQty * nActbgtUct)){
                            dsActbgtConfmList.setCellData(row, sColumnName, info.oldValue);
                            com.showMessage("CMW0097", "", "", "", grdActbgtConfmList.id, row, sColumnName); //"현장관리비 금액 이하로 수정할 수 없습니다.
                            return false;
                        }
                    }
                }
    
                //기집행금액 이하로 수정한 것 체크.
                if (!scwin.fnAmtCheck(info)){
                    return false;
                }
            }
    
            //수량, 단가 변경시 금액 컬럼 합산.            
            let nTmpAmt = 0; 
            let nOldValue = info.oldValue == "" ? 0 : info.oldValue;
            let diffAmt = parseFloat(value) - parseFloat(nOldValue);
            
            if (sColumnName.indexOf("cont") == 0) {              //도급 관련 컬럼의 경우 
            
                let nContMtrctUct = dsActbgtConfmList.getCellData(row, "contMtrctUct");         //도급재료비계산
                let nContLbctUct = dsActbgtConfmList.getCellData(row, "contLbctUct");           //도급노무비계산
                let nContExpnsUct = dsActbgtConfmList.getCellData(row, "contExpnsUct");         //도급경비단가        
            
                if (sColumnName == "contQty") {                         //도급예산수량                                           
                    nTmpAmt = ((value * 1000) * nContMtrctUct) / 1000;  //도급재료비계산
                    dsActbgtConfmList.setCellData(row, "contMtrctAmt", parseInt(nTmpAmt.toFixed(2)) );
                    
                    nTmpAmt = ((value * 1000) * nContLbctUct) / 1000;   //도급노무비계산
                    dsActbgtConfmList.setCellData(row, "contLbctAmt", parseInt(nTmpAmt.toFixed(2)) );
                    
                    nTmpAmt = ((value * 1000) * nContExpnsUct) / 1000;  //도급경비계산     
                    dsActbgtConfmList.setCellData(row, "contExpnsAmt", parseInt(nTmpAmt.toFixed(2)) );        
                } else if (sColumnName == "contMtrctUct") {             //도급재료비단가
                    nTmpAmt = (value * (dsActbgtConfmList.getCellData(row, "contQty") * 1000)) / 1000;
                    dsActbgtConfmList.setCellData( row , "contMtrctAmt", parseInt(nTmpAmt.toFixed(2)) );
                } else if (sColumnName == "contLbctUct") {              //도급노무비단가
                    nTmpAmt = (value * (dsActbgtConfmList.getCellData(row, "contQty") * 1000)) / 1000;
                    dsActbgtConfmList.setCellData( row , "contLbctAmt", parseInt(nTmpAmt.toFixed(2)) );
                } else if (sColumnName == "contExpnsUct") {             //도급경비단가
                    nTmpAmt = (value * (dsActbgtConfmList.getCellData(row, "contQty") * 1000)) / 1000;
                    dsActbgtConfmList.setCellData( row , "contExpnsAmt", parseInt(nTmpAmt.toFixed(2)) );
                }    
    
                //도급 합단가, 합금액 계산               
                dsActbgtConfmList.setCellData(row, "contUct", nContMtrctUct + nContLbctUct + nContExpnsUct);    //도급단가계산
                                
                let nContMtrctAmt = dsActbgtConfmList.getCellData(row, "contMtrctAmt");       //도급재료비금액
                let nContLbctAmt = dsActbgtConfmList.getCellData(row, "contLbctAmt");         //도급노무비금액
                let nContExpnsAmt = dsActbgtConfmList.getCellData(row, "contExpnsAmt");       //도급경비금액                 
                dsActbgtConfmList.setCellData(row, "contAmt", nContMtrctAmt + nContLbctAmt + nContExpnsAmt);      //도급금액계산   
                
            } else if (sColumnName.indexOf("actbgt") == 0) {            //실행예산 관련 컬럼의 경우 
            
                let nActbgtMtrctUct = dsActbgtConfmList.getCellData(row, "actbgtMtrctUct");     //실행재료비단가
                let nActbgtLbctUct = dsActbgtConfmList.getCellData(row, "actbgtLbctUct");       //실행노무비단가
                let nActbgtExpnsUct = dsActbgtConfmList.getCellData(row, "actbgtExpnsUct");     //실행경비단가            
            
                if (sColumnName == "actbgtQty") {                   //실행예산수량
                                    
                    nTmpAmt = ((value * 1000) * nActbgtMtrctUct) / 1000;    //도급재료비계산
                    dsActbgtConfmList.setCellData( row , "actbgtMtrctAmt" , parseInt(nTmpAmt.toFixed(2)) );
                    
                    nTmpAmt = ((value * 1000) * nActbgtLbctUct) / 1000;     //도급노무비계산
                    dsActbgtConfmList.setCellData( row , "actbgtLbctAmt" , parseInt(nTmpAmt.toFixed(2)) );
                    
                    nTmpAmt = ((value * 1000) * nActbgtExpnsUct) / 1000;    //도급경비계산
                    dsActbgtConfmList.setCellData( row , "actbgtExpnsAmt" , parseInt(nTmpAmt.toFixed(2)) );                    
                
                } else if (sColumnName == "actbgtMtrctUct") {       //실행재료비단가
                    nTmpAmt = (value * (dsActbgtConfmList.getCellData( row , "actbgtQty" ) * 1000)) / 1000;
                    dsActbgtConfmList.setCellData( row , "actbgtMtrctAmt", parseInt(nTmpAmt.toFixed(2)) );
                } else if (sColumnName == "actbgtLbctUct") {        //실행노무비단가
                    nTmpAmt = (value * (dsActbgtConfmList.getCellData( row , "actbgtQty" ) * 1000)) / 1000;
                    dsActbgtConfmList.setCellData( row , "actbgtLbctAmt", parseInt(nTmpAmt.toFixed(2)) );
                } else if (sColumnName == "actbgtExpnsUct") {       //실행경비단가
                    nTmpAmt = (value * (dsActbgtConfmList.getCellData( row , "actbgtQty" ) * 1000)) / 1000;
                    dsActbgtConfmList.setCellData( row , "actbgtExpnsAmt", parseInt(nTmpAmt.toFixed(2)) );
                }   
                
                //실행 합단가, 합금액 계산               
                dsActbgtConfmList.setCellData(row, "actbgtUct", nActbgtMtrctUct + nActbgtLbctUct + nActbgtExpnsUct);     //실행단가계산
                
                let nActbgtMtrctAmt = dsActbgtConfmList.getCellData(row, "actbgtMtrctAmt");       //실행재료비금액
                let nActbgtLbctAmt = dsActbgtConfmList.getCellData(row, "actbgtLbctAmt");         //실행노무비금액
                let nActbgtExpnsAmt = dsActbgtConfmList.getCellData(row, "actbgtExpnsAmt");       //실행경비금액                 
                dsActbgtConfmList.setCellData(row, "actbgtAmt", nActbgtMtrctAmt + nActbgtLbctAmt + nActbgtExpnsAmt);      //실행금액계산                                  
            }
       
            let nContAmt = dsActbgtConfmList.getCellData(row, "contAmt");
            let nActbgtAmt = dsActbgtConfmList.getCellData(row, "actbgtAmt");
            let nActbgtRt = 0;
    
            //실행원가율
            if ((nActbgtAmt == "0") || (nActbgtAmt == "")) {
                nActbgtRt = 0.00;
            } else if ((nContAmt == "0") || (nContAmt == "")) {
                nActbgtRt = 100.00;
            } else {
                nActbgtRt = parseInt((nActbgtAmt / nContAmt) * 100);
            }
            dsActbgtConfmList.setCellData(row, "actbgtRt", nActbgtRt);
        //금액 컬럼은 공종 합산 처리.        
        } else if(["contAmt", "contMtrctAmt", "contLbctAmt", "contExpnsAmt", 
                "actbgtAmt", "actbgtMtrctAmt", "actbgtLbctAmt", "actbgtExpnsAmt"].indexOf(sColumnName) >= 0   ){//도급금액, 실행예산금액
        
            if(dsActbgtConfmList.getCellData( row , "itemiYn" ) == "Y"){//내역  
                let diffAmt = Number(info.newValue) - Number(info.oldValue);              
                fnUpperAmtSum(sColumnName, row, diffAmt);
            }
        } 
	};

    //그리드 전체 펼치기, 접기 클릭
	scwin.btnDrillSpanAll_onclick = function() {
        if (dsActbgtConfmList.getTotalRow() <= 0) {
            return false;
        }

        if (btnDrillSpanAll.getValue() == "전체 펼치기"){
            btnDrillSpanAll.setValue("전체 접기");
            grdActbgtConfmList.spanAll(true);
        } else {
            btnDrillSpanAll.setValue("전체 펼치기");
            grdActbgtConfmList.spanAll(2);
        }
	};

	scwin.grdActbgtConfmList_onviewchange = function(info) {
        var sColumnName = grdActbgtConfmList.getColumnID(info.colIndex);
        if("chk" == sColumnName){
            scwin.fnChkEvent(info);// 체크박스 클릭 시 하위 레벨도 체크
        }
	};

    //도급예산 숨김 클릭
    scwin.chkContColHidden_onchange = function() {
        var vChk = chkContColHidden.getValue() === "N" ? true : false;
        var arrColumnList = ["contQty", "contMtrctUct", "contMtrctAmt", "contLbctUct", "contLbctAmt", "contExpnsUct", 
                            "contExpnsAmt", "contUct", "contAmt"];        
        arrColumnList.forEach(function(item, index, array){
            grdActbgtConfmList.setColumnVisible(item, vChk);
        });
    };    
	]]></script>

		<w2:require src="/ux/common/udc/udcListCount.xml"></w2:require>
		<w2:require src="/ux/common/udc/udcSearchCode.xml"></w2:require>
        <w2:require src="/ux/common/udc/udcGridFix.xml"></w2:require>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group class="content_body" id="" style="">
			<xf:group class="navigator_wrap" id="" style="">
			    <w2:wframe id="wfm_title" src="/ux/common/navigator.xml" style=""></w2:wframe>
			</xf:group>

			<xf:group class="tbl_search" id="" style="">
				<xf:group class="tb_list" id="" style="" tagname="table">
					<w2:attributes>
						<w2:summary>조회조건 테이블 입니다.</w2:summary>
					</w2:attributes>
					<xf:group tagname="colgroup">
						<xf:group style="width:110px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
						<xf:group style="width:96px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
						<xf:group style="width:110px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
					    <xf:group class="w2tb_th req" style="" tagname="th">
					        <w2:attributes>
					            <w2:scope>row</w2:scope>
					        </w2:attributes>
					        <w2:span class="" id="" label="프로젝트명" style=""></w2:span>
					    </xf:group>
					    <xf:group class="w2tb_td" style="" tagname="td">
					        <w2:span id="sbxSiteNm" label="관훈빌딩리모델링" style="" ref="data:dsSearchMap.siteNm"></w2:span>
					        <w2:span id="sbxSiteCd" label="" style=";visibility:hidden;"
					            ref="data:dsSearchMap.siteCd">
					        </w2:span>
					    </xf:group>
					    <xf:group class="w2tb_th" style="" tagname="th">
					        <w2:attributes>
					            <w2:scope>row</w2:scope>
					        </w2:attributes>
					        <w2:span class="" id="" label="진행상태" style=""></w2:span>
					    </xf:group>
					    <xf:group class="w2tb_td" style="" tagname="td">
					        <w2:span id="sbxActbgtConfmStusCd" label="진행" style="" ref="data:dsSearchMap.actbgtConfmStusNm"></w2:span>
					    </xf:group>
					    <xf:group class="w2tb_th" style="" tagname="th"><w2:attributes>
					            <w2:scope>row</w2:scope>
					        </w2:attributes><w2:span class="" id="" label="삭제포함여부" style=""></w2:span></xf:group>
					    <xf:group class="w2tb_td" style="" tagname="td">
					        <w2:attributes></w2:attributes>
                            <xf:select appearance="full" class="" cols="" id="cbxDelYn"
                                ref="data:dsSearchMap.delYn" renderType="checkboxgroup" rows="" selectedindex="" style=""
                                falseValue="N" ev:onchange="scwin.cbxDelYn_onchange">
                                <xf:choices>
                                    <xf:item>
                                        <xf:label><![CDATA[]]></xf:label>
                                        <xf:value><![CDATA[Y]]></xf:value>
                                    </xf:item>
                                </xf:choices>
                            </xf:select>
					    </xf:group>
					    <xf:group class="w2tb_th" tagname="th">작업자<w2:attributes>
					            <w2:scope>row</w2:scope>
					        </w2:attributes></xf:group>
					    <xf:group class="w2tb_td" tagname="td">
					        <w2:attributes></w2:attributes>
					        <w2:span id="" label="2018-12-11(홍길동)" style="" ref="data:dsSearchMap.fstRegprEmpno"></w2:span>
					    </xf:group>


					</xf:group>
				</xf:group>
				<xf:group class="btn_tbl_search" style="" tagname="">
				    <w2:anchor class="btn_sh" id="btnFind" outerDiv="false" style=""
				        ev:onclick="scwin.btnFind_onclick">
				        <xf:label><![CDATA[조회]]></xf:label>
				    </w2:anchor>
				</xf:group>
			</xf:group><xf:group class="defaultbox" id="" style="">
				<xf:group class="right_wrap" id="" style="">
					<xf:group class="" id="" style="">
					    <w2:anchor class="btn_gcm" clickEventElement="outerDiv" id="btnConfmPrgn" outerDiv="false"
					        style="" ev:onclick="scwin.btnConfmPrgn_onclick" disabled="true">
					        <xf:label><![CDATA[확정작업시작]]></xf:label>
					    </w2:anchor>
					    <w2:anchor class="btn_gcm" clickEventElement="outerDiv" ev:onclick="scwin.btnList_onclick"
					        id="btnList" outerDiv="false" style="">
					        <xf:label><![CDATA[목록]]></xf:label>
					    </w2:anchor>
					</xf:group>
				</xf:group>
			</xf:group>
			<w2:tabControl alwaysDraw="false" class="cm_tab" confirmFalseAction="new" confirmTrueAction="exist" id="tacActbgtConfm"
				style="" useConfirmMessage="false" useMoveNextTabFocus="false" useTabKeyOnly="true" ev:ontabclick="scwin.tacActbgtConfm_ontabclick" ev:ontabload="scwin.tacActbgtConfm_ontabload" ev:onchange="scwin.tacActbgtConfm_onchange" ev:onbeforeselect="scwin.tacActbgtConfm_onbeforeselect">
				<w2:tabs disabled="false" id="tabActbgtConfm" label="내역관리" style=""></w2:tabs>
				<w2:tabs disabled="false" id="tabActbgtConfmTotal" label="집계표" style=""></w2:tabs>
				<w2:content alwaysDraw="false" id="content2" style="">

				    <xf:group class="lybox_wrap fix_300 foldingbox1 on" id="" style="">
				        <xf:group class="lybox" id="" style="">
				            <xf:group class="lycolumn " id="" style="">
				                <xf:group class="lyinner" id="" style="">
				                    <xf:group class="defaultbox" id="" style="">
				                        <w2:textbox class="df_tt" id="" label="발주처공종" style="" tagname="h3"></w2:textbox>
                                        <xf:group class="right_wrap" id="" style="">
                                            <w2:anchor class="btn_gcm" id="btnTreeSpanAll" outerDiv="false" style="" disabled="false" ev:onclick="scwin.btnTreeSpanAll_onclick">
                                                <xf:label><![CDATA[전체 펼치기]]></xf:label>
                                            </w2:anchor>
                                        </xf:group>
				                    </xf:group>
				                    <w2:anchor class="btn_folding" id="" outerDiv="false" style="">
				                        <xf:label></xf:label>
				                    </w2:anchor>
				                    <w2:treeview class="autoHeight" dataType="listed" id="trvUpperActbgtConfm"
				                        lineShow="" style="height:300px" tooltipGroupClass="false" useDrag="" ev:onclick="scwin.trvUpperActbgtConfm_onclick" ev:onlabelclick="scwin.trvUpperActbgtConfm_onlabelclick" showTreeDepth="1">
				                        <w2:itemset nodeset="data:dsUpperActbgtConfmList">
				                            <w2:label ref="bgtItemiNm"></w2:label>
				                            <w2:value ref="bgtItemiCd"></w2:value>
				                            <w2:depth ref="bgtItemiLv"></w2:depth>
				                            <w2:folder ref="itemiYn"></w2:folder>
				                            <w2:checkbox ref=""></w2:checkbox>
				                            <w2:checkboxDisabled ref=""></w2:checkboxDisabled>
				                            <w2:image ref=""></w2:image>
				                            <w2:iconImage ref=""></w2:iconImage>
				                            <w2:selectedImage ref=""></w2:selectedImage>
				                            <w2:expandedImage ref=""></w2:expandedImage>
				                            <w2:leafImage ref=""></w2:leafImage>
				                        </w2:itemset>
				                    </w2:treeview>
				                </xf:group>
				            </xf:group>
				            <xf:group class="lycolumn" id="" style="">
				                <xf:group class="lyinner" id="" style="">
				                    <xf:group class="defaultbox" id="" style="">
				                        <w2:textbox class="df_tt" id="" label="상세정보(내역)" style="" tagname="h3"></w2:textbox>
				                        <w2:udc_list_count style="position: absolute;" id="dsActbgtConfmListCount"></w2:udc_list_count>
				                        <xf:group class="right_wrap" id="" style="">
				                            <xf:group id="" style="">
	                                            <xf:select appearance="full" class="" cols=""
	                                                ev:onchange="scwin.chkContColHidden_onchange"
	                                                ev:oncheckboxclick="" falseValue="N"
	                                                id="chkContColHidden" ref="data:dsSearchMap.contColHiddenYn" renderType="checkboxgroup"
	                                                rows="" selectedindex="0" style="" useCheckboxTitle=""
	                                                ev:onviewchange="" title="">
	                                                <xf:choices>
	                                                    <xf:item>
	                                                        <xf:label><![CDATA[도급예산 숨김]]></xf:label>
	                                                        <xf:value><![CDATA[Y]]></xf:value>
	                                                    </xf:item>
	                                                </xf:choices>
	                                            </xf:select>    
				                                <w2:anchor class="btn_gcm" disabled="false"
				                                    ev:onclick="scwin.btnDrillSpanAll_onclick" id="btnDrillSpanAll" outerDiv="false"
				                                    style="">
				                                    <xf:label><![CDATA[전체 접기]]></xf:label>
				                                </w2:anchor>
				                                <w2:anchor class="btn_gcm" clickEventElement="" id="btnStndJob"
				                                    outerDiv="false" style="" ev:onclick="scwin.btnStndJob_onclick"
				                                    disabled="true">
				                                    <xf:label><![CDATA[표준내역생성]]></xf:label>
				                                </w2:anchor>
				                                <xf:input id="sbxInsertRowNumber" ref="" style="width:50px;"
				                                    initValue="1" dataType="number" ev:onchange="scwin.sbxInsertRowNumber_onchange"
				                                    allowChar="0-9" maxlength="3" class="ar">
				                                </xf:input>
				                                <w2:anchor class="btn_gcm" clickEventElement=""
				                                    id="btnUpperItemInsertRow" outerDiv="false" style=""
				                                    ev:onclick="scwin.btnUpperItemInsertRow_onclick" disabled="true">
				                                    <xf:label><![CDATA[공종추가]]></xf:label>
				                                </w2:anchor>
				                                <w2:anchor class="btn_gcm" clickEventElement="" id="btnItemInsertRow"
				                                    outerDiv="false" style="" ev:onclick="scwin.btnItemInsertRow_onclick"
				                                    disabled="true">
				                                    <xf:label><![CDATA[내역추가]]></xf:label>
				                                </w2:anchor>
				                                <w2:anchor class="btn_gcm" clickEventElement="" id="btnSave"
				                                    outerDiv="false" style="" ev:onclick="scwin.btnSave_onclick" disabled="true">
				                                    <xf:label><![CDATA[저장]]></xf:label>
				                                </w2:anchor>
				                                <w2:anchor class="btn_gcm" clickEventElement="" disabled=""
				                                    ev:onclick="scwin.btnAutoOrder_onclick" id="btnAutoOrder" outerDiv="false"
				                                    style="">
				                                    <xf:label><![CDATA[자동순번]]></xf:label>
				                                </w2:anchor>
				                                <w2:anchor class="btn_gcm row_del" clickEventElement=""
				                                    id="btnDeleteRow" outerDiv="false" style="" toolTip="행삭제"
				                                    ev:onclick="scwin.btnDeleteRow_onclick">
				                                    <xf:label><![CDATA[행삭제]]></xf:label>
				                                </w2:anchor>
				                                <w2:anchor class="btn_gcm excel_down" clickEventElement=""
				                                    id="btnExcelDwn" localeRef="" outerDiv="false" style="" toolTip="엑셀다운로드"
				                                    ev:onclick="scwin.btnExcelDwn_onclick">
				                                    <xf:label><![CDATA[엑셀다운로드]]></xf:label>
				                                </w2:anchor>

				                            </xf:group>

				                        </xf:group>
				                    </xf:group>
				                    <w2:gridView autoFit="lastColumn" class="narrow autoHeight" dataList="data:dsActbgtConfmList"
				                        fixedColumnWithHidden="" focusMode="row" id="grdActbgtConfmList" rowNumHeaderValue="No" rowNumVisible=""
				                        rowStatusHeaderValue="" rowStatusVisible="" rowStatusWidth="30" scrollByColumn="false"
				                        showSortableUseFilter="true" sortable="false" style="height: 300px;" useShiftKey="true" visibleRowNum=""
				                        selectByLabel="true" copyOption="display" ev:onviewchange="scwin.grdActbgtConfmList_onviewchange"
				                        ev:oncellclick="scwin.grdActbgtConfmList_oncellclick" checkReadOnlyOnPaste="true" fixedColumn="7"
				                        readOnly="false" setCellInputTypeCustom="true" ev:oncustompaste="scwin.grdActbgtConfmList_oncustompaste"
				                        ev:onbeforeedit="scwin.grdActbgtConfmList_onbeforeedit" ev:onafteredit="scwin.grdActbgtConfmList_onafteredit"
				                        preventAddRowOnPaste="true" enterKeyMove="down" keyMoveEditMode="true" contextMenu="true">
				                        <w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
				                        <w2:header id="header1" style="">
				                            <w2:row id="row2" style="">
				                                <w2:column blockSelect="true" colSpan="" id="column21" inputType="checkbox" rowSpan="3"
				                                    style="" value="" width="50">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column67" inputType="text"
				                                    removeBorderStyle="false" rowSpan="3" style="" value="No." width="60">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" id="column19" inputType="text" rowSpan="3"
				                                    style="" value="구분" width="70">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" id="column17" inputType="text" rowSpan="3"
				                                    style="" value="품명" width="260" class="req">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" id="column15" inputType="text" rowSpan="3"
				                                    style="" value="규격" width="100">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column37" inputType="text"
				                                    removeBorderStyle="false" rowSpan="3" style="" value="단위" width="70">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column35" inputType="text"
				                                    removeBorderStyle="false" rowSpan="3" style="" value="비목" width="80">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="950" inputType="text" style="height:34px;"
				                                    id="column223" value="도급예산" blockSelect="false" displayMode="label" colSpan="9" rowSpan="">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="810" inputType="text" style="height:34px;"
				                                    id="column241" value="실행예산" blockSelect="false" displayMode="label" colSpan="9" rowSpan="">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column181"
				                                    inputType="text" removeBorderStyle="false" rowSpan="3" style=""
				                                    value="실행&lt;br/&gt;원가율&lt;br/&gt;(%)" width="90">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="80" inputType="text" style="" id="column324"
				                                    value="집행" blockSelect="false" displayMode="label" colSpan="3" rowSpan="">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column151"
				                                    inputType="text" removeBorderStyle="false" rowSpan="3" style=""
				                                    value="현장관리비&lt;br/&gt;예산&lt;br/&gt;금액" width="90">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column145"
				                                    inputType="text" removeBorderStyle="false" rowSpan="3" style="" value="비고" width="90">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column139"
				                                    inputType="text" removeBorderStyle="false" rowSpan="" style="height:34px;" value="표준내역" width="100"
				                                    hidden="true">
				                                </w2:column>
				                                <w2:column hidden="true" removeBorderStyle="false" width="160" inputType="text"
				                                    style="height:102px;" id="column333" value="표준코드" blockSelect="false" displayMode="label"
				                                    colSpan="2" rowSpan="3">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column211"
				                                    inputType="text" removeBorderStyle="false" rowSpan="3" style="" value="정렬순서" width="80" class="req"
				                                    allowChar="0-9">
				                                </w2:column>
				                            </w2:row>
				                            <w2:row id="row8" style="">
				                                <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;"
				                                    id="column230" value="수량" blockSelect="false" displayMode="label" rowSpan="2" colSpan="">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="220" inputType="text" style="height:34px;"
				                                    id="column338" value="재료비" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="220" inputType="text" style="height:34px;"
				                                    id="column346" value="노무비" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="200" inputType="text" style="height:34px;"
				                                    id="column354" value="경비" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
				                                </w2:column>
                                                <w2:column removeBorderStyle="false" width="220" inputType="text" style="height:34px;"
                                                    id="column236" value="합계" blockSelect="false" displayMode="label" rowSpan="" colSpan="2">
                                                </w2:column>                                                
				                                <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;"
				                                    id="column242" value="수량" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="220" inputType="text" style="height:34px;"
				                                    id="column364" value="재료비" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="220" inputType="text" style="height:34px;"
				                                    id="column372" value="노무비" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="190" inputType="text" style="height:34px;"
				                                    id="column380" value="경비" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
				                                </w2:column>
                                                <w2:column removeBorderStyle="false" width="220" inputType="text" style="height:34px;"
                                                    id="column248" value="합계" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
                                                </w2:column>                                                
				                                <w2:column removeBorderStyle="false" width="80" inputType="text" style="height:34px;"
				                                    id="column325" value="계약여부" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="2" displayMode="label" id="column134"
				                                    inputType="text" removeBorderStyle="false" rowSpan="" style="height:34px;" value="원가" width="160">
				                                </w2:column>
				                                <w2:column blockSelect="false" colSpan="" displayMode="label" id="column135"
				                                    inputType="text" removeBorderStyle="false" rowSpan="2" style="height:34px;" value="코드"
				                                    width="100">
				                                </w2:column>
				                            </w2:row>
				                            <w2:row id="row9" style="">
				                                <w2:column hidden="false" removeBorderStyle="false" width="110" inputType="text" style=""
				                                    id="column335" value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column hidden="false" removeBorderStyle="false" width="110" inputType="text" style=""
				                                    id="column336" value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column339"
				                                    value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column343"
				                                    value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column347"
				                                    value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column351"
				                                    value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column355"
				                                    value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column359"
				                                    value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column hidden="false" removeBorderStyle="false" width="110" inputType="text" style=""
				                                    id="column361" value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column hidden="false" removeBorderStyle="false" width="110" inputType="text" style=""
				                                    id="column362" value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column365"
				                                    value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column369"
				                                    value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column373"
				                                    value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column385"
				                                    value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column381"
				                                    value="단가" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column377"
				                                    value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column237"
				                                    value="수량" blockSelect="false" displayMode="label">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="column332"
				                                    value="금액" blockSelect="false" displayMode="label">
				                                </w2:column>
				                            </w2:row>
				                        </w2:header>
				                        <w2:gBody id="gBody4" style="">
				                            <w2:row id="row5" style="">
				                                <w2:column blockSelect="false" id="chk" inputType="checkbox" style="" textAlign="" value=""
				                                    width="60" headers="grdActbgtConfmList_column21">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" excelExpression="" id="column68"
				                                    inputType="expression" removeBorderStyle="false" style="" value="" width="70"
				                                    expression="rowindex()+1" headers="grdActbgtConfmList_column67">
				                                </w2:column>
				                                <w2:column blockSelect="false" class="" id="gubun" inputType="text" style="" textAlign=""
				                                    value="" width="70" readOnly="true" headers="grdActbgtConfmList_column19">
				                                </w2:column>
				                                <w2:column blockSelect="false" id="bgtItemiNm" inputType="drilldown" style=""
				                                    textAlign="left" value="" width="540" depthType="div" depthColumn="bgtItemiLv" showDepth="10"
				                                    maxByteLength="300" headers="grdActbgtConfmList_column17" ignoreChar="》">
				                                </w2:column>
				                                <w2:column blockSelect="false" id="bgtItemiStdr" inputType="text" style="" textAlign="left"
				                                    value="" width="100" maxByteLength="200" headers="grdActbgtConfmList_column15">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="bgtItemiUnit" inputType="text"
				                                    removeBorderStyle="false" style="" textAlign="" value="" width="50" maxByteLength="50"
				                                    headers="grdActbgtConfmList_column37">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="itexpGb" inputType="select"
				                                    removeBorderStyle="false" style="" textAlign="" value="" width="80" allOption="" chooseOption=""
				                                    ref="" viewType="icon" selectedData="true" headers="grdActbgtConfmList_column35" readOnly="true">
				                                    <w2:choices>
				                                        <w2:item>
				                                            <w2:label><![CDATA[자재]]></w2:label>
				                                            <w2:value><![CDATA[M]]></w2:value>
				                                        </w2:item>
				                                        <w2:item>
				                                            <w2:label><![CDATA[노무]]></w2:label>
				                                            <w2:value><![CDATA[L]]></w2:value>
				                                        </w2:item>
				                                        <w2:item>
				                                            <w2:label><![CDATA[외주]]></w2:label>
				                                            <w2:value><![CDATA[S]]></w2:value>
				                                        </w2:item>
				                                        <w2:item>
				                                            <w2:label><![CDATA[경비]]></w2:label>
				                                            <w2:value><![CDATA[O]]></w2:value>
				                                        </w2:item>
				                                    </w2:choices>
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="contQty"
				                                    value="" blockSelect="false" displayMode="label" textAlign="right" displayFormat="#,##0.000"
				                                    dataType="number" defaultValue="0.000" maxLength="" maxByteLength="17" alt="" applyFormat=""
				                                    allowChar="0-9.,-\s" headers="grdActbgtConfmList_column230 grdActbgtConfmList_column223">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="contMtrctUct"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9,\s" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column339 grdActbgtConfmList_column338 grdActbgtConfmList_column392">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="contMtrctAmt"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column343 grdActbgtConfmList_column388 grdActbgtConfmList_column393" readOnly="true">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="contLbctUct"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9,\s" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column347 grdActbgtConfmList_column346 grdActbgtConfmList_column394">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="contLbctAmt"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column351 grdActbgtConfmList_column386 grdActbgtConfmList_column395" readOnly="true">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="contExpnsUct"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9,\s" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column355 grdActbgtConfmList_column354 grdActbgtConfmList_column396">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="contExpnsAmt"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column359 grdActbgtConfmList_column387 grdActbgtConfmList_column397" readOnly="true">
				                                </w2:column>
                                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="contUct"
                                                    value="" blockSelect="false" displayMode="label" textAlign="right" displayFormat="#,##0"
                                                    dataType="number" defaultValue="0" allowChar="0-9,\s" maxLength="" selectedData=""
                                                    maxByteLength="15"
                                                    headers="grdActbgtConfmList_column335 grdActbgtConfmList_column236 grdActbgtConfmList_column390" readOnly="true">
                                                </w2:column>
                                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="contAmt"
                                                    value="" blockSelect="false" displayMode="label" textAlign="right" displayFormat="#,##0"
                                                    dataType="bigDecimal" readOnly="true" defaultValue="0" allowChar="0-9"
                                                    headers="grdActbgtConfmList_column336 grdActbgtConfmList_column389 grdActbgtConfmList_column391">
                                                </w2:column>                                                
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="actbgtQty"
				                                    value="" blockSelect="false" displayMode="label" textAlign="right" displayFormat="#,##0.000"
				                                    dataType="number" defaultValue="0" maxLength="" allowChar="0-9.,-\s" alt="" applyFormat=""
				                                    maxByteLength="17" headers="grdActbgtConfmList_column242 grdActbgtConfmList_column241">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style=""
				                                    id="actbgtMtrctUct" value="" blockSelect="false" displayMode="label" allowChar="0-9,\s"
				                                    displayFormat="#,##0" textAlign="right"
				                                    headers="grdActbgtConfmList_column365 grdActbgtConfmList_column364 grdActbgtConfmList_column241">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style=""
				                                    id="actbgtMtrctAmt" value="" blockSelect="false" displayMode="label" allowChar="0-9"
				                                    displayFormat="#,##0" textAlign="right"
				                                    headers="grdActbgtConfmList_column369 grdActbgtConfmList_column364 grdActbgtConfmList_column241" readOnly="true">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="actbgtLbctUct"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9,\s" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column373 grdActbgtConfmList_column372 grdActbgtConfmList_column241">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="actbgtLbctAmt"
				                                    value="" blockSelect="false" displayMode="label" allowChar="0-9" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column385 grdActbgtConfmList_column372 grdActbgtConfmList_column241" readOnly="true">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style=""
				                                    id="actbgtExpnsUct" value="" blockSelect="false" displayMode="label" allowChar="0-9,\s"
				                                    displayFormat="#,##0" textAlign="right"
				                                    headers="grdActbgtConfmList_column381 grdActbgtConfmList_column380 grdActbgtConfmList_column241">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style=""
				                                    id="actbgtExpnsAmt" value="" blockSelect="false" displayMode="label" displayFormat="#,##0"
				                                    textAlign="right"
				                                    headers="grdActbgtConfmList_column377 grdActbgtConfmList_column380 grdActbgtConfmList_column241" readOnly="true">
				                                </w2:column>
                                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="actbgtUct"
                                                    value="" blockSelect="false" displayMode="label" textAlign="right" displayFormat="#,##0"
                                                    defaultValue="0" allowChar="0-9,\s" maxLength="" maxByteLength="15"
                                                    headers="grdActbgtConfmList_column361 grdActbgtConfmList_column248 grdActbgtConfmList_column241" readOnly="true">
                                                </w2:column>
                                                <w2:column removeBorderStyle="false" width="110" inputType="text" style="" id="actbgtAmt"
                                                    value="" blockSelect="false" displayMode="label" textAlign="right" displayFormat="#,##0"
                                                    readOnly="true" defaultValue="0"
                                                    headers="grdActbgtConfmList_column362 grdActbgtConfmList_column248 grdActbgtConfmList_column241">
                                                </w2:column>                                                
				                                <w2:column blockSelect="false" displayMode="label" id="actbgtRt" inputType="text"
				                                    removeBorderStyle="false" style="" textAlign="right" value="" width="90" readOnly="true"
				                                    displayFormat="#,##0.00%" headers="grdActbgtConfmList_column181">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="80" inputType="text" style="height:37px;"
				                                    id="scPrItemiYn" value="" blockSelect="false" displayMode="label" textAlign="center"
				                                    displayFormat="" defaultValue="" dataType="text" readOnly="true" colSpan="" rowSpan=""
				                                    headers="grdActbgtConfmList_column325 grdActbgtConfmList_column324">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="pcostQty" inputType="text"
				                                    removeBorderStyle="false" style="" textAlign="right" value="" width="90" displayFormat="#,##0.000"
				                                    defaultValue="0.000" dataType="bigDecimal" readOnly="true"
				                                    headers="grdActbgtConfmList_column237 grdActbgtConfmList_column134 grdActbgtConfmList_column324">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pcostAmt"
				                                    value="" blockSelect="false" displayMode="label" textAlign="right" displayFormat="#,##0"
				                                    dataType="number" defaultValue="0" readOnly="true"
				                                    headers="grdActbgtConfmList_column332 grdActbgtConfmList_column134 grdActbgtConfmList_column324">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="mngctBgtAmt" inputType="text"
				                                    removeBorderStyle="false" style="" textAlign="right" value="" width="90" displayFormat="#,##0"
				                                    dataType="number" defaultValue="0" readOnly="true" headers="grdActbgtConfmList_column151">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="rmkCn" inputType="text"
				                                    removeBorderStyle="false" style="" value="" width="90" textAlign="left" maxLength=""
				                                    maxByteLength="2000" headers="grdActbgtConfmList_column145">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="stndItemiCd" inputType="text"
				                                    removeBorderStyle="false" style="" value="" width="100" readOnly="true"
				                                    headers="grdActbgtConfmList_column135 grdActbgtConfmList_column139">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="stndItemiNm"
				                                    imageSrc="/resources/images/content/ico_grid_find.png" inputType="text" removeBorderStyle="false"
				                                    style="" value="" width="130" readOnly="true" textAlign="left"
				                                    headers="grdActbgtConfmList_column333">
				                                </w2:column>
				                                <w2:column removeBorderStyle="false" width="41" inputType="image" style=""
				                                    id="popStndJobtypCd" value="" blockSelect="false" displayMode="label"
				                                    imageSrc="/resources/images/content/ico_grid_find.png" readOnly="true" disabled="" hidden=""
				                                    skipKeyMoveEditMode="true" headers="grdActbgtConfmList_column333">
				                                </w2:column>
				                                <w2:column blockSelect="false" displayMode="label" id="sortOdr" inputType="text"
				                                    removeBorderStyle="false" style="" value="" width="90" allowChar="0-9" dataType="number"
				                                    maxLength="" maxByteLength="5" defaultValue="0" headers="grdActbgtConfmList_column211">
				                                </w2:column>
				                            </w2:row>
				                        </w2:gBody>
				                    </w2:gridView>
				                </xf:group>
				            </xf:group>
				        </xf:group>
				    </xf:group>
				</w2:content>
				<w2:content alwaysDraw="false" id="content3" style="">
			        <xf:group class="defaultbox" id="" style="">
			            <w2:textbox class="df_tt" id="" label="집계현황" style="" tagname="h3"></w2:textbox>
			            <w2:udc_list_count id="dsActbgtConfmTotalListCount"></w2:udc_list_count>
			            <xf:group class="right_wrap" id="" style="">
			                <xf:group class="" id="" style="">
			                    <w2:anchor class="btn_gcm excel_down" clickEventElement="" id="btnExcelDwnTotal" localeRef=""
			                        outerDiv="false" style="" toolTip="엑셀다운로드" ev:onclick="scwin.btnExcelDwnTotal_onclick">
			                        <xf:label><![CDATA[엑셀다운로드]]></xf:label>
			                    </w2:anchor>
			                </xf:group>
			            </xf:group>
			        </xf:group>
			        <w2:gridView autoFit="allColumn" class="autoHeight" dataList="data:dsActbgtConfmTotalList"
			            fixedColumnWithHidden="true" focusMode="row" id="grdActbgtConjfmTotalList" rowNumHeaderValue=""
                        drilldownRealRowIndex="true" rowNumVisible=""
			            rowStatusHeaderValue="" rowStatusVisible="" rowStatusWidth="" scrollByColumn="false"
			            showSortableUseFilter="" sortable="" style="height: 300px;" useShiftKey="true"
			            visibleRowNum="" readOnly="true">
			            <w2:header id="header1" style="">
			                <w2:row id="row2" style="">
			                    <w2:column blockSelect="false" colSpan="" id="column21" inputType="text" rowSpan="2"
			                        style="" value="공종명" width="200">
			                    </w2:column>
			                    <w2:column blockSelect="false" colSpan="" displayMode="label" id="column67"
			                        inputType="text" removeBorderStyle="false" rowSpan="2" style="" value="레벨" width="70">
			                    </w2:column>
			                    <w2:column blockSelect="false" colSpan="2" id="column19" inputType="text" rowSpan=""
			                        style="" value="변경 전" width="280">
			                    </w2:column>
			                    <w2:column blockSelect="false" colSpan="2" id="column15" inputType="text" rowSpan=""
			                        style="" value="변경 후" width="280">
			                    </w2:column>
			                    <w2:column blockSelect="false" colSpan="2" displayMode="label" id="column35"
			                        inputType="text" removeBorderStyle="false" rowSpan="" style="" value="증감" width="280">
			                    </w2:column>
			                    <w2:column blockSelect="false" colSpan="2" displayMode="label" id="column39"
			                        inputType="text" removeBorderStyle="false" rowSpan="" style="height:34px;" value="원가율"
			                        width="240">
			                    </w2:column>
			                </w2:row>
			                <w2:row id="row8" style="">
			                    <w2:column blockSelect="false" displayMode="label" id="column78" inputType="text"
			                        removeBorderStyle="false" style="" value="도급예산" width="140">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="column77" inputType="text"
			                        removeBorderStyle="false" style="" value="실행예산" width="140">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="column76" inputType="text"
			                        removeBorderStyle="false" style="" value="도급예산" width="140">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="column75" inputType="text"
			                        removeBorderStyle="false" style="" value="실행예산" width="140">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="column74" inputType="text"
			                        removeBorderStyle="false" style="" value="도급예산" width="140">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="column73" inputType="text"
			                        removeBorderStyle="false" style="" value="실행예산" width="140">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="column72" inputType="text"
			                        removeBorderStyle="false" style="" value="변경 전" width="120">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="column71" inputType="text"
			                        removeBorderStyle="false" style="" value="변경 후" width="120">
			                    </w2:column>
			                </w2:row>
			            </w2:header>
			            <w2:gBody id="gBody4" style="">
			                <w2:row id="row5" style="">
			                    <w2:column blockSelect="false" id="bgtItemiNm" inputType="drilldown"
			                        drilldownRealRowIndex="true" style="height:24px;" textAlign="left" value="" width="200"
			                        depthType="div" depthColumn="bgtItemiLv" showDepth="2">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="bgtItemiLv" inputType="text"
			                        removeBorderStyle="false" style="height:24px;" value="" width="70">
			                    </w2:column>
			                    <w2:column blockSelect="false" class="" id="chgbfContAmt" inputType="text"
			                        style="height:24px;" textAlign="right" value="" width="140" displayFormat="#,##0">
			                    </w2:column>
			                    <w2:column blockSelect="false" id="chgbfActbgtAmt" inputType="text" style="height:24px;"
			                        textAlign="right" value="" width="140" displayFormat="#,##0">
			                    </w2:column>
			                    <w2:column blockSelect="false" id="contAmt" inputType="text" style="height:24px;"
			                        textAlign="right" value="" width="140" displayFormat="#,##0">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="actbgtAmt" inputType="text"
			                        removeBorderStyle="false" style="height:24px;" textAlign="right" value="" width="140"
			                        displayFormat="#,##0">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="incContAmt" inputType="text"
			                        removeBorderStyle="false" style="height:24px;" textAlign="right" value="" width="140"
			                        displayFormat="#,##0">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="incActbgtAmt" inputType="text"
			                        removeBorderStyle="false" style="height:24px;" textAlign="right" value="" width="140"
			                        displayFormat="#,##0">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="chgbfActbgtRt" inputType="text"
			                        removeBorderStyle="false" style="height:24px;" value="" width="120" textAlign="right"
			                        displayFormat="#,##0.00%">
			                    </w2:column>
			                    <w2:column blockSelect="false" displayMode="label" id="actbgtRt" inputType="text"
			                        removeBorderStyle="false" style="height:24px;" value="" width="120" textAlign="right"
			                        displayFormat="#,##0.00%">
			                    </w2:column>
			                </w2:row>
			            </w2:gBody>
			        </w2:gridView>
				</w2:content>
			</w2:tabControl>
		</xf:group>
	</body>
</html>
