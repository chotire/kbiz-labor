<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" repeatNode="map" id="dsTcmSiteMngctChgDtlList" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="stndItemiNm" name="분류" dataType="text"></w2:column>
						<w2:column id="bgtItemiNm" name="내역" dataType="text"></w2:column>
						<w2:column id="bgtItemiStdr" name="규격" dataType="text"></w2:column>
						<w2:column id="bgtItemiUnit" name="단위" dataType="text"></w2:column>
						<w2:column id="itexpGbNm" name="비목" dataType="text"></w2:column>
						<w2:column id="actbgtQty" name='수량' dataType="text"></w2:column>
						<w2:column id="actbgtAmt" name="전체예산" dataType="text"></w2:column>
						<w2:column id="bfyyAsumPfmcAmt" name="전년누계" dataType="text"></w2:column>
						<w2:column id="chgGb" name="변경구분" dataType="text"></w2:column>
						<w2:column id="qty01" name="수량" dataType="text"></w2:column>
						<w2:column id="uct01" name="단가" dataType="text"></w2:column>
						<w2:column id="amt01" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc01" name="실적" dataType="text"></w2:column>
						<w2:column id="qty02" name="수량" dataType="text"></w2:column>
						<w2:column id="uct02" name="단가" dataType="text"></w2:column>
						<w2:column id="amt02" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc02" name="실적" dataType="text"></w2:column>
						<w2:column id="qty03" name="수량" dataType="text"></w2:column>
						<w2:column id="uct03" name="단가" dataType="text"></w2:column>
						<w2:column id="amt03" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc03" name="실적" dataType="text"></w2:column>
						<w2:column id="qty04" name="수량" dataType="text"></w2:column>
						<w2:column id="uct04" name="단가" dataType="text"></w2:column>
						<w2:column id="amt04" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc04" name="실적" dataType="text"></w2:column>
						<w2:column id="qty05" name="수량" dataType="text"></w2:column>
						<w2:column id="uct05" name="단가" dataType="text"></w2:column>
						<w2:column id="amt05" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc05" name="실적" dataType="text"></w2:column>
						<w2:column id="qty06" name="수량" dataType="text"></w2:column>
						<w2:column id="uct06" name="단가" dataType="text"></w2:column>
						<w2:column id="amt06" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc06" name="실적" dataType="text"></w2:column>
						<w2:column id="qty07" name="수량" dataType="text"></w2:column>
						<w2:column id="uct07" name="단가" dataType="text"></w2:column>
						<w2:column id="amt07" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc07" name="실적" dataType="text"></w2:column>
						<w2:column id="qty08" name="수량" dataType="text"></w2:column>
						<w2:column id="uct08" name="단가" dataType="text"></w2:column>
						<w2:column id="amt08" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc08" name="실적" dataType="text"></w2:column>
						<w2:column id="qty09" name="수량" dataType="text"></w2:column>
						<w2:column id="uct09" name="단가" dataType="text"></w2:column>
						<w2:column id="amt09" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc09" name="실적" dataType="text"></w2:column>
						<w2:column id="qty10" name="수량" dataType="text"></w2:column>
						<w2:column id="uct10" name="단가" dataType="text"></w2:column>
						<w2:column id="amt10" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc10" name="실적" dataType="text"></w2:column>
						<w2:column id="qty11" name="수량" dataType="text"></w2:column>
						<w2:column id="uct11" name="단가" dataType="text"></w2:column>
						<w2:column id="amt11" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc11" name="실적" dataType="text"></w2:column>
						<w2:column id="qty12" name="수량" dataType="text"></w2:column>
						<w2:column id="uct12" name="단가" dataType="text"></w2:column>
						<w2:column id="amt12" name="예산" dataType="text"></w2:column>
						<w2:column id="pfmc12" name="실적" dataType="text"></w2:column>
						<w2:column id="thmmAsumBgt" name="예산" dataType="text"></w2:column>
						<w2:column id="thmmAsumPfmc" name="실적" dataType="text"></w2:column>
						<w2:column id="yrAsumBgt" name="예산" dataType="text"></w2:column>
						<w2:column id="yrAsumPfmc" name="실적" dataType="text"></w2:column>
						<w2:column id="remnBgt" name="잔여예산" dataType="text"></w2:column>
						<w2:column id="siteCd" name="현장코드" dataType="text"></w2:column>
						<w2:column id="bgtItemiCd" name="내역코드" dataType="text"></w2:column>
						<w2:column id="exeYy" name="실행년도" dataType="text"></w2:column>
						<w2:column id="lv" name="변경구분" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dsSearchMap">
					<w2:keyInfo>
						<w2:key id="siteCd" name="현장코드" dataType="text"></w2:key>
						<w2:key id="exeYy" name="기준연도" dataType="text"></w2:key>
						<w2:key id="chgDgr" name="변경_차수" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dsTcmSiteMngctChgMap">
					<w2:keyInfo>
						<w2:key id="siteCd" name="현장코드" dataType="text"></w2:key>
						<w2:key id="exeYy" name="실행_년도" dataType="text"></w2:key>
						<w2:key id="chgDgr" name="변경_차수" dataType="text"></w2:key>
						<w2:key id="aprvNo" name="결재번호" dataType="text"></w2:key>
						<w2:key id="dirmgExctAproCd" name="직영집행승인코드[CM004013]" dataType="text"></w2:key>
						<w2:key id="dirmgExctAproCdNm" name="직영집행승인코드명" dataType="text"></w2:key>
						<w2:key id="aprvOpinCn" name="결재_의견_내용" dataType="text"></w2:key>
						<w2:key id="aflId" name="첨부파일ID" dataType="text"></w2:key>
						<w2:key id="pbsvTeamAprvNo" name="공무_팀_결재번호" dataType="text"></w2:key>
						<w2:key id="pbsvTeamAprvOpinCn" name="공무_팀_결재_의견_내용" dataType="text"></w2:key>
						<w2:key id="pbsvTeamAflId" name="공무_팀_첨부파일ID" dataType="text"></w2:key>
						<w2:key id="pbsvTeamRtnprEmpno" name="공무_팀_반송자_사번" dataType="text"></w2:key>
						<w2:key id="ctrdAllBgtAmt" name="통제성_전체_예산_금액" dataType="text"></w2:key>
						<w2:key id="ctrdLtyrPfmcAmt" name="통제성_작년_실적_금액" dataType="text"></w2:key>
						<w2:key id="ctrdBfQtrBgtAmt" name="통제성_이전_분기_예산_금액" dataType="text"></w2:key>
						<w2:key id="ctrdBfQtrPfmcAmt" name="통제성_이전_분기_실적_금액" dataType="text"></w2:key>
						<w2:key id="ctrdThfqCnsltBfBgtAmt" name="통제성_금회_품의_이전_예산_금액" dataType="text"></w2:key>
						<w2:key id="ctrdThfqVrtnAmt" name="통제성_금회_증감_금액" dataType="text"></w2:key>
						<w2:key id="ctrdChgbfAmt" name="통제성_변경전_금액" dataType="text"></w2:key>
						<w2:key id="ctrdChgafAmt" name="통제성_변경후_금액" dataType="text"></w2:key>

						<w2:key id="dataYn" name="조회 데이터 존재 유/무" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
		</xf:model>

		<script src="/resources/js/common/cmn_CM.js" type="javascript" lazy="false"/>
		<script type="javascript" lazy="false"><![CDATA[
/***************************************************************************
 * Program ID : CM15150001T.xml
 * Program Name : 현장관리비예산변경 > 예산변경
 * Author : jeong se jun (tplsj)
 * Date : 2019.02.18
 *
 * History
 * ========================================
 * 변경일자     수정자   내 용
 * ========================================
 *
 **************************************************************************/

     /************************************************************************************
        DataCollection description

        dsTcmSiteMngctChgDtlList: 현장관리비 내역 GRID
        dsSearchMap: 검색조건 parameter
        dsTcmSiteMngctChgMap: 현장_관리비_변경 정보
     ************************************************************************************/

	 /************************************************************************************
	 	결재상태

		CM00401301	[미요청]		현장_결재상신
		CM00401302	[요청]			현장_결재승인, 공무팀_기안취소
		CM00401303	[공무팀결재중]	공무팀_결재상신
		CM00401304	[완료]			공무팀_결재승인
		CM00401305	[공무팀_반송]
		CM00401306	[공무팀_부결]
     ************************************************************************************/

    /************************************************************************************
    *  [1] 전역변수
    ************************************************************************************/
 	scwin.arrMonth = ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"];

    /************************************************************************************
    *  [2] onpageload(초기화포함)
    ************************************************************************************/
	scwin.onpageload = function() {
		//버튼 초기화
		scwin.fnBtnInit();
	};

	scwin.onpageunload = function() {

	};

    /** 화면초기화 **/
    scwin.fnInitial = function(siteCd, exeYy) {
    	//버튼 초기화
    	scwin.fnBtnInit();
    
    	dsSearchMap.set( "siteCd", siteCd );
    	dsSearchMap.set( "exeYy", exeYy );
    
        //틀고정
        grdTcmSiteMngctChgDtlList.setFixedColumn( 10 );

        //UI팀용 함수 호출
        com.commonUI();
        
        //현장_관리비_변경 최종 차수 조회
        scwin.fnMaxChgDgr();
    };

    /************************************************************************************
     *  [3] 사용자 정의함수 함수
     ************************************************************************************/
	//DataSet 초기화
	scwin.fnDataInit = function(){
		dsTcmSiteMngctChgDtlList.removeAll();
		dsSearchMap.setEmptyValue();
		dsTcmSiteMngctChgMap.setEmptyValue();
		scwin.fnBtnInit();//버튼 초기화
		com.setUdcValue("dsTotalCount","udcListCount",0);
	}

	//버튼 초기화
	scwin.fnBtnInit = function(){
		btnNew.setDisabled( true );//신규
        btnSave.setDisabled( true );//저장
        btnDel.setDisabled( true );//삭제
	};

    //현장_관리비_변경 최종 차수 조회
    scwin.fnMaxChgDgr = function() {
        ajaxLib.ajax("/cm/cm1515/CM15150000U/selectMaxChgDgr", {
            method : "POST",
            requestData : dsSearchMap.getJSON(),
            callback : //"fnCallback",
                function(result, e){
                	dsSearchMap.set( "chgDgr" , result.data.maxChgDgr );
                	scwin.fnTcmSiteMngctChg();
            	},
            errCallback : "fnErrCallBack"
        });
    }

	//현장_관리비_변경 정보 조회
	scwin.fnTcmSiteMngctChg = function() {
        ajaxLib.ajax("/cm/cm1515/CM15150000U/selectTcmSiteMngctChg", {
            method : "POST",
            requestData : {
            				 tcmSiteMngctChg : dsSearchMap.getJSON()
            			},
            callback : //"fnCallback",
                function(result, e){
	                dsTcmSiteMngctChgMap.setJSON( result.data.dsTcmSiteMngctChgMap );

	                $p.parent().spnStatus.setLabel( dsTcmSiteMngctChgMap.get( "dirmgExctAproCdNm" ) );//진행상태
	                $p.parent().spnChgDgr.setLabel( dsTcmSiteMngctChgMap.get( "chgDgr" ) );//변경차수

	                scwin.fnBtnControl();//상태값에 따른 버튼 제어

	                scwin.fnSearch();//현장관리비 내역 GRID 조회
            	},
            errCallback : "fnErrCallBack"
        });
	};

	//조회
    scwin.fnSearch = function() {
        ajaxLib.ajax("/cm/cm1515/CM15150000U/selectTcmSiteMngctChgDtlList", {
            method : "POST",
            requestData : {
            				 param : dsSearchMap.getJSON()
            			},
            callback : //"fnCallback",
                function(result, e){
                	//현장_관리비_변경_상세_정보
	                dsTcmSiteMngctChgDtlList.setJSON(result.data.dsTcmSiteMngctChgDtlList);
	                com.setUdcValue("dsTotalCount","udcListCount",dsTcmSiteMngctChgDtlList.getTotalRow());   //GRID ROW COUNT

	                if(dsSearchMap.get( "exeYy" ) != ""){
		               	grdTcmSiteMngctChgDtlList.setHeaderValue( "column289" , dsSearchMap.get( "exeYy" ) + "년도" );//헤더 TITLE변경
		               	var bfYear = parseInt(dsSearchMap.get( "exeYy" ), 10)-1;//전년도
		               	grdTcmSiteMngctChgDtlList.setHeaderValue( "column290" , "전년 누계실적<br/>(" + bfYear + ")" );//헤더 TITLE변경
	                }

	                var stndItemiNmIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("stndItemiNm");//분류
	                var bgtItemiNmIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("bgtItemiNm");//내역
	                var bgtItemiStdrIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("bgtItemiStdr");//규격
	                var bgtItemiUnitIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("bgtItemiUnit");//단위
	                var itexpGbNmIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("itexpGbNm");//비목
	                var actbgtQtyIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("actbgtQty");//수량
	                var actbgtAmtIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("actbgtAmt");//전체예산
	                var bfyyAsumPfmcAmtIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("bfyyAsumPfmcAmt");//전년누계실적
	                var remnBgtIndex = grdTcmSiteMngctChgDtlList.getColumnIndex("remnBgt");//잔여예산

	                //CELL MERGE
	                for(var i=0; i<grdTcmSiteMngctChgDtlList.getTotalRow(); i++){
	                	/**************************************************
	                	 * 결재상태에 따라
	                	 * 1. CELL EDIT 가능 여부 처리
	                	 **************************************************/
						if(dsTcmSiteMngctChgMap.get( "aprvNo" ) == ""	//결재번호 존재X [결재번호가 존재한다는 것은 결재 상신의 의미 기안 취소시 결재번호를 null로 update함]
								|| dsTcmSiteMngctChgMap.get( "dirmgExctAproCd" ) == "CM00401305"	//공무팀_반송
							){//if start
							//====================================================================================================
		                	if(dsTcmSiteMngctChgDtlList.getCellData( i , "lv" ) == 2){//1:변경전, 2:변경후, 3:증감
								for(var k=0; k<12; k++){
                					grdTcmSiteMngctChgDtlList.setReadOnly( "cell" , i , "qty"+scwin.arrMonth[k] , false );//수량
                					grdTcmSiteMngctChgDtlList.setReadOnly( "cell" , i , "uct"+scwin.arrMonth[k] , false );//단가
								}//for end
		                	}
		                	//====================================================================================================
	                	}//if end
	                }//for end

	                dsTcmSiteMngctChgDtlList.modifyAllStatus( "R" );//190625추가 행초기화

            	},
            errCallback : "fnErrCallBack"
        });
    }

    //저장시 validation 체크
    scwin.fnSaveValidation = function() {
		for(var i=1; i<grdTcmSiteMngctChgDtlList.getTotalRow(); i=i+3){
			if(dsTcmSiteMngctChgDtlList.getRowJSON( i ).rowStatus != "R"){
				var nActbgtAmt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( i , "actbgtAmt" ), 0);//전체예산
				var nYrAsumBgt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( i , "yrAsumBgt" ), 0);//연누계 예산

				if(nActbgtAmt < nYrAsumBgt){
					com.showMessage("CMW0008", "", "", "", grdTcmSiteMngctChgDtlList.id, i, "chgGb");//연누계 예산이 전체예산을 초과할 수 없습니다.
					return false;
				}

				//수량, 단가가 모두 0일 경우 체크
				for(var k=0; k<12; k++){
					var nQty = parseInt(dsTcmSiteMngctChgDtlList.getCellData( i , "qty"+scwin.arrMonth[k] ), 0);//수량
					var nUct = parseInt(dsTcmSiteMngctChgDtlList.getCellData( i , "uct"+scwin.arrMonth[k] ), 0);//단가
					if(nQty == 0 && nUct > 0){//수량이 0일 경우
						com.showMessage("CMW0009", k+1, "", "", grdTcmSiteMngctChgDtlList.id, i, "qty"+scwin.arrMonth[k]);//$월 수량이 0입니다.
						return false;
					}
					if(nQty > 0 && nUct == 0){//단가가 0일 경우
						com.showMessage("CMW0010", k+1, "", "", grdTcmSiteMngctChgDtlList.id, i, "uct"+scwin.arrMonth[k]);//$월 단가가 0입니다.
						return false;
					}
				}//for end
			}
		}
		return true;
    }

    //버튼 제어
	scwin.fnBtnControl = function() {
		//버튼 초기화
		scwin.fnBtnInit();
		//결재상태에 따라 버튼 제어 처리
		if(dsTcmSiteMngctChgMap.get( "aprvNo" ) == ""	//결재번호 존재X [결재번호가 존재한다는 것은 결재 상신의 의미 기안 취소시 결재번호를 null로 update함]
			|| dsTcmSiteMngctChgMap.get( "dirmgExctAproCd" ) == "CM00401305"	//공무팀_반송
			){
			if(dsSearchMap.get( "exeYy" )  != ""){//현장의 기준년도가 존재하면.
				btnSave.setDisabled( false );//저장 button
				btnDel.setDisabled( false );//삭제 button
			}
		}else if(dsTcmSiteMngctChgMap.get( "dirmgExctAproCd" ) == "CM00401304"){//완료
			btnNew.setDisabled( false );//신규 button
		}
	}

	//Font 색상 변경
	scwin.fnFontColor = function(value, formattedValue , rowIdx, colIdx) {
    	if(parseInt(value, 0) < 0) {
    		grdTcmSiteMngctChgDtlList.setCellColor( rowIdx , colIdx , "red" );//음수
    	} else {
    		grdTcmSiteMngctChgDtlList.setCellColor( rowIdx , colIdx , "black" );//양수
    	}
    	return formattedValue;
	};

    /************************************************************************************
     *  [4] Callback 함수
     ************************************************************************************/
    /** 오류시 처리 **/
    scwin.fnErrCallBack = function(result, e) {

    };

    /************************************************************************************
     *  [5] Event 함수
     ************************************************************************************/
    //저장
	scwin.btnSave_onclick = function() {
		if(dsTcmSiteMngctChgDtlList.getModifiedJSON() == "") {
			com.showMessage("CSA0003");//저장(변경)할 내용이 없습니다.
			return false;
		} else if (scwin.fnSaveValidation() == false) {
			return false;
		}else if (confirm("저장 하시겠습니까?")) {

			dsTcmSiteMngctChgMap.set( "siteCd" , dsTcmSiteMngctChgDtlList.getCellData( 0 , "siteCd" ) );//현장코드
			dsTcmSiteMngctChgMap.set( "exeYy" , dsTcmSiteMngctChgDtlList.getCellData( 0 , "exeYy" ) );//실행년도

	        ajaxLib.ajax("/cm/cm1515/CM15150000U/saveTcmSiteMngctChgDtl", {
	            method : "POST",
	            requestData : {
	            				 tcmSiteMngctChg : dsTcmSiteMngctChgMap.getJSON()
	            				,tcmSiteMngctChgDtlList : dsTcmSiteMngctChgDtlList.getAllJSON()
	            			},
	            callback : //"fnCallback",
	                function(result, e){
		                com.showMessage("CFA0012");//저장되었습니다.
		                scwin.fnMaxChgDgr();
	            	},
	            errCallback : "fnErrCallBack"
	        });
		}
	};

	//엑셀 다운로드 이벤트
	scwin.btnExcelDwn_onclick = function() {
		var result = [];
		var totalCol = grdTcmSiteMngctChgDtlList.getTotalCol();
		for(var i = 0; i < totalCol; i++) {
			if (!grdTcmSiteMngctChgDtlList.getColumnVisible(i)) {
				result.push(i);
			}
		}
		var excelOpt = {
			 fileName: "현장관리비 예산변경.xlsx"    //또는 xlsx 확장자 사용
			,removeColumns: result.join(",")
		    ,useSubTotal: true    			//colMerge된 컬럼을 Merge해서 출력 할 지 여부
		    ,colMergeTextAlign: "center"    //colMerge된 컬럼의 textAlign설정 (bottom, center, top 설정)
			,colMerge : true
            ,headerFontColor : "#FFFFFF"    // Header Font Color
            ,headerColor : "#D9D9D9"        // Header Back Color
            ,subTotalColor : "#FCE4D6"      // SubTotal Back Color
            ,footerColor : "#BDD7EE"        // Footer Color
		};  //excel download 옵션
		grdTcmSiteMngctChgDtlList.advancedExcelDownload( excelOpt );
	};

	//현장관리비 내역 GRID 변경 이벤트
	//info값 - {"oldValue":"","newValue":"1","rowIndex":4,"colIndex":4}
	scwin.grdTcmSiteMngctChgDtlList_onviewchange = function(info) {

		var sColunmName = grdTcmSiteMngctChgDtlList.getColumnID( info.colIndex );
		var row = info.rowIndex;
		var col = info.colIndex;
        var value = info.newValue;
        var sPrefix = sColunmName.substring(0,3);//수량, 단가, 금액의 접두사
		var sMonth = sColunmName.substring(3,5);//01 ~ 12 개월
		var sNowYm = scwin.$w.getCurrentServerDate( "yyyyMM" );//현재날짜

		if(dsTcmSiteMngctChgDtlList.getCellData( row , "lv" ) == "2"){//변경후 ROW
			if(value == ""){//cell값이 존재하지 않을 경우 default 0으로 셋팅한다.
				dsTcmSiteMngctChgDtlList.setCellData( row, col, 0);
			}
	        if(sPrefix == "qty") {//수량
	        	dsTcmSiteMngctChgDtlList.setCellData( row , "amt"+sMonth , value * parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "uct"+sMonth ), 0) );//예산 (수량*단가)
	        } else if (sPrefix == "uct"){//단가
	        	dsTcmSiteMngctChgDtlList.setCellData( row , "amt"+sMonth , value * parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "qty"+sMonth ), 0) );//예산 (수량*단가)
	        }

	        if(sPrefix == "qty" || sPrefix == "uct") {//증감 수량, 단가, 예산 변경

	        	var bfThmmAsumBgt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row-1 , "thmmAsumBgt" ), 0);//변경전 당월누계 예산
	        	var afThmmAsumBgt = 0;//변경후 당월누계 예산

	        	var bfQty = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row-1 , "qty"+sMonth ), 0);//변경전 수량
	        	var bfUct = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row-1 , "uct"+sMonth ), 0);//변경전 단가
	        	var bfAmt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row-1 , "amt"+sMonth ), 0);//변경전 예산
	        	var afQty = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "qty"+sMonth ), 0);//변경후 수량
	        	var afUct = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "uct"+sMonth ), 0);//변경후 단가
	        	var afAmt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt"+sMonth ), 0);//변경후 예산
	        	var diffQty = afQty-bfQty;//증감 수량 (변경후 - 변경전)
	        	var diffUct = afUct-bfUct;//증감 단가 (변경후 - 변경전)
	        	var diffAmt = afAmt-bfAmt;//증감 예산 (변경후 - 변경전)

	        	//증감 (변경후 - 변경전)
				dsTcmSiteMngctChgDtlList.setCellData( row+1 , "qty"+sMonth ,  diffQty );//수량
				dsTcmSiteMngctChgDtlList.setCellData( row+1 , "uct"+sMonth ,  diffUct );//단가
				dsTcmSiteMngctChgDtlList.setCellData( row+1 , "amt"+sMonth ,  diffAmt );//예산

				//당월누계 예산 (현재년월보다 클경우는 제외)
				if(parseInt(sNowYm) >= parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "exeYy" ) + "" + sMonth)){
					for(var j=0; j<parseInt(sMonth); j++){
						afThmmAsumBgt = afThmmAsumBgt + parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt"+scwin.arrMonth[j] ), 0)
						dsTcmSiteMngctChgDtlList.setCellData( row , "thmmAsumBgt" , afThmmAsumBgt );
					}
					dsTcmSiteMngctChgDtlList.setCellData( row+1 , "thmmAsumBgt" , afThmmAsumBgt-bfThmmAsumBgt );//증감 당월누계 예산 (변경후 - 변경전)
				}

				//년누계_예산 (전년누계실적 + 1월부터 12월까지 예산의 합)
				var afYrAsumBgt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "bfyyAsumPfmcAmt" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt01" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt02" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt03" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt04" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt05" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt06" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt07" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt08" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt09" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt10" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt11" ), 0) +
								  parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "amt12" ), 0);

				dsTcmSiteMngctChgDtlList.setCellData( row , "yrAsumBgt" ,  afYrAsumBgt );//변경후 년누계_예산

				var bfYrAsumBgt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row-1 , "yrAsumBgt"), 0);//변경전 년누계_예산
				dsTcmSiteMngctChgDtlList.setCellData( row+1 , "yrAsumBgt" ,  afYrAsumBgt-bfYrAsumBgt );//증감 년누계_예산 (변경후 - 변경전)

				//잔여예산 (전체예산 - 년누계_예산)
				var nActbgtAmt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row , "actbgtAmt"), 0);//전체예산
				var afRemnBgt = nActbgtAmt-afYrAsumBgt;//변경후 잔여예산 (전체예산 - 변경후 년누계_예산)
				var bfRemnBgt = parseInt(dsTcmSiteMngctChgDtlList.getCellData( row-1 , "remnBgt"), 0);//변경전 잔여예산
				
				//잔여예산 컬럼 변경전, 변경후 증감 => 변경후만 보여지도록 수정 20190926
				dsTcmSiteMngctChgDtlList.setCellData( row-1 , "remnBgt" ,  afRemnBgt );//변경전 잔여예산
				dsTcmSiteMngctChgDtlList.setCellData( row , "remnBgt" ,  afRemnBgt );//변경후 잔여예산 (전체예산 - 변경후 년누계_예산)
				dsTcmSiteMngctChgDtlList.setCellData( row+1 , "remnBgt" ,  afRemnBgt );//증감 잔여예산

	        }
		}

	};

	//신규버튼 클릭 이벤트
	scwin.btnNew_onclick = function() {
		if (confirm("신규차수를 생성 하시겠습니까?")) {
	        ajaxLib.ajax("/cm/cm1515/CM15150000U/saveNewChgDgr", {
	            method : "POST",
	            requestData : dsSearchMap.getJSON(),
	            callback : //"fnCallback",
	                function(result, e){
	                	com.showMessage("CMW0011", result.data.newChgDgr + "차수");//$1이(가) 생성 되었습니다.
	                	dsSearchMap.set( "chgDgr" , result.data.newChgDgr );
	                	scwin.fnTcmSiteMngctChg();
	            	},
	            errCallback : "fnErrCallBack"
	        });
		}
	};

    //삭제버튼 클릭 이벤트
	scwin.btnDel_onclick = function() {
		if (confirm("삭제 하시겠습니까?")) {
	        ajaxLib.ajax("/cm/cm1515/CM15150000U/deleteTcmSiteMngctChgDtl", {
	            method : "POST",
	            requestData : {
	            				 tcmSiteMngctChg : dsTcmSiteMngctChgMap.getJSON()
	            			},
	            callback : //"fnCallback",
	                function(result, e){
		                com.showMessage("CMW0035");//삭제되었습니다.
		                scwin.fnMaxChgDgr();
	            	},
	            errCallback : "fnErrCallBack"
	        });
		}
	};
	]]></script>


		<w2:require src="/ux/common/udc/udcListCount.xml"></w2:require>
		<w2:require src="/ux/common/udc/udcSearchCode.xml"></w2:require>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group style="" id="" class="tab_body">
			<xf:group style="" id="" class="defaultbox">
				<w2:textbox label="현장관리비 내역" style="" id="" class="df_tt" tagname="h3"></w2:textbox>
				<w2:udc_list_count id="dsTotalCount"></w2:udc_list_count>
				<xf:group class="right_wrap" id="" style="">
					<xf:group class="" id="" style="">
						<w2:anchor class="btn_gcm" clickEventElement="" ev:onclick="scwin.btnNew_onclick" id="btnNew"
							outerDiv="false" style="">
							<xf:label><![CDATA[신규]]></xf:label>
						</w2:anchor>
						<w2:anchor class="btn_gcm" clickEventElement="" id="btnSave" outerDiv="false" style=""
							ev:onclick="scwin.btnSave_onclick">
							<xf:label><![CDATA[저장]]></xf:label>
						</w2:anchor>
						<w2:anchor class="btn_gcm" clickEventElement="" ev:onclick="scwin.btnDel_onclick" id="btnDel"
							outerDiv="false" style="">
							<xf:label><![CDATA[삭제]]></xf:label>
						</w2:anchor>
						<w2:anchor class="btn_gcm excel_down" clickEventElement=""
							ev:onclick="scwin.btnExcelDwn_onclick" id="btnExcelDwn" localeRef="" outerDiv="false" style=""
							toolTip="엑셀다운로드">
							<xf:label><![CDATA[엑셀다운로드]]></xf:label>
						</w2:anchor>
					</xf:group>
				</xf:group>

			</xf:group>
			<w2:gridView autoFit="lastColumn" class="autoHeight" dataList="data:dsTcmSiteMngctChgDtlList"
				fixedColumnWithHidden="true" focusMode="row" id="grdTcmSiteMngctChgDtlList" rowNumHeaderValue="No" rowNumVisible=""
				rowStatusHeaderValue="" rowStatusVisible="" rowStatusWidth="30" scrollByColumn="false" style="height: 300px;"
				useShiftKey="true" visibleRowNum="" ev:oncellclick="scwin.grdTcmWkrList_oncellclick"
				ev:onviewchange="scwin.grdTcmSiteMngctChgDtlList_onviewchange" checkReadOnlyOnPaste="true" enterKeyMove="down"
				keyMoveEditMode="true" preventAddRowOnPaste="true" ignoreNonEditableCell="true" fastScroll="false" contextMenu=""
				mergeCells="">
				<w2:caption style="" id="caption2" value="this is a grid caption."></w2:caption>
				<w2:header style="" id="header2">
					<w2:row style="" id="row5">
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;"
							id="column414" value="분류" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;"
							id="column295" value="내역" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:34px;"
							id="column419" value="규격" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="50" inputType="text" style="height:34px;"
							id="column294" value="단위" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="60" inputType="text" style="height:34px;"
							id="column293" value="비목" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;"
							id="column292" value="수량" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;"
							id="column291" value="전체예산" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;"
							id="column290" value="전년 누계실적" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:102px;"
							id="column441" value="잔여예산" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="60" inputType="text" style="height:34px;"
							id="column424" value="변경구분" blockSelect="false" displayMode="label" colSpan="" rowSpan="3">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;"
							id="column289" value="년도" blockSelect="false" displayMode="label" colSpan="52" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:34px;"
							id="column429" value="현장코드" blockSelect="false" displayMode="label" colSpan="" rowSpan="3" hidden="true">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:34px;"
							id="column434" value="내역코드" blockSelect="false" displayMode="label" colSpan="" rowSpan="3" hidden="true">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:34px;"
							id="column439" value="실행년도" blockSelect="false" displayMode="label" colSpan="" rowSpan="3" hidden="true">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:34px;"
							id="column440" value="변경구분" blockSelect="false" displayMode="label" colSpan="" rowSpan="3" hidden="true">
						</w2:column>
					</w2:row>
					<w2:row style="" id="row6">
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;"
							id="column348" value="1월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column344" value="2월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column340" value="3월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column336" value="4월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column332" value="5월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column328" value="6월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column324" value="7월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column320" value="8월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column316" value="9월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column312" value="10월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column308" value="11월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="280" inputType="text" style="height:34px;"
							id="column304" value="12월" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="140" inputType="text" style="height:34px;"
							id="column300" value="당월누계" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="140" inputType="text" style="height:34px;"
							id="column298" value="연누계" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
						</w2:column>
					</w2:row>
					<w2:row style="" id="row3">
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column223"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column221"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column219"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column217"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column215"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column213"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column211"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column209"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column207"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column205"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column203"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column201"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column199"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column197"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column195"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column193"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column191"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column189"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column187"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column185"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column183"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column181"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column179"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column177"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column175"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column173"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column171"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column169"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column167"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column165"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column163"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column161"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column159"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column157"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column155"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column153"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column151"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column149"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column147"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column145"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column143"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column141"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column139"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column137"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column135"
							value="수량" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column133"
							value="단가" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column131"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column129"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="column127"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="column125"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="column123"
							value="예산" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="column121"
							value="실적" blockSelect="false" displayMode="label">
						</w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody style="" id="gBody2">
					<w2:row style="" id="row4">
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="stndItemiNm"
							value="" blockSelect="false" displayMode="label" readOnly="true" textAlign="left" colMerge="true" colSpan=""
							displayType="" upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="bgtItemiNm"
							value="" blockSelect="false" displayMode="label" readOnly="true" textAlign="left" colMerge="true"
							upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="bgtItemiStdr"
							value="" blockSelect="false" displayMode="label" readOnly="true" colMerge="true" upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="50" inputType="text" style="" id="bgtItemiUnit"
							value="" blockSelect="false" displayMode="label" readOnly="true" colMerge="true" upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="60" inputType="text" style="" id="itexpGbNm"
							value="" blockSelect="false" displayMode="label" readOnly="true" colMerge="true" upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="actbgtQty"
							value="" blockSelect="false" displayMode="label" allowChar="0-9-" dataType="bigDecimal" defaultValue=""
							displayFormat="#,##0" readOnly="true" textAlign="right" colMerge="true" customFormatter="scwin.fnFontColor"
							applyFormat="all" upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="actbgtAmt"
							value="" blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0"
							readOnly="true" textAlign="right" colMerge="true" customFormatter="scwin.fnFontColor" applyFormat="all"
							upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="bfyyAsumPfmcAmt"
							value="" blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0"
							readOnly="true" textAlign="right" colMerge="true" customFormatter="scwin.fnFontColor" applyFormat="all"
							upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="remnBgt"
							value="" blockSelect="false" displayMode="label" colMerge="true" allowChar="0-9-" applyFormat="all" customFormatter="scwin.fnFontColor" dataType="number" displayFormat="#,##0" readOnly="true" textAlign="right" upperColumn="bgtItemiCd">
						</w2:column>
						<w2:column removeBorderStyle="false" width="60" inputType="text" style="" id="chgGb" value=""
							blockSelect="false" displayMode="label" readOnly="true">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty01" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="uct01" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt01" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc01" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty02" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct02" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt02" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc02" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty03" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct03" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt03" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc03" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty04" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct04" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt04" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc04" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty05" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct05" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt05" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc05" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty06" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct06" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt06" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc06" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty07" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct07" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt07" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc07" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty08" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct08" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt08" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc08" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty09" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct09" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt09" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc09" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty10" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct10" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt10" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc10" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty11" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct11" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt11" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc11" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="qty12" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" defaultValue="" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="uct12" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="amt12" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="pfmc12" value=""
							blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0" readOnly="true"
							textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="thmmAsumBgt"
							value="" blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="thmmAsumPfmc"
							value="" blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="yrAsumBgt"
							value="" blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="yrAsumPfmc"
							value="" blockSelect="false" displayMode="label" allowChar="0-9-" dataType="number" displayFormat="#,##0"
							readOnly="true" textAlign="right" customFormatter="scwin.fnFontColor" applyFormat="all">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="siteCd" value=""
							blockSelect="false" displayMode="label" readOnly="true">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="bgtItemiCd"
							value="" blockSelect="false" displayMode="label" readOnly="true">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="exeYy" value=""
							blockSelect="false" displayMode="label" readOnly="true">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="lv" value=""
							blockSelect="false" displayMode="label" readOnly="true">
						</w2:column>
					</w2:row>
				</w2:gBody>
			</w2:gridView>

		</xf:group>
	</body>
</html>
