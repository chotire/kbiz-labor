<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
			    <w2:dataList baseNode="list" id="dsTcfCloseInfoList" repeatNode="map" saveRemovedData="true" style="">
			        <w2:columnInfo>
			            <w2:column id="closeDeptCd" name="마감_부서코드" dataType="text"></w2:column>
			            <w2:column id="closeTypeCd" name="마감유형코드" dataType="text"></w2:column>
			            <w2:column id="closeYm" name="마감연월" dataType="text"></w2:column>
			            <w2:column id="closeJobCd" name="마감업무코드" dataType="text"></w2:column>
			            <w2:column id="closeYnNm" name="상태" dataType="text"></w2:column>
			            <w2:column id="closeDt" name="작업일시" dataType="text"></w2:column>
			            <w2:column id="closeEmpnm" name="작업자" dataType="text"></w2:column>
			            <w2:column id="release" name="마감/해제" dataType="text"></w2:column>
			            <w2:column id="closeYn" name="상태" dataType="text"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="false"></w2:data>
			    </w2:dataList>
			    <w2:dataMap baseNode="map" id="dsSearchMap">
			        <w2:keyInfo>
			            <w2:key id="siteCd" name="현장코드" dataType="text"></w2:key>
			            <w2:key id="closeYy" name="기준연월" dataType="text"></w2:key>
			            <w2:key id="lbatnDt" name="출역년월" dataType="text"></w2:key>
			            <w2:key id="siteNm" name="현장명" dataType="text"></w2:key>
			        </w2:keyInfo>
			    </w2:dataMap>
			    <w2:dataList baseNode="list" ev:onbeforerowpositionchange="scwin.dsList_onbeforerowpositionchange"
			        ev:oncelldatachange="scwin.dsList_oncelldatachange" ev:onrowpositionchange="scwin.dsList_onrowpositionchange" id="dsList"
			        repeatNode="map" saveRemovedData="true" style="">
			        <w2:columnInfo>
			            <w2:column dataType="text" id="siteCd" name="현장코드"></w2:column>
			            <w2:column dataType="text" id="siteNm" name="현장명"></w2:column>
			            <w2:column dataType="text" id="lbatnDt" name="출역일자"></w2:column>
			            <w2:column dataType="text" id="wkrNo" name="근로자번호"></w2:column>
			            <w2:column dataType="number" id="payAmt" name="지급금액"></w2:column>
			            <w2:column dataType="number" id="ictxAmt" name="소득세금액"></w2:column>
			            <w2:column dataType="number" id="rstxAmt" name="주민세금액"></w2:column>
			            <w2:column dataType="text" id="ockndCd" name="직종코드"></w2:column>
			            <w2:column dataType="text" id="ockndNm" name="직종명"></w2:column>
			            <w2:column dataType="number" id="netpayAmt" name="실지급금액"></w2:column>
			            <w2:column dataType="text" id="wkrNm" name="근로자명"></w2:column>
			            <w2:column dataType="text" id="mskSecResno" name="주민번호마스킹"></w2:column>
			            <w2:column dataType="number" id="natnpPnsnAmt" name="국민연금금액"></w2:column>
			            <w2:column dataType="number" id="eplmtInfeeAmt" name="고용보험료금액"></w2:column>
			            <w2:column dataType="number" id="hlthInfeeAmt" name="건강보험료금액"></w2:column>
			            <w2:column dataType="number" id="etcDdctAmt" name="기타공제금액"></w2:column>
			            <w2:column dataType="number" id="rtirDdctInsAmt" name="퇴직공제부금금액"></w2:column>
			            <w2:column dataType="number" id="etcPayAmt" name="기타지급금액"></w2:column>
			            <w2:column dataType="number" id="mealAmt" name="식대금액"></w2:column>
			            <w2:column dataType="number" id="bonsAmt" name="상여금액"></w2:column>
			            <w2:column dataType="text" id="mskWkrNm" name="근로자명마스킹"></w2:column>
			            <w2:column dataType="text" id="lbatnQty" name="출역수량"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="true"></w2:data>
			    </w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
		</xf:model>
		<script src="/resources/js/common/cmn_CM.js" type="javascript" lazy="false"/>
		<script type="javascript" lazy="false"><![CDATA[
/***************************************************************************
 * Program ID : CM70100000U.xml
 * Program Name : 노무마감관리
 * Author : JHLEE
 * Date : 2022.06.22
 * 
 * History 
 * ======================================== 
 * 변경일자     수정자   내 용 
 * ======================================== 
 *    
 **************************************************************************/
     /************************************************************************************
        DataCollection description
        dsTcfCloseInfoList: 월별 노무 마감현황
        dsList: 노무출역상세 
        dsSearchMap: 검색조건 parameter
     ************************************************************************************/

/**************************************************************************
 * [1] 전역변수 선언
 **************************************************************************/
/**************************************************************************
 * [2] onpageload(초기화포함)
 **************************************************************************/
    scwin.onpageload = function() {
        dsSearchMap.set( "closeYy" , WebSquare.date.getCurrentServerDate( "yyyy" ));
        cmCom.setSite(wfmKeySiteInfo.getWindow());  //현장 팝업 설정       
        scwin.btnFind_onclick();
        
        com.commonUI();
    };

/************************************************************************************
 *  [3] 사용자 정의함수 함수
 ************************************************************************************/
    /**************************************************************************
     * 함 수 명: scwin.fnSiteValidate
     * 기 능: 현장 검색조건 관련 Validate
     **************************************************************************/
    scwin.fnSiteValidate = function() {

        if (dsTcfCloseInfoList.getTotalRow() == 0) return true;

        let siteCd1 = dsSearchMap.get( "siteCd" );
        let siteCd2 = dsTcfCloseInfoList.getCellData( 0 , "closeDeptCd" );

        if (com.isEmpty(siteCd1)){
            com.showMessage("CFW0004", "현장");// $1을(를) 선택하십시오.
            return false;
        }

        // 검색영역의 현장코드와 비교
        if (siteCd1 != siteCd2) {
            com.showMessage("EMW0004", "검색항목에 변경된 현장");// $1을(를) 조회 하십시오.
            return false;
        }
        return true;
    };
    
    /**************************************************************************
     * 함 수 명: scwin.fnLeftList
     * 기 능: 월별 노무 마감현황
     **************************************************************************/  
    scwin.fnLeftList = function(row) {
        ajaxLib.ajax("/cm/cm6025/CM60250000U/selectCM60300000ULeftList", {
            method : "POST",
            requestData : dsSearchMap.getJSON(),
            callback : function(result, e){               
                dsTcfCloseInfoList.removeAll();     //현장이 노무마감 현장인지 유/무
                dsList.removeAll();                 //월별 노무출역 목록 조회
                
                dsTcfCloseInfoList.setJSON(result.data);
                
                for (let i = 0; i < dsTcfCloseInfoList.getTotalRow(); i++) {
                    if (dsTcfCloseInfoList.getCellData(i , "closeYn") == "Y") {
                        grdTcfCloseInfo.setCellInputType(i , "release", {inputType:"button"});
                        dsTcfCloseInfoList.setCellData(i , "release", "마감해제");
                    }else{
                        grdTcfCloseInfo.setCellInputType(i, "release", {inputType:"button"});
                        dsTcfCloseInfoList.setCellData(i, "release", "마감");
                    }
                }
                
                //김규룡 추가(2022-08-22)
                if(dsTcfCloseInfoList.getRowCount() > 0 && row == -1){
                    row = 0;
                }
                    
                //월별 노무 출역정보 조회
                if(row > -1){
					scwin.fnRightList(row);
                    grdTcfCloseInfo.setFocusedCell( row , 1 , true );   //김규룡 추가(2022-08-22)     
                }
                
                //김규룡 추가(2022-08-22)
                //월별 노무 출역정보 조회
//                if(dsTcfCloseInfoList.getRowCount() > 0){
//                    grdTcfCloseInfo.setFocusedCell( 0 , 1 , true );
//                    scwin.grdTcfCloseInfo_oncellclick(0,1);      
//                }
            },
            errCallback : function(result, e) {
                console.log(result);
            }
        });
	};
	
    /**************************************************************************
     * 함 수 명: scwin.fnRightList
     * 기 능: 월별 노무 출역 정보 조회
     **************************************************************************/       
    scwin.fnRightList = function(row) {
        ajaxLib.ajax("/cm/cm6025/CM60250000U/selectTcmLabrLbatnEtcList", {
            method : "POST",
            requestData : {
                 siteCd: dsTcfCloseInfoList.getCellData(row , "closeDeptCd")
               , lbatnDt: dsTcfCloseInfoList.getCellData(row , "closeYm") + "01"
            },
            callback : function(result, e){
                dsList.setJSON(result.data.dsList); 
                
                for(let ri = 0; ri < dsList.getRowCount(); ri++)
                {
                    let sLbatnQty = dsList.getCellData( ri ,  "lbatnQty");
                    if(sLbatnQty.indexOf(".") == -1)
                    {
                        dsList.setCellData( ri , "lbatnQty" , sLbatnQty + ".0");
                    } 
                }
                
                dsList.initRowStatus();     
            },
            errCallback: function(result, e) {
                console.log(result);
            }
        });
    }; 
    
    /**************************************************************************
     * 함 수 명: scwin.fnSaveCloseInfo
     * 기 능: 마감/마감해제 버튼 클릭 시
     **************************************************************************/    
	scwin.fnSaveCloseInfo = function(row, value, objData) {
		if (confirm(value + " 하시겠습니까?")) {
	        ajaxLib.ajax("/cm/cm7010/CM70100000U/saveTcfCloseInfo", {            
	            method : "POST",
	            requestData : objData,
	            callback : function(result, e){
	                com.showMessage("SCN0002", value);//$1 되었습니다.
	                scwin.fnLeftList(grdTcfCloseInfo.getFocusedRowIndex());//조회
				}, 
	            errCallback : function(result, e) {
	                console.log(result);
	            }
	        });
		}	        
    };    

    /**************************************************************************
     * 함 수 명: scwin.fnCloseInfoCheck
     * 기 능: 마감/해제시 validation 체크
     **************************************************************************/ 
	scwin.fnCloseInfoCheck = function(row, value) {
		let sCloseYn = "Y";//상태
        
		if(dsTcfCloseInfoList.getCellData(row , "closeYn") == "Y"){
			sCloseYn = "N";
		}
        
		let objData = {
                        closeDeptCd: dsTcfCloseInfoList.getCellData( row , "closeDeptCd" ),	//마감_부서코드
                        closeTypeCd: dsTcfCloseInfoList.getCellData( row , "closeTypeCd" ),	//마감유형코드
                        closeYm: dsTcfCloseInfoList.getCellData( row , "closeYm" ),		    //마감연월
                        closeJobCd: dsTcfCloseInfoList.getCellData( row , "closeJobCd" ),   //마감업무코드
                        closeYn: sCloseYn			
        		       };
        ajaxLib.ajax("/cm/cm7010/CM70100000U/selectCloseInfoCheck", {
            method : "POST",
            requestData : objData,
            callback : function(result, e) {
                if ("Y" == sCloseYn && result.data["bfCloseYm"] != null) {								//마감시
            		com.showMessage("CMW0013", cmCom.formatYyyyMm(result.data["bfCloseYm"], "-"));		//$1월이 마감되지않아 마감 할 수 없습니다.
            		return false;
            	}else if ("N" == sCloseYn && result.data["afCloseYm"] != null) {						//마감해제시
            		com.showMessage("CMW0015", cmCom.formatYyyyMm(result.data["afCloseYm"], "-"));		//$1월이 마감처리되어 마감해제 할 수 없습니다.
            		return false;
            	}else if ("N" == sCloseYn && "Y" == result.data["plCloseYn"]) {							//마감해제시
            		com.showMessage("CMW0066");															//해당월의 프로젝트손익이 마감되어 마감해제 할 수 없습니다.
            		return false;
				}else {
                    scwin.fnSaveCloseInfo(row, value, objData);
                }
            },
            errCallback: function(result, e) {
                console.log(result);
            }
        });	
	};
/************************************************************************************
 *  [4] Callback 함수 
 ************************************************************************************/
/************************************************************************************
 *  [5] Event 함수
 ************************************************************************************/
    /**************************************************************************
     * 함 수 명: scwin.btnFind_onclick
     * 기 능: 조회버튼 클릭
     **************************************************************************/
    scwin.btnFind_onclick = function() {
        if (com.isEmpty(dsSearchMap.get("siteCd"))) {
            com.showMessage("CMW0025", "현장");        //$1은(는) 필수입력입니다.
            return;
        }

        if (com.isEmpty(dsSearchMap.get("closeYy"))) {
            com.showMessage("CMW0025", "조회연도");    //$1은(는) 필수입력입니다.
            return;
        }
		scwin.fnLeftList(-1);//월별 노무 마감현황
    };
    
    //엑셀다운 버튼
    scwin.btnExcelDwnDtl_onclick = function() {
        let result = [];
        //result.push(1);//checkbox 제외
        
        let totalCol = grdList.getTotalCol();
        
        for(let exd = 0; exd < totalCol; exd++) {
            if (!grdList.getColumnVisible(exd)) {
                result.push(exd);
            }
        }
        
         let excelDtlOpt = {
             fileName: "월별_노무_출역.xlsx"    //또는 xlsx 확장자 사용
            ,removeColumns: result.join(",")
            ,useSubTotal: true                //colMerge된 컬럼을 Merge해서 출력 할 지 여부
            ,colMergeTextAlign: "center"    //colMerge된 컬럼의 textAlign설정 (bottom, center, top 설정)
            //,useStyle: "true"
            ,indent: 1
            , headerFontColor : "#FFFFFF"    // Header Font Color
            , headerColor : "#D9D9D9"        // Header Back Color
            , subTotalColor : "#FCE4D6"      // SubTotal Back Color
            , footerColor : "#BDD7EE"         // Footer Color
        };  //excel download 옵션
        
         grdList.advancedExcelDownload( excelDtlOpt );           
    };

    /**************************************************************************
     * 함 수 명: scwin.grdTcfCloseInfo_oncellclick
     * 기 능: 월별 마감현황 그리드 클릭
     **************************************************************************/
    scwin.grdTcfCloseInfo_oncellclick = function(row,col) {
        if(!scwin.fnSiteValidate()){
        	return;
        } 

        let colId = grdTcfCloseInfo.getColumnID(col);
        let value = dsTcfCloseInfoList.getCellData(row , colId);
  
		scwin.fnRightList(row); //월별 노무 출역정보 조회

		if(colId == "release") {//마감/해제 버튼 클릭 시
			scwin.fnCloseInfoCheck(row, value);
		}
    };

    /**************************************************************************
     * 함 수 명: scwin.WFrameSiteInfo_change_callback
     * 기 능: 현장코드 변경 이벤트
     **************************************************************************/    
	scwin.WFrameSiteInfo_change_callback = function() {
		dsSearchMap.set( "siteCd" , wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue() );
        dsTcfCloseInfoList.removeAll();
        dsList.removeAll();
        
        if(!com.isEmpty(dsSearchMap.get("closeYy")))
        {
            scwin.btnFind_onclick();
        }
	};      

	//월별 노무 마감 현황 엑셀 다운로드
	scwin.btnExcelDwn_onclick = function() {
        let result = [];
        let totalCol = grdTcfCloseInfo.getTotalCol();
        
        for(let ex = 0; ex < totalCol; ex++) {
            if (!grdTcfCloseInfo.getColumnVisible(ex)) {
                result.push(ex);
            }
        }
        
         let excelOpt = {
             fileName: "월별_노무_출역.xlsx"    //또는 xlsx 확장자 사용
            ,removeColumns: result.join(",")
            ,useSubTotal: true                //colMerge된 컬럼을 Merge해서 출력 할 지 여부
            ,colMergeTextAlign: "center"    //colMerge된 컬럼의 textAlign설정 (bottom, center, top 설정)
            //,useStyle: "true"
            ,indent: 1
            , headerFontColor : "#FFFFFF"    // Header Font Color
            , headerColor : "#D9D9D9"        // Header Back Color
            , subTotalColor : "#FCE4D6"      // SubTotal Back Color
            , footerColor : "#BDD7EE"         // Footer Color
        };  //excel download 옵션
        
         grdTcfCloseInfo.advancedExcelDownload( excelOpt );  		
	};
	]]></script>
        
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
	    <xf:group style="" id="" class="content_body">
	        <xf:group class="navigator_wrap" id="" style="">
	            <w2:wframe id="wfm_title" src="/ux/common/navigator.xml" style=""></w2:wframe>
	        </xf:group>
	        <xf:group class="tbl_search" id="" style="">
	            <xf:group class="tb_list" id="" style="" tagname="table">
	                <w2:attributes>
	                    <w2:summary>조회조건 테이블 입니다.</w2:summary>
	                </w2:attributes>
	                <xf:group tagname="colgroup">
	                    <xf:group style="width:67px;" tagname="col"></xf:group>
	                    <xf:group style="width:auto;" tagname="col"></xf:group>
	                    <xf:group style="width:94px;" tagname="col"></xf:group>
	                    <xf:group style="width:auto;" tagname="col"></xf:group>
	                    <xf:group style="width:67px;" tagname="col"></xf:group>
	                    <xf:group style="width:auto;" tagname="col"></xf:group>
	                </xf:group>
	                <xf:group style="" tagname="tr">
	                    <xf:group class="w2tb_th req" style="" tagname="th">
	                        <w2:attributes>
	                            <w2:scope>row</w2:scope>
	                        </w2:attributes>
	                        <w2:span class="" id="" label="현장" style=""></w2:span>
	                    </xf:group>
	                    <xf:group class="w2tb_td" style="width:30%;" tagname="td">
	                        <w2:wframe id="wfmKeySiteInfo" src="/WEB-INF/ux/cm/cmcomm/schSiteInfo.xml" style=""></w2:wframe>
	                    </xf:group>
	                    <xf:group class="w2tb_th req" style="" tagname="th">
	                        <w2:attributes>
	                            <w2:scope>row</w2:scope>
	                        </w2:attributes>
	                        <w2:span class="" id="" label="조회연도" style=""></w2:span>
	                    </xf:group>
	                    <xf:group class="w2tb_td" style="" tagname="td">
							<w2:inputCalendar footerDiv="false" id="calYear" style="width:120px" renderDiv="true" focusOnDateSelect="false"
    							calendarValueType="year" rightAlign="false" renderType="component" class="req" mandatory="" placeholder="____" ref="data:dsSearchMap.closeYy">
    						</w2:inputCalendar>
	                    </xf:group>
	                </xf:group>
	            </xf:group>
	            <xf:group class="btn_tbl_search" style="" tagname="">
	                <w2:anchor class="btn_sh" id="btnFind" outerDiv="false" style=""
	                    ev:onclick="scwin.btnFind_onclick">
	                    <xf:label><![CDATA[조회]]></xf:label>
	                </w2:anchor>
	            </xf:group>
	        </xf:group>
	        <xf:group class="lybox_wrap col_4_6" id="" style="">
	            <xf:group class="lybox" id="" style="">
	                <xf:group class="lycolumn" id="" style="">
	                    <xf:group class="lyinner" id="" style="">
	                        <xf:group class="defaultbox" id="" style="">
	                            <w2:textbox class="df_tt" id="" label="월별 노무 마감현황" style="" tagname="h3"></w2:textbox>
	                            <xf:group class="right_wrap" id="" style="">
	                                <xf:group id="" style=""></xf:group>
		                            <w2:anchor class="btn_gcm excel_down" clickEventElement="" id="btnExcelDwn" localeRef=""
										outerDiv="false" style="" toolTip="엑셀다운로드" ev:onclick="scwin.btnExcelDwn_onclick">
										<xf:label><![CDATA[엑셀다운로드]]></xf:label>
									</w2:anchor>
	                            </xf:group>
	                        </xf:group>
	                        <w2:gridView autoFit="allColumn" class="autoHeight" dataList="data:dsTcfCloseInfoList"
	                            fixedColumnWithHidden="true" focusMode="row" id="grdTcfCloseInfo" readOnly="true"
	                            rowNumHeaderValue="No" rowNumVisible="" rowStatusHeaderValue="" rowStatusVisible=""
	                            rowStatusWidth="30" scrollByColumn="false" style="height: 300px;" useShiftKey="true"
	                            visibleRowNum="" ev:oncellclick="scwin.grdTcfCloseInfo_oncellclick"
	                            setCellInputTypeCustom="true" autoFitMinWidth="470" preventPaste="true" selectedCellColor="" selectedRowColor="#FFFF00">
	                            <w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
	                            <w2:header style="" id="header1">
	                                <w2:row style="" id="row3">
	                                    <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;" id="column17"
	                                        value="마감연월" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;" id="column16"
	                                        value="노무마감" blockSelect="false" displayMode="label" colSpan="4" rowSpan="">
	                                    </w2:column>
	                                </w2:row>
	                                <w2:row style="" id="row1">
	                                    <w2:column removeBorderStyle="false" width="50" inputType="text" style="" id="column7" value="상태"
	                                        blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="160" inputType="text" style="" id="column5" value="작업일시"
	                                        blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="80" inputType="text" style="" id="column3" value="작업자"
	                                        blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column1" value="마감/해제"
	                                        blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                </w2:row>
	                            </w2:header>
	                            <w2:gBody style="" id="gBody1">
	                                <w2:row style="" id="row2">
	                                    <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="closeYm" value=""
	                                        blockSelect="false" displayMode="label" displayFormatter="" displayFormat="####-##">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="50" inputType="text" style="" id="closeYnNm" value=""
	                                        blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="160" inputType="text" style="" id="closeDt" value=""
	                                        blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="80" inputType="text" style="" id="closeEmpnm" value=""
	                                        blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="90" inputType="custom" style=""
	                                        id="release" value="" blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                </w2:row>
	                            </w2:gBody>
	                        </w2:gridView>
	                        <xf:group class="fc_red_bold ml10" id="" style="">
	                        </xf:group>
	                    </xf:group>
	                </xf:group>
	                <xf:group class="lycolumn" id="" style="">
	                    <xf:group class="lyinner" id="" style="">
	                        <xf:group class="defaultbox" id="" style="">
	                            <w2:textbox class="df_tt" id="" label="월별 노무 출역정보" style="" tagname="h3"></w2:textbox>
	                            <xf:group class="right_wrap" id="" style="">
	                                <xf:group id="" style="">
	                                </xf:group>
	                                <w2:anchor class="btn_gcm excel_down" clickEventElement="" id="btnExcelDwnDtl" localeRef=""
										outerDiv="false" style="" toolTip="엑셀다운로드" ev:onclick="scwin.btnExcelDwnDtl_onclick">
										<xf:label><![CDATA[엑셀다운로드]]></xf:label>
									</w2:anchor>
	                            </xf:group>
	                        </xf:group>
                            <w2:gridView autoFit="" class="autoHeight" id="grdList" dataList="data:dsList" editModeEvent="onclick"
            			    fixedColumnWithHidden="true" focusMode="row" keyMoveEditMode="true" readOnly="true" rowNumHeaderValue="No" rowNumVisible=""
            			    rowStatusHeaderValue="상태" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="false" style="height: 215px;"
            			    tooltipDisplay="true" useShiftKey="true" visibleRowNum="" ev:oncellindexchange="" ev:oncellclick="scwin.grdList_oncellclick"
            			    ev:onrowindexchange="" ev:onafteredit="scwin.grdList_onafteredit" preventPaste="true">
            			    <w2:header id="header1" style="">
            			        <w2:row id="row2" style="">
            			            <w2:column blockSelect="false" id="column21" fixColumnWidth="true" inputType="text" value="No" width="40"
            			                style="height:34px;" colSpan="" rowSpan="2">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;" id="column259" value="개인번호"
            			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;" id="column255" value="출역자"
            			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2" class="" textAlign="center">
            			            </w2:column>
            			            <w2:column blockSelect="false" id="column81" displayMode="label" inputType="text" removeBorderStyle="false"
            			                value="주민번호" width="110" style="height:34px;" colSpan="" rowSpan="2" textAlign="center">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="60" inputType="text" style="height:34px;" id="column221" value="공수"
            			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;" id="column223" value="지급내역"
            			                blockSelect="false" displayMode="label" colSpan="" rowSpan="">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:34px;" id="column229" value="공제내역"
            			                blockSelect="false" displayMode="label" class="" colSpan="6" rowSpan="">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;" id="column271" value="실지급액"
            			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="height:34px;" id="column274" value="퇴직공제부금"
            			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
            			            </w2:column>
            			        </w2:row>
            			        <w2:row style="" id="row11">
            			            <w2:column hidden="false" removeBorderStyle="false" width="100" inputType="text" style="height:34px;" id="column302"
            			                value="입금" blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column hidden="false" removeBorderStyle="false" width="80" inputType="text" style="height:34px;" id="column304"
            			                value="소득세" blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column hidden="false" removeBorderStyle="false" width="80" inputType="text" style="height:34px;" id="column305"
            			                value="주민세" blockSelect="false" displayMode="label" voidNull="">
            			            </w2:column>
            			            <w2:column hidden="false" removeBorderStyle="false" width="80" inputType="text" style="height:34px;" id="column306"
            			                value="국민연금" blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="80" inputType="text" style="height:34px;" id="column280" value="고용보험"
            			                blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="80" inputType="text" style="height:34px;" id="column279" value="건강보험"
            			                blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="80" inputType="text" style="height:34px;" id="column308" value="기타공제"
            			                blockSelect="false" displayMode="label">
            			            </w2:column>
            			        </w2:row>
            			    </w2:header>
            			    <w2:gBody id="gBody4" style="">
            			        <w2:row id="row5" style="">
            			            <w2:column blockSelect="false" expression="rowindex()+1" fixColumnWidth="true" id="column24" inputType="expression"
            			                readOnly="true" width="40">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="wkrNo" value="" blockSelect="false"
            			                displayMode="label" readOnly="true" textAlign="center">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="wkrNm" value="" blockSelect="false"
            			                displayMode="label" dataType="text" textAlign="center" readOnly="true" viewType="">
            			            </w2:column>
            			            <w2:column blockSelect="false" displayMode="label" id="mskSecResno" dataType="text" inputType="text" readOnly="true"
            			                removeBorderStyle="false" width="110" viewType="" textAlign="center">
            			            </w2:column>
            			            <w2:column blockSelect="false" displayMode="label" id="lbatnQty" dataType="text" fixColumnWidth="" inputType="text"
            			                removeBorderStyle="false" width="60" textAlign="right" displayFormat="" readOnly="true" allowChar="0-9.">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="payAmt" value="" blockSelect="false"
            			                displayMode="label" viewType="" textAlign="right" class="" imageSrc="" readOnly="true" dataType="number" allowChar="0-9"
            			                displayFormat="#,###">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="ictxAmt" value=""
            			                blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right" readOnly="true">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="rstxAmt" value=""
            			                blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right" readOnly="true"
            			                class="" imageSrc="" viewType="" voidNull="">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="natnpPnsnAmt" value="" blockSelect="false"
            			                displayMode="label" textAlign="right" dataType="number" displayFormat="#,###" readOnly="true">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="eplmtInfeeAmt" value="" blockSelect="false"
            			                displayMode="label" viewType="" textAlign="right" imageSrc="" class="" readOnly="true" dataType="number"
            			                displayFormat="#,###">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="hlthInfeeAmt" value="" blockSelect="false"
            			                displayMode="label" textAlign="right" dataType="number" displayFormat="#,###" readOnly="true">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="etcDdctAmt" value=""
            			                blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="netpayAmt" value=""
            			                blockSelect="false" displayMode="label" textAlign="right" displayType="" displayFormat="#,###" dataType="number"
            			                readOnly="true">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="rtirDdctInsAmt" value="" blockSelect="false"
            			                displayMode="label" textAlign="right" displayType="" displayFormat="#,###" dataType="number" readOnly="true">
            			            </w2:column>
            			        </w2:row>
            			    </w2:gBody>
            			    <w2:footer style="" id="footer2">
            			        <w2:row style="" id="row10">
            			            <w2:column removeBorderStyle="false" width="40" inputType="text" style="height:35px;" id="column254" value=""
            			                blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="" id="column261" value=""
            			                blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="text" style="height:35px;" id="column258"
            			                value="합 &amp;nbsp;계" blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="70" inputType="text" style="height:35px;" id="column253" value=""
            			                blockSelect="false" displayMode="label">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="60" inputType="expression" style="height:35px;" id="column250" value=""
            			                blockSelect="false" displayMode="label" expression="sum('lbatnQty')" dataType="number" displayFormat="#.0"
            			                textAlign="right" colSpan="" rowSpan="">
            			            </w2:column>
            			            <w2:column hidden="false" removeBorderStyle="false" width="100" inputType="expression" style="height:35px"
            			                id="column300" value="" blockSelect="false" displayMode="label" textAlign="right" expression="sum('payAmt')"
            			                displayFormat="#,###" dataType="number">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="expression" style="height:35px;" id="column249" value=""
            			                blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right" expression="sum('ictxAmt')"
            			                colSpan="" rowSpan="">
            			            </w2:column>
            			            <w2:column hidden="false" removeBorderStyle="false" width="90" inputType="expression" style="height:35px"
            			                id="column312" value="" blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right" expression="sum('rstxAmt')">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="expression" style="height:35px;" id="column245" value=""
            			                blockSelect="false" displayMode="label" colSpan="" rowSpan="" expression="sum('natnpPnsnAmt')" displayFormat="#,###"
            			                dataType="number" textAlign="right">
            			            </w2:column>
            			            <w2:column hidden="false" removeBorderStyle="false" width="90" inputType="expression" style="height:35px"
            			                id="column301" value="" blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###"
            			                expression="sum('eplmtInfeeAmt')" textAlign="right">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="expression" style="" id="column264" value=""
            			                blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" expression="sum('hlthInfeeAmt')"
            			                textAlign="right">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="90" inputType="expression" style="" id="column310" value=""
            			                blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right" expression="sum('etcDdctAmt')">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="expression" style="" id="column267" value=""
            			                blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" expression="sum('netpayAmt')"
            			                textAlign="right">
            			            </w2:column>
            			            <w2:column removeBorderStyle="false" width="100" inputType="expression" style="" id="column270" value=""
            			                blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" expression="sum('rtirDdctInsAmt')" textAlign="right">
            			            </w2:column>
            			        </w2:row>
            			    </w2:footer>
            			</w2:gridView>
	                    </xf:group>
	                </xf:group>
	            </xf:group>
	        </xf:group>
	    </xf:group>
	</body>
</html>
