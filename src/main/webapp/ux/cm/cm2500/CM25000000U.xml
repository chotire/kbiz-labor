<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
                <w2:dataList baseNode="list" repeatNode="map" style="" id="dsCM25000000UUp" saveRemovedData="true">
                	<w2:columnInfo>
                		<w2:column id="siteCd" name="현장코드" dataType="text"></w2:column>
                		<w2:column id="workYm" name="작업_연월" dataType="text"></w2:column>
                		<w2:column id="slipNo" name="전표번호" dataType="text"></w2:column>
                		<w2:column id="slipSeq" name="전표_순번" dataType="text"></w2:column>
                		<w2:column id="pcostinjtgbcd" name="원가투입구분코드" dataType="text"></w2:column>
                		<w2:column id="slipDt" name="전표일자" dataType="text"></w2:column>
                		<w2:column id="acctCd" name="계정코드" dataType="text"></w2:column>
                		<w2:column id="acctNm" name="계정명" dataType="text"></w2:column>
                		<w2:column id="slipAmt" name="전표_금액" dataType="text"></w2:column>
                		<w2:column id="evdcId" name="증빙_ID" dataType="text"></w2:column>
                		<w2:column id="evdcTypeNm" name="증빙_유형_명" dataType="text"></w2:column>
                		<w2:column id="vatRt" name="부가세_율" dataType="text"></w2:column>
                		<w2:column id="costType" name="원가유형" dataType="text"></w2:column>
                		<w2:column id="abstrCn" name="적요_내용" dataType="text"></w2:column>
                		<w2:column id="tradeCd" name="거래처코드" dataType="text"></w2:column>
                		<w2:column id="tradeNm" name="거래처_명" dataType="text"></w2:column>
                		<w2:column id="itexpGb" name="비목구분" dataType="text"></w2:column>
                		<w2:column id="taxYn" name="　" dataType="text"></w2:column>
                		<w2:column id="etcYn" name="투입결과" dataType="text"></w2:column>
                		<w2:column id="injtYm" name="투입연월(이체연월)" dataType="text"></w2:column>
                		<w2:column id="autoinjrslt" name="자동투입결과" dataType="text"></w2:column>
                		<w2:column id="autoinjmsg" name="메시지" dataType="text"></w2:column>
                		<w2:column id="slipCd" name="KEY VALUE" dataType="text"></w2:column>
                	</w2:columnInfo>
                	<w2:data use="false"></w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="dsCM25000000UDn1" repeatNode="map" saveRemovedData="true" style="">
                	<w2:columnInfo>
                		<w2:column id="chk" name="선택" dataType="text" ignoreStatus="true"></w2:column>
                		<w2:column id="siteCd" name="현장코드" dataType="text"></w2:column>
                		<w2:column id="upperBgtItemiCd" name="상위내역코드" dataType="text"></w2:column>
                		<w2:column id="upperBgtItemiNm" name="상위공종명" dataType="text"></w2:column>
                		<w2:column id="bgtItemiCd" name="내역코드" dataType="text"></w2:column>
                		<w2:column id="bgtItemiNm" name="내역명" dataType="text"></w2:column>
                		<w2:column id="bgtItemiStdr" name="규격" dataType="text"></w2:column>
                		<w2:column id="bgtItemiUnit" name="단위" dataType="text"></w2:column>
                		<w2:column id="itexpGb" name="비목구분" dataType="text"></w2:column>
                		<w2:column id="bgtStd" name="예산구분" dataType="text"></w2:column>
                		<w2:column id="plActbgtAmt" name="손익실행예산" dataType="text"></w2:column>
                		<w2:column id="pcostAmt" name="원가(실적)" dataType="text"></w2:column>
                		<w2:column id="exctAproYn" name="직영집행승인여부" dataType="text"></w2:column>
                	</w2:columnInfo>
                	<w2:data use="false"></w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="dsCM25000000UDn2" repeatNode="map" saveRemovedData="true" style="">
                	<w2:columnInfo>
                		<w2:column id="siteCd" name="현장코드" dataType="text"></w2:column>
                		<w2:column id="bgtItemiCd" name="내역코드" dataType="text"></w2:column>
                		<w2:column id="bgtItemiNm" name="내역명" dataType="text"></w2:column>
                		<w2:column id="pcostSeq" name="원가순번" dataType="text"></w2:column>
                		<w2:column id="bgtItemiStdr" name="규격" dataType="text"></w2:column>
                		<w2:column id="bgtItemiUnit" name="단위" dataType="text"></w2:column>
                		<w2:column id="itexpGb" name="비목구분" dataType="text"></w2:column>
                		<w2:column id="plActbgtAmt" name="손익실행예산" dataType="text"></w2:column>
                		<w2:column id="pcostAmt" name="누계집행원가" dataType="text"></w2:column>
                		<w2:column id="jobtyp" name="공종선택" dataType="text"></w2:column>
                		<w2:column id="rcgtPcostAmt" name="인정원가금액" dataType="text"></w2:column>
                		<w2:column id="diffAmt" name="공동원가" dataType="text"></w2:column>
                		<w2:column id="nrcgtPcostAmt" name="미인정원가금액" dataType="text"></w2:column>
                		<w2:column id="taxnRcgtPcostAmt" name="과세_인정_원가_금액" dataType="text"></w2:column>
                		<w2:column id="ntaxRcgtPcostAmt" name="비과세_인정_원가_금액" dataType="text"></w2:column>
                		<w2:column id="rcpsRcgtPcostAmt" name="영수증_인정_원가_금액" dataType="text"></w2:column>
                		<w2:column id="taxnNrcgtPcostAmt" name="과세_미인정_원가_금액" dataType="text"></w2:column>
                		<w2:column id="rcpsNrcgtPcostAmt" name="비과세_미인정_원가_금액" dataType="text"></w2:column>
                		<w2:column id="ntaxNrcgtPcostAmt" name="영수증_미인정_원가_금액" dataType="text"></w2:column>
                		<w2:column id="pcostTrnmYm" name="원가이체연월" dataType="text"></w2:column>
                		<w2:column id="slipNo" name="전표번호" dataType="text"></w2:column>
                		<w2:column id="slipSeq" name="전표_순번" dataType="text"></w2:column>
                		<w2:column id="acctCd" name="계정코드" dataType="text"></w2:column>
                		<w2:column id="workYm" name="작업_연월" dataType="text"></w2:column>
                	</w2:columnInfo>
                	<w2:data use="false"></w2:data>
                </w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
		</xf:model>
		<script type="javascript" lazy="false"><![CDATA[
/**************************************************************************
 * [1] 전역변수 선언
 **************************************************************************/

    var currKey1 = "";//본사이체목록 키값 : SLIP_NO + SLIP_SEQ
    var currKey2 = "";//대상공종 키값
    var currKey3 = "";//공종투입현황 키값
    var currRow = 0;//선택행
    var searchGbn = "N";//조회조건 변경 시 재조회 확인용

/**************************************************************************
 * [2] onpageload(초기화포함)
 **************************************************************************/
    scwin.onpageload = function() {

		var param = sessionLib.get("CM30100000UPARAM").split(":");

		sessionLib.del("CM30100000UPARAM");

		var siteCd = param[0];
		var siteNm = param[1];
		var closeYm = param[2];

		rdoStatus.setValue( "3" );
        com.setUdcValue("udcWorkYm","calYearMonth",dateLib.getCurrentDate().substring(0,6));
        com.commonUI();

		if (siteCd == "") {
	        cmCom.setSite(wfmKeySiteInfo.getWindow());	        
		} else {

			//이전화면에서 넘어온 값 세팅
			wfmKeySiteInfo.getWindow().ibxKeySiteCd.setValue(siteCd);
			wfmKeySiteInfo.getWindow().ibxKeySiteNm.setValue(siteNm);
	        com.setUdcValue("udcWorkYm","calYearMonth",closeYm);
	        scwin.btnFind_onclick();

		}
        com.selCdListVrbl("grdCM25000000UDn1:itexpGb", {"upperCd": "CM004100","setCd": "charValN1"});
        com.selCdListVrbl("grdCM25000000UDn2:itexpGb", {"upperCd": "CM004100","setCd": "charValN1"});
    };

/************************************************************************************
 *  [3] Event 함수
 ************************************************************************************/

    /**************************************************************************
     * 함 수 명: scwin.btnFind_onclick
     * 기 능: 조회버튼 클릭
     **************************************************************************/
    scwin.btnFind_onclick = function() {

        var siteCd = wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue();
        var workYm = com.getUdcValue("udcWorkYm","calYearMonth");
        var status = rdoStatus.getValue();

        if (siteCd == "") {
            com.showMessage("CFW0004", "현장");// $1을(를) 선택하십시오.
            return;
        }
        if (workYm == "") {
            com.showMessage("CFW0004", "작업연월");// $1을(를) 선택하십시오.
            return;
        }

        ajaxLib.ajax("/cm/cm2500/CM25000000U/selectCM25000000UUpList", {
            method : "POST",
            requestData : {
                siteCd : siteCd,
                workYm : workYm,
                status : status,
                closeDeptCd : siteCd,
                closeTypeCd : "CF00302",
                closeYm : workYm,
                closeJobCd : "CF00104",
            },
            callback : function(result, e){
                dsCM25000000UUp.setJSON( result.data.list );
                com.setUdcValue("cntUp","udcListCount",result.data.list.length);
                if (currKey1 != "") {
                    currRow = dsCM25000000UUp.getMatchedIndex( "slipCd" , currKey1 , true , 0 , dsCM25000000UUp.getTotalRow() )[0];
				} else {
                    currRow = 0;
                }
                grdCM25000000UUp.setFocusedCell( currRow , 0 , false );
                scwin.grdCM25000000UUp_oncellclick( currRow , 0 );
                searchGbn = "Y";
                
                //조회조건 작업연월 해당되는 손익추정/실적 마감 여부
                if (result.data.map == "Y") {
                	btnAutoInj.setDisabled( true );//자동투입
				}else{
					btnAutoInj.setDisabled( false );//자동투입
				}
				
				for (var i = 0; i < dsCM25000000UUp.getTotalRow(); i++) {
					if (dsCM25000000UUp.getCellData( i , "pcostinjtgbcd" ) == 0) {
						grdCM25000000UUp.setCellColor( i , "pcostinjtgbcd" , "red" );
					}else{
						grdCM25000000UUp.setCellColor( i , "pcostinjtgbcd" , "black" );
					}
				}
            },
            errCallback: function(result, e) {
                console.log(result);
            }
        });

    };

    //현장코드 변경 이벤트
    scwin.WFrameSiteInfo_change_callback = function(){
        scwin.btnFind_onclick();
    };

    /**************************************************************************
     * 함 수 명: scwin.grdCM25000000UUp_oncellclick
     * 기 능: 본사이체목록 그리드 클릭
     **************************************************************************/
    scwin.grdCM25000000UUp_oncellclick = function(row,col) {

        var colId = grdCM25000000UUp.getColumnID( col );

        var upRow = grdCM25000000UUp.getFocusedRowIndex();
        if (upRow == -1) {
            com.setUdcValue("cntDn1","udcListCount",0);
            com.setUdcValue("cntDn2","udcListCount",0);
            dsCM25000000UDn1.removeAll();
            dsCM25000000UDn2.removeAll();
			return;
		}
        var siteCd = dsCM25000000UUp.getCellData( upRow , "siteCd" );
        var workYm = com.getUdcValue("udcWorkYm","calYearMonth");
        var slipNo = dsCM25000000UUp.getCellData( upRow , "slipNo" );
        var slipSeq = dsCM25000000UUp.getCellData( upRow , "slipSeq" );
        var acctCd = dsCM25000000UUp.getCellData( upRow , "acctCd" );

        if (workYm == "") {
            com.showMessage("CFW0004", "작업연월");// $1을(를) 선택하십시오.
            return;
        }

        ajaxLib.ajax("/cm/cm2500/CM25000000U/selectCM25000000UDnList", {
            method : "POST",
            requestData : {
                siteCd : siteCd,
                workYm : workYm,
                slipNo : slipNo,
                slipSeq : slipSeq,
                acctCd : acctCd,
                closeDeptCd : siteCd,
                closeTypeCd : "CF00302",
                closeYm : dsCM25000000UUp.getCellData( upRow , "workYm" ),
                closeJobCd : "CF00104",
            },
            callback : function(result, e){
                dsCM25000000UDn1.setJSON( result.data.list1 );
                dsCM25000000UDn2.setJSON( result.data.list2 );
                
                com.setUdcValue("cntDn1","udcListCount",result.data.list1.length);
                com.setUdcValue("cntDn2","udcListCount",result.data.list2.length);
                
                for (var i = 0; i < result.data.list2.length; i++) {
                    grdCM25000000UDn2.setCellDisabled( i , "jobtyp" , true );//공종선택 ICON : 저장된 공종은 수정 불가
				}
				
                if (currKey2 != "bgtItemiCd") {
                    currRow = dsCM25000000UDn1.getMatchedIndex( "" , currKey2 , true , 0 , dsCM25000000UDn1.getTotalRow() )[0];
				}
                if (currKey3 != "") {
                    currRow = dsCM25000000UDn2.getMatchedIndex( "" , currKey3 , true , 0 , dsCM25000000UDn2.getTotalRow() )[0];
				}
				
                grdCM25000000UDn1.setFocusedCell( currRow , 0 , false );
                grdCM25000000UDn2.setFocusedCell( currRow , 0 , false );
                currKey1 = "";
                currKey2 = "";
                currKey3 = "";
                
                //본사이체목록의 workYm에 해당되는 손익추정/실적 마감 여부
				if (result.data.map == "Y") {
					setBtnStts(true);
				}else{
					setBtnStts(false);
				}
				                
            },
            errCallback: function(result, e) {
                console.log(result);
            }
        });

    };

    /**************************************************************************
     * 함 수 명: scwin.btnAutoInj_onclick
     * 기 능: 자동투입버튼 클릭
     **************************************************************************/
    scwin.btnAutoInj_onclick = function() {
		if (rdoStatus.getValue() != "3") {
			com.showMessage("SAA0055", "상태 조건", "미처리를 선택 후 조회");//$1을(를) $2하십시오.
			return false;
		}

		var row = grdCM25000000UUp.getFocusedRowIndex();

		if (row == -1) {
			com.showMessage("EMA0033");//처리할 데이터가 존재하지 않습니다.
			return;
		}

		if (searchGbn == "N") {
			com.showMessage("SAA0055", "미처리내역", "재 조회 후 처리");//$1을(를) $2하십시오.
			return;
		}

		if(confirm("자동투입하시겠습니까?")) {
			ajaxLib.ajax("/cm/cm2500/CM25000000U/autoInj", {
			    method : "POST",
			    requestData : {
			        siteCd : wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue(),
			        workYm : com.getUdcValue("udcWorkYm","calYearMonth"),
			        status : "3"
			    },
			    callback : function(result, e){

			        dsCM25000000UUp.setJSON( result.data );
			        for (var i = 0; i < dsCM25000000UUp.getTotalRow(); i++) {
					if (dsCM25000000UUp.getCellData( i , "autoinjrslt" ) == "E") {
						grdCM25000000UUp.setCellColor( i , "autoinjrslt" , "red" );
					}
				}

			    },
			    errCallback: function(result, e) {
			        console.log(result);
			    }
			});
		}

    };

    /**************************************************************************
     * 함 수 명: scwin.btnExcelDwn_onclick
     * 기 능: 엑셀버튼 클릭
     **************************************************************************/
    scwin.btnExcelDwn_onclick = function() {
        if(dsCM25000000UUp.getTotalRow() == 0){
            com.showMessage("CMW0020", "다운로드할");// $1 자료가 존재하지 않습니다.
            return;
        }
        var excelOpt = {};  //excel download 옵션
        excelOpt.fileName = "현장경비_Item_배분.xlsx";    //또는 xlsx 확장자 사용
        grdCM25000000UUp.advancedExcelDownload( excelOpt );
    };

    /**************************************************************************
     * 함 수 명: scwin.btnInject_onclick
     * 기 능: 공종투입버튼 클릭
     **************************************************************************/
    scwin.btnInject_onclick = function() {
       	var chkIdxArr = grdCM25000000UDn1.getCheckedIndex( "chk" );
		if (chkIdxArr == "") {
            com.showMessage("CFA0018", "대상공종에서 투입할 내역"); //$를 선택해 주십시오.
			return false;
		}
       	for (var i = 0; i < chkIdxArr.length; i++) {
			if (dsCM25000000UDn1.getCellData(chkIdxArr[i] , "bgtStd" ) == "1" || dsCM25000000UDn1.getCellData(chkIdxArr[i] , "bgtStd" ) == "4") {
				if (dsCM25000000UDn1.getCellData(chkIdxArr[i], "itexpGb" ) == "L" || dsCM25000000UDn1.getCellData(chkIdxArr[i], "itexpGb" ) == "O") {
					if (dsCM25000000UDn1.getCellData( chkIdxArr[i] , "exctAproYn" ) != "Y") {
						com.showMessage("CFW0010",dsCM25000000UDn1.getCellData( chkIdxArr[i] , "bgtItemiCd" )+" "+dsCM25000000UDn1.getCellData( chkIdxArr[i] , "bgtItemiNm" )+" 은 직영집행 미승인 아이템입니다."+"\r\n작업을 취소합니다.");//$1
						return;
					}
				}
			}
		}
        if (confirm("공종투입 하시겠습니까?")) {
        	var nRow1 = grdCM25000000UUp.getFocusedRowIndex();//본사이체목록 GRID
			var injectJSON = grdCM25000000UDn1.getCheckedJSON( "chk" );
			var tmpJsonData  = [];//추가할 ROW object 선언
			$.each(injectJSON, function(idx, item){
			
			  	var rcgtPcostAmtTmp = 0;
				if(idx == 0 && dsCM25000000UDn2.getUnmatchedData( "bgtItemiCd" , "" ) == ""){
					rcgtPcostAmtTmp = dsCM25000000UUp.getCellData( grdCM25000000UUp.getFocusedRowIndex() , "slipAmt" );//첫번째 ROW 셋팅시 본사이체목록 금액으로 집행원가를 셋팅힌다.
				}
							  
				var tmpRowData = {
					"siteCd" : item.siteCd                //현장코드
					,"bgtItemiCd" : item.bgtItemiCd       //내역코드
					,"bgtItemiNm" : item.bgtItemiNm       //내역명
					,"bgtItemiStdr" : item.bgtItemiStdr   //규격
					,"bgtItemiUnit" : item.bgtItemiUnit   //단위
					,"itexpGb" : item.itexpGb             //비목구분
					,"plActbgtAmt" : item.plActbgtAmt     //손익실행예산
					,"pcostAmt" : item.pcostAmt           //누계집행원가
					,"rcgtPcostAmt" : rcgtPcostAmtTmp     //인정원가금액           
					,"diffAmt" : rcgtPcostAmtTmp          //공동원가
					,"nrcgtPcostAmt" : 0                  //미인정원가금액
					,"taxnRcgtPcostAmt" : 0               //과세_인정_원가_금액
					,"ntaxRcgtPcostAmt" : 0               //비과세_인정_원가_금액
					,"rcpsRcgtPcostAmt" : 0               //영수증_인정_원가_금액
					,"taxnNrcgtPcostAmt" : 0              //과세_미인정_원가_금액
					,"rcpsNrcgtPcostAmt" : 0              //비과세_미인정_원가_금액
					,"ntaxNrcgtPcostAmt" : 0              //영수증_미인정_원가_금액
					,"pcostTrnmYm" : 'N'                  //원가이체연월
					,"slipNo" : dsCM25000000UUp.getCellData( nRow1 , "slipNo" )		//전표번호
					,"slipSeq" : dsCM25000000UUp.getCellData( nRow1 , "slipSeq" )	//전표순번
					,"acctCd" : dsCM25000000UUp.getCellData( nRow1 , "acctCd" )		//계정코드
					//,"workYm" : com.getUdcValue("udcWorkYm","calYearMonth")			//작업연월
					,"workYm" : dsCM25000000UUp.getCellData( nRow1 , "workYm" )			//작업연월
               	};
               	tmpJsonData.push(tmpRowData);				
			});
			dsCM25000000UDn2.insertJSON( grdCM25000000UDn2.getTotalRow() , tmpJsonData );
			grdCM25000000UDn1.checkAll( "chk" , false );//대상공종 check 전체 해제
			
		}
    };

    /**************************************************************************
     * 함 수 명: scwin.btnSave_onclick
     * 기 능: 저장버튼 클릭
     **************************************************************************/
    scwin.btnSave_onclick = function() {
		if (!scwin.fnSiteValidate()){
			return;
		}else if(dsCM25000000UDn2.getModifiedJSON() == ""){
			com.showMessage("CMW0024");//저장(변경)할 내용이 없습니다.
			return;
		}else if (checkStts()) {
			com.showMessage("CFW0010","공동도급 이체된 내역입니다. 작업을 취소합니다.");//$1;
			return;
		}
		
		for( var nRow = 0 ; nRow < dsCM25000000UDn2.getRowCount() ; nRow++){
			var sRcpsRcgtPcostAmt = dsCM25000000UDn2.getCellData( nRow , "rcgtPcostAmt" );   //집행원가
            var sBgtItemiCd       = dsCM25000000UDn2.getCellData( nRow , "bgtItemiCd" );         //내역코드
            if( com.isEmpty(sBgtItemiCd)  ){
                com.showMessage("SAA0043", "item", "", "", grdCM25000000UDn2.id, nRow , "jobtyp");//$1은(는) 필수입력사항입니다.
                return ;
            }
            if( sRcpsRcgtPcostAmt == 0  ){
                com.showMessage("SAA0043", "집행원가", "", "", grdCM25000000UDn2.id, nRow , "rcgtPcostAmt");//$1은(는) 필수입력사항입니다.
                return ;
            }
            // 아이템중복 여부 : 신규상태인 경우에만 CHECK
            // 중복여부 체크 로직 해제 : 11-25
            //if (dsCM25000000UDn2.getRowStatus( nRow ) == "C") {
	        //    for( var nSubRow = 0 ; nSubRow < dsCM25000000UDn2.getRowCount() ; nSubRow++){
	        //        if( sBgtItemiCd == dsCM25000000UDn2.getCellData( nSubRow , "bgtItemiCd" ) && dsCM25000000UDn2.getRowStatus( nSubRow ) == "C" && nRow != nSubRow ){
	        //        	com.showMessage("CMW0051", "", "", "", grdCM25000000UDn2.id, nRow , "jobtyp");//item이 중복 등록되었습니다.
	        //            return ;
	        //        }
	        //    }
	       	//}
        }

        var nRow1 = grdCM25000000UUp.getFocusedRowIndex();
        var nRow2 = grdCM25000000UDn1.getFocusedRowIndex();
        var nRow3 = grdCM25000000UDn2.getFocusedRowIndex();

        if( dsCM25000000UDn2.getTotalRow() != 0 && dsCM25000000UUp.getCellData( nRow1 , "slipAmt" ) != grdCM25000000UDn2.getFooterData( "totRcgtPcostAmt" )){
            com.showMessage("CMW0068", "집행원가 합이 상단 금액과", "", "");//$1 다릅니다.
            return ;
        }

        if (confirm("저장 하시겠습니까?")) {
	  		// taxid = 신용카드/면세(10006) --> EVDC_ID
            // taxid = 매입면세불공제,매출VAT(과세) (10003)
            // taxid = 매입계산서(10001)
            // ETC_YN ===> etcYn
            // taxyn ==> taxYn : 'N'
            // 매입부가세("M0000003" ) =>[to-be] TCM_ACTBGT 의 STND_ITEMI_CD = 'F-0001-0001'
        	var evdcId = dsCM25000000UUp.getCellData( nRow1 , "evdcId" );
        	var etcYn = dsCM25000000UUp.getCellData( nRow1 , "etcYn" );
        	var taxyn = dsCM25000000UUp.getCellData( nRow1 , "taxyn" );
        	var vatRt = dsCM25000000UUp.getCellData( nRow1 , "vatRt" );
 			var costType = dsCM25000000UUp.getCellData( nRow1 , "costType" );		// 1:과세, 2:비과세, 3:영수증  (추가)
        	var stndItemiCdArr = dsCM25000000UDn2.getColData( "stndItemiCd" );
        	
        	for (var i = 0; i < dsCM25000000UDn2.getTotalRow(); i++) {
        		var amt1 = dsCM25000000UDn2.getCellData( i , "diffAmt" );//공동원가(A-C)
        		var amt2 = dsCM25000000UDn2.getCellData( i , "nrcgtPcostAmt" );//미인정공동원가(C)
        		var colId1 = "";
        		var colId2 = "";
        		if (costType == "1") {
	        		colId1 = "taxnRcgtPcostAmt";
	        		colId2 = "taxnNrcgtPcostAmt";
				} else if (costType == "2") {
	        		colId1 = "ntaxRcgtPcostAmt";
	        		colId2 = "ntaxNrcgtPcostAmt";
				} else {
	        		colId1 = "rcpsRcgtPcostAmt";
	        		colId2 = "rcpsNrcgtPcostAmt";
				}
				// 매입부가세 경우
				if (stndItemiCdArr[i] == "F-0001-0001") {
	        		colId1 = "rcpsRcgtPcostAmt";
	        		colId2 = "rcpsNrcgtPcostAmt";
				}
        		/*// (증빙_ID == 신용카드/면세 OR 증빙_ID == 매입면세불공제,매출VAT(과세))
        		// AND 투입결과 == "Y"
				if ((evdcId == "10006" || evdcId == "10003") && etcYn == "Y") {
					colId1 = "rcpsRcgtPcostAmt";//영수증_인정_원가_금액
					colId2 = "rcpsNrcgtPcostAmt";//영수증_미인정_원가_금액
				}
        		// (증빙_ID == 신용카드/면세 OR 증빙_ID == 매입면세불공제,매출VAT(과세))
        		// AND taxyn == "N"
				else if((evdcId == "10006" || evdcId == "10003") && taxyn == "Y"){
					colId1 = "taxnRcgtPcostAmt";//과세_인정_원가_금액
					colId2 = "rcpsNrcgtPcostAmt";//영수증_미인정_원가_금액
				}else{
					//면세이고 매입부가세인 경우
					if (taxyn == "N" && stndItemiCdArr[i] == "F-0001-0001") {
						colId1 = "rcpsRcgtPcostAmt";//영수증_인정_원가_금액
						colId2 = "rcpsNrcgtPcostAmt";//영수증_미인정_원가_금액
					}else{
						//VAT율 있는경우
						if (vatRt > 0) {
							colId1 = "taxnRcgtPcostAmt";//과세_인정_원가_금액
							colId2 = "taxnNrcgtPcostAmt";//과세_미인정_원가_금액
						}
						//매입계산서인 경우
						else if(evdcId == "10001"){
							colId1 = "ntaxRcgtPcostAmt";//비과세_인정_원가_금액
							colId2 = "ntaxNrcgtPcostAmt";//비과세_미인정_원가_금액
						}else{
							colId1 = "rcpsRcgtPcostAmt";//영수증_인정_원가_금액
							colId2 = "rcpsNrcgtPcostAmt";//영수증_미인정_원가_금액
						}
					}
				}*/

				//관련없는 컬럼 초기화
				dsCM25000000UDn2.setCellData( i , "taxnRcgtPcostAmt" , 0 );
				dsCM25000000UDn2.setCellData( i , "ntaxRcgtPcostAmt" , 0 );
				dsCM25000000UDn2.setCellData( i , "rcpsRcgtPcostAmt" , 0 );
				dsCM25000000UDn2.setCellData( i , "taxnNrcgtPcostAmt" , 0 );
				dsCM25000000UDn2.setCellData( i , "ntaxNrcgtPcostAmt" , 0 );
				dsCM25000000UDn2.setCellData( i , "rcpsNrcgtPcostAmt" , 0 );
				//조건에 맞는 컬럼 값 세팅
				dsCM25000000UDn2.setCellData( i , colId1 , amt1 );
				dsCM25000000UDn2.setCellData( i , colId2 , amt2 );
			}

            currKey1 = dsCM25000000UUp.getCellData( nRow1 , "slipCd" );
            currKey2 = dsCM25000000UDn1.getCellData( nRow2 , "bgtItemiCd" );
            currKey3 = dsCM25000000UDn2.getCellData( nRow3 , "bgtItemiCd" );
			
            ajaxLib.ajax("/cm/cm2500/CM25000000U/saveCM25000000UList", {
                method : "POST",
                requestData : {
                    siteCd : dsCM25000000UUp.getCellData( nRow1 , "siteCd" ),
                    slipNo : dsCM25000000UUp.getCellData( nRow1 , "slipNo" ),
                    slipSeq : dsCM25000000UUp.getCellData( nRow1 , "slipSeq" ),
                    acctCd : dsCM25000000UUp.getCellData( nRow1 , "acctCd" ),
                    workYm : dsCM25000000UUp.getCellData( nRow1 , "workYm" ),
                    //workYm : com.getUdcValue("udcWorkYm","calYearMonth"),
                    tcmConstPcostList : dsCM25000000UDn2.getModifiedJSON()
                },
                callback : function(result, e){
                    com.showMessage("CFA0012");// 저장되었습니다.
                    scwin.btnFind_onclick();
                },
                errCallback: function(result, e) {
                    console.log(result);
                }
   	         });
   	         
        }
    };

    /**************************************************************************
     * 함 수 명: scwin.btnAddRow_onclick
     * 기 능: 행추가버튼 클릭
     **************************************************************************/
    scwin.btnAddRow_onclick = function() {
        // 현장조건 Check
        if (!scwin.fnSiteValidate()) return false;
	    var rowIndex = dsCM25000000UDn2.insertRow();
        var nRow1 = grdCM25000000UUp.getFocusedRowIndex();//본사이체목록 GRID
        
        dsCM25000000UDn2.setCellData( rowIndex , "siteCd" , wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue() );
        dsCM25000000UDn2.setCellData( rowIndex , "slipNo" , dsCM25000000UUp.getCellData( nRow1 , "slipNo" ) );//전표번호
        dsCM25000000UDn2.setCellData( rowIndex , "slipSeq" , dsCM25000000UUp.getCellData( nRow1 , "slipSeq" ) );//전표순번
        dsCM25000000UDn2.setCellData( rowIndex , "acctCd" , dsCM25000000UUp.getCellData( nRow1 , "acctCd" ) );//계정코드
        //dsCM25000000UDn2.setCellData( rowIndex , "workYm" , com.getUdcValue("udcWorkYm","calYearMonth") );//작업연월
        dsCM25000000UDn2.setCellData( rowIndex , "workYm" , dsCM25000000UUp.getCellData( nRow1 , "workYm" ) );//계정코드
        dsCM25000000UDn2.setCellData( rowIndex , "pcostTrnmYm" , "N" );//원가이체연월(N SET)
    };

    /**************************************************************************
     * 함 수 명: scwin.btnDelRow_onclick
     * 기 능: 행삭제버튼 클릭
     **************************************************************************/
    scwin.btnDelRow_onclick = function() {
        // 현장조건 Check
        if (!scwin.fnSiteValidate()) return false;
        var row = grdCM25000000UDn2.getFocusedRowIndex();
        
        //console.log("공종투입현황 Row : " + row);
        
        if (row < 0) {
			com.showMessage("CFW0010","삭제할 행을 선택하세요.");//$1;
			return;
        }
        
		if (dsCM25000000UDn2.getCellData( row , "pcostTrnmYm" ) != "N") {
			com.showMessage("CFW0010","공동도급 이체된 내역입니다. 작업을 취소합니다.");//$1;
			return;
		}        
        
        if (row != -1 && confirm("삭제하시겠습니까?")) {
            dsCM25000000UDn2.removeRow( row );
		}
    };

    /**************************************************************************
     * 함 수 명: scwin.grdCM25000000UDn2_oncellclick
     * 기 능: 공종투입현황 그리드 클릭
     **************************************************************************/
    scwin.grdCM25000000UDn2_oncellclick = function(row,col) {
        var colId = grdCM25000000UDn2.getColumnID( col );
        if (colId == "jobtyp") {
            /*
            var popOps = {
                          popup_name:"현장경비Item검색"
                        , url:"/ux/cm/cm4010/CM40100505P.xml"
                        , data:{paramKeySiteCd  :  wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue()   //현장코드
                              , paramKeyChkCnt : '0'                    //체크 항목  1 : 단건 , 1이 아닌경우 다건
                           	  , paramKeyItexpGb : 'L,O'                 //비목구분 노무[L], 경비[O]
                              , paramKeyYyyyMm : com.getUdcValue("udcWorkYm","calYearMonth")
                              , paramKeyPageGb : "CM25000000U"
                               }
                        , callbackFn : "scwin.fnPopupCallback"
                        , widType:"XL"
                        , height:"700"
                     };
            */
            let popOps = {
                popup_name: "분개공종 조회",
                url: "/ux/cm/cm4010/CM40100515P.xml",
                data: {
                    siteCd: wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue(),
                    itexpGb: "O",                           //비목구분 자재[M], 경비[O], 외주[S], 직영[D], 현장관리비[T]
                    yyyyMm: com.getCurrentDate().substring(0,6),
                    multiSelectYn: false,                    //다건 선택 true, 단건 선택 false
                    
                },
                callbackFn: "scwin.fnPopupCallback",
                widType: "XL",
                height: "700"
            };
            com.popup_open(popOps);
		}
    };

    /**************************************************************************
     * 함 수 명: scwin.grdCM25000000UDn2_onafteredit
     * 기 능: 공종투입현황 그리드 편집 후 처리
     **************************************************************************/
    scwin.grdCM25000000UDn2_onafteredit = function(row,col,value) {
        var amt1 = dsCM25000000UDn2.getCellData( row , "rcgtPcostAmt" );
        var amt2 = dsCM25000000UDn2.getCellData( row , "nrcgtPcostAmt" );
        dsCM25000000UDn2.setCellData( row , "diffAmt" , Number(amt1)-Number(amt2) );
    };

    /**************************************************************************
     * 함 수 명: scwin.rdoStatus_onchange
     * 기 능: 상태 변경 시 처리
     **************************************************************************/
	scwin.rdoStatus_onchange = function() {
		//if (rdoStatus.getValue() == "3") {
		//	btnAutoInj.show("inline");
		//}else{
		//	btnAutoInj.hide();
		//}
		searchGbn = "N";
	};


/************************************************************************************
 *  [4] 사용자 정의함수 함수
 ************************************************************************************/

    /**************************************************************************
     * 함 수 명: scwin.fnSiteValidate
     * 기 능: 현장 검색조건 관련 Validate
     **************************************************************************/
    scwin.fnSiteValidate = function() {
        if (dsCM25000000UUp.getTotalRow() == 0) return;
        if ( wfmKeySiteInfo.getObj( "ibxKeySiteCd" ).getValue().length == 0){
            com.showMessage("CFW0004", "현장");// $1을(를) 선택하십시오.
            return false;
        }
        // 검색영역의 현장코드와 비교
        if (wfmKeySiteInfo.getObj( "ibxKeySiteCd" ).getValue() != dsCM25000000UUp.getCellData( 0 , "siteCd" )) {
            com.showMessage("EMW0004", "검색항목에 변경된 현장");// $1을(를) 조회 하십시오.
            return false;
        }
        return true;
    };

    /**************************************************************************
     * 함 수 명: scwin.fnPopupCallback
     * 기 능: 팝업 콜백
     **************************************************************************/
    scwin.fnPopupCallback = function(arg) {
        debugger;
        if(arg != ""){
		    var nRow = grdCM25000000UUp.getFocusedRowIndex();
		    var nSubRow = grdCM25000000UDn2.getFocusedRowIndex();
		    
			for (var i = 0; i < arg.length; i++) {
				//if (dsCM25000000UDn2.getMatchedIndex( "bgtItemiCd" , arg[i].bgtItemiCd , true , 0 , dsCM25000000UDn2.getTotalRow() ) == "") {
					//if (dsCM25000000UDn2.getCellData( nSubRow+i , "bgtItemiCd" ) == "") {
					if (i > 0) {
						dsCM25000000UDn2.insertRow( nSubRow+i );
					}

					if(dsCM25000000UDn2.getUnmatchedData( "bgtItemiCd" , "" ) == ""){
						dsCM25000000UDn2.setCellData( 0 , "rcgtPcostAmt" , dsCM25000000UUp.getCellData( grdCM25000000UUp.getFocusedRowIndex() , "slipAmt" ) );//첫번째 ROW 셋팅시 본사이체목록 금액으로 집행원가를 셋팅힌다.
						dsCM25000000UDn2.setCellData( 0 , "diffAmt" , dsCM25000000UUp.getCellData( grdCM25000000UUp.getFocusedRowIndex() , "slipAmt" ) );//첫번째 ROW 셋팅시 본사이체목록 금액으로 집행원가를 셋팅힌다.
					}else{
						dsCM25000000UDn2.setCellData( nSubRow+i , 'rcgtPcostAmt', 0 );               //인정원가금액
						dsCM25000000UDn2.setCellData( nSubRow+i , 'diffAmt', 0 );                    //공동원가
					}
					
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'siteCd' , dsCM25000000UUp.getCellData( nRow , 'siteCd' ) );   //현장코드
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'bgtItemiCd' , arg[i].bgtItemiCd);   //내역코드
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'bgtItemiNm' , arg[i].bgtItemiNm);   //내역명
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'bgtItemiStdr' , arg[i].bgtItemiStdr);  //규격
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'itexpGb' , arg[i].itexpGb);  //비목
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'plActbgtAmt'       , arg[i].plActbgtAmt);   //손익실행예산
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'pcostAmt'  , arg[i].pcostAmt);      //누계집행원가
		            dsCM25000000UDn2.setCellData( nSubRow+i , 'pcostTrnmYm'      , "N");               //1:내역, 2:월예산, 3:중분류
					//dsCM25000000UDn2.setCellData( nSubRow+i , 'rcgtPcostAmt', 0 );                    //인정원가금액
					//dsCM25000000UDn2.setCellData( nSubRow+i , 'diffAmt' , 0 );                        //공동원가
					dsCM25000000UDn2.setCellData( nSubRow+i , 'nrcgtPcostAmt' , 0 );                  //미인정원가금액         
					dsCM25000000UDn2.setCellData( nSubRow+i , 'taxnRcgtPcostAmt' , 0 );               //과세_인정_원가_금액    
					dsCM25000000UDn2.setCellData( nSubRow+i , 'ntaxRcgtPcostAmt' , 0 );               //비과세_인정_원가_금액  
					dsCM25000000UDn2.setCellData( nSubRow+i , 'rcpsRcgtPcostAmt' , 0 );               //영수증_인정_원가_금액  
					dsCM25000000UDn2.setCellData( nSubRow+i , 'taxnNrcgtPcostAmt' , 0 );              //과세_미인정_원가_금액  
					dsCM25000000UDn2.setCellData( nSubRow+i , 'rcpsNrcgtPcostAmt' , 0 );              //비과세_미인정_원가_금액
					dsCM25000000UDn2.setCellData( nSubRow+i , 'ntaxNrcgtPcostAmt' , 0 );              //영수증_미인정_원가_금액
					dsCM25000000UDn2.setCellData( nSubRow+i , 'slipNo' , dsCM25000000UUp.getCellData( nRow , 'slipNo' ) );    //전표번호
					dsCM25000000UDn2.setCellData( nSubRow+i , 'slipSeq' , dsCM25000000UUp.getCellData( nRow , 'slipSeq' ) );  //전표순번
					dsCM25000000UDn2.setCellData( nSubRow+i , 'acctCd' , dsCM25000000UUp.getCellData( nRow , 'acctCd' ) );    //계정코드
					dsCM25000000UDn2.setCellData( nSubRow+i , 'workYm' , dsCM25000000UUp.getCellData( nRow , 'workYm' ) );    //작업연월
				}
			//}
			//dsCM25000000UDn2.removeRow( dsCM25000000UDn2.getMatchedIndex( "bgtItemiCd" , "" , true , 0 , dsCM25000000UDn2.getTotalRow() ) );
        }

    }

    function setBtnStts(flag){
		btnInject.setDisabled( flag );
		btnSave.setDisabled( flag );
		btnAddRow.setDisabled( flag );
		btnDelRow.setDisabled( flag );
    }

    /**************************************************************************
     * 기 능: 공동도급이체 여부 체크 --> 저장 시에만 체크 (수정인 경우에만)
     **************************************************************************/
    function checkStts(){
		var retVal = false;
		for (var i = 0; i < dsCM25000000UDn2.getTotalRow(); i++) {
			if (dsCM25000000UDn2.getRowStatus( i ) == "U" && dsCM25000000UDn2.getCellData( i , "pcostTrnmYm" ) != "N") {
				retVal = true;
			}
		}
		return retVal;
    }
	]]></script>
		<script src="/resources/js/common/cmn_CM.js" type="javascript" lazy="false"/>
		<script src="/resources/js/commonUI.js" type="javascript" lazy="false"/>
		<w2:require src="/WEB-INF/ux/common/udc/udcYearMonthcalendar.xml"></w2:require>
        <w2:require src="/ux/common/udc/udcListCount.xml"></w2:require>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
	    <xf:group style="" id="" class="content_body">
	        <xf:group class="navigator_wrap" id="" style="">
	            <w2:wframe id="wfm_title" src="/ux/common/navigator.xml" style=""></w2:wframe>
	        </xf:group>
	        <xf:group class="tbl_search" id="" style="">
	            <xf:group class="tb_list" id="" style="" tagname="table">
	                <w2:attributes>
	                    <w2:summary>조회조건 테이블 입니다.</w2:summary>
	                </w2:attributes>
	                <xf:group tagname="colgroup">
	                    <xf:group style="width:67px;" tagname="col"></xf:group>
	                    <xf:group style="width:auto;" tagname="col"></xf:group>
	                    <xf:group style="width:94px;" tagname="col"></xf:group>
	                    <xf:group style="width:auto;" tagname="col"></xf:group>
	                    <xf:group style="width:67px;" tagname="col"></xf:group>
	                    <xf:group style="width:auto;" tagname="col"></xf:group>
	                </xf:group>
	                <xf:group style="" tagname="tr">
	                    <xf:group class="w2tb_th req" style="" tagname="th">
	                        <w2:attributes>
	                            <w2:scope>row</w2:scope>
	                        </w2:attributes>
	                        <w2:span class="" id="" label="현장" style=""></w2:span>
	                    </xf:group>
	                    <xf:group class="w2tb_td" style="" tagname="td">
	                    	<w2:wframe id="wfmKeySiteInfo" src="/WEB-INF/ux/cm/cmcomm/schSiteInfo.xml" style=""></w2:wframe>
	                    </xf:group>
	                    <xf:group class="w2tb_th req" style="" tagname="th">
	                        <w2:attributes>
	                            <w2:scope>row</w2:scope>
	                        </w2:attributes>
	                        <w2:span class="" id="" label="작업연월" style=""></w2:span>
	                    </xf:group>
	                    <xf:group class="w2tb_td" style="" tagname="td">
	                        <w2:udc_yearMonthcalendar id="udcWorkYm" style=""></w2:udc_yearMonthcalendar>
	                    </xf:group>
	                    <xf:group class="w2tb_th req" tagname="th">
	                        <w2:attributes>
	                            <w2:scope>row</w2:scope>
	                        </w2:attributes>
	                        <w2:span class="" id="" label="상태" style=""></w2:span>
	                    </xf:group>
	                    <xf:group class="w2tb_td" tagname="td">
	                        <w2:attributes></w2:attributes>
	                        <xf:select1 appearance="full" class="" cols="3" id="rdoStatus" renderType="radiogroup"
	                            rows="" selectedIndex="0" style="" ref="" ev:onchange="scwin.rdoStatus_onchange">
	                            <xf:choices>
	                                <xf:item>
	                                    <xf:label>전체</xf:label>
	                                    <xf:value><![CDATA[1]]></xf:value>
	                                </xf:item>
	                                <xf:item>
	                                    <xf:label>처리</xf:label>
	                                    <xf:value><![CDATA[2]]></xf:value>
	                                </xf:item>
	                                <xf:item>
	                                    <xf:label>미처리</xf:label>
	                                    <xf:value><![CDATA[3]]></xf:value>
	                                </xf:item>
	                            </xf:choices>
	                        </xf:select1>
	                    </xf:group>
	                </xf:group>
	            </xf:group>
	            <xf:group class="btn_tbl_search" style="" tagname="">
	                <w2:anchor class="btn_sh" id="btnFind" outerDiv="false" style=""
	                    ev:onclick="scwin.btnFind_onclick">
	                    <xf:label><![CDATA[조회]]></xf:label>
	                </w2:anchor>
	            </xf:group>
	        </xf:group>
	        <xf:group style="" id="" class="defaultbox">
	            <w2:textbox label="본사이체목록" style="" id="" class="df_tt" tagname="h3"></w2:textbox>
	            <w2:udc_list_count id="cntUp"></w2:udc_list_count>
	            <xf:group class="right_wrap" id="" style="">
	                <xf:group id="" style="">
	                    <w2:anchor class="btn_gcm" clickEventElement="" id="btnAutoInj" outerDiv="false" style=""
	                        ev:onclick="scwin.btnAutoInj_onclick">
	                        <xf:label><![CDATA[자동투입]]></xf:label>
	                    </w2:anchor>
	                    <w2:anchor class="btn_gcm excel_down" clickEventElement="" id="btnExcelDwn" localeRef=""
	                        outerDiv="false" style="" toolTip="엑셀다운로드" ev:onclick="scwin.btnExcelDwn_onclick">
	                        <xf:label><![CDATA[엑셀다운로드]]></xf:label>
	                    </w2:anchor>
	                </xf:group>
	            </xf:group>
	        </xf:group>
	        <w2:gridView readOnly="true" autoFit="allColumn" class="" dataList="data:dsCM25000000UUp"
	            fixedColumnWithHidden="true" focusMode="row" id="grdCM25000000UUp" rowNumHeaderValue="No" rowNumVisible=""
	            rowStatusHeaderValue="" rowStatusVisible="" rowStatusWidth="30" scrollByColumn="false"
	            style="height: 311px;" useShiftKey="true" visibleRowNum=""
	            ev:oncellclick="scwin.grdCM25000000UUp_oncellclick" autoFitMinWidth="" checkReadOnlyOnCut="true" checkReadOnlyOnPaste="true" tooltipDisplay="true">
	            <w2:header id="header1" style="">
	                <w2:row id="row2" style="">
	                    <w2:column blockSelect="false" displayMode="label" id="column49" inputType="text"
	                        removeBorderStyle="false" style="" value="No." width="60">
	                    </w2:column>
	                    <w2:column blockSelect="false" id="column21" inputType="text" style="" value="상태" width="60"
	                        sortable="true">
	                    </w2:column>
	                    <w2:column blockSelect="false" id="column19" inputType="text" style="" value="작성일자"
	                        width="100">
	                    </w2:column>
	                    <w2:column blockSelect="false" id="column17" inputType="text" style="" value="전표번호"
	                        width="150">
	                    </w2:column>
	                    <w2:column blockSelect="false" id="column15" inputType="text" style="" value="계정명"
	                        width="202">
	                    </w2:column>
	                    <w2:column blockSelect="false" displayMode="label" id="column37" inputType="text"
	                        removeBorderStyle="false" style="" value="금액(원)" width="100">
	                    </w2:column>
	                    <w2:column blockSelect="false" displayMode="label" id="column35" inputType="text"
	                        removeBorderStyle="false" style="" value="증빙유형" width="100">
	                    </w2:column>
	                    <w2:column blockSelect="false" displayMode="label" id="column41" inputType="text"
	                        removeBorderStyle="false" style="" value="적요" width="200">
	                    </w2:column>
	                    <w2:column removeBorderStyle="false" width="130" inputType="text" style="" id="column51"
	                        value="거래처" blockSelect="false" displayMode="label">
	                    </w2:column>
	                    <w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="column53"
	                        value="이체연월" blockSelect="false" displayMode="label">
	                    </w2:column>
	                    <w2:column hidden="false" removeBorderStyle="false" width="90" inputType="text" style=""
	                        id="column71" value="자동투입결과" blockSelect="false" displayMode="label">
	                    </w2:column>
	                    <w2:column removeBorderStyle="false" width="200" inputType="text" style="" id="column72"
	                        value="메시지" blockSelect="false" displayMode="label">
	                    </w2:column>
	                </w2:row>
	            </w2:header>
	            <w2:gBody id="gBody4" style="">
	                <w2:row id="row5" style="">
	                    <w2:column blockSelect="false" displayMode="label" expression="rowindex()+1" id="column24"
	                        inputType="expression" removeBorderStyle="false" width="60">
	                    </w2:column>
	                    <w2:column blockSelect="false" id="pcostinjtgbcd" inputType="select" width="60" class=""
	                        allOption="" chooseOption="" ref="">
	                        <w2:choices>
	                            <w2:item>
	                                <w2:label><![CDATA[미처리]]></w2:label>
	                                <w2:value><![CDATA[0]]></w2:value>
	                            </w2:item>
	                            <w2:item>
	                                <w2:label><![CDATA[처리]]></w2:label>
	                                <w2:value><![CDATA[1]]></w2:value>
	                            </w2:item>
	                        </w2:choices>
	                    </w2:column>
	                    <w2:column blockSelect="false" id="slipDt" inputType="text" width="100" displayFormat="####-##-##"></w2:column>
	                    <w2:column blockSelect="false" id="slipNo" inputType="text" width="150"></w2:column>
	                    <w2:column blockSelect="false" id="acctNm" inputType="text" textAlign="left" width="202"
	                        class="fc_blue">
	                    </w2:column>
	                    <w2:column blockSelect="false" displayMode="label" id="slipAmt" inputType="text"
	                        removeBorderStyle="false" textAlign="right" width="100" displayFormat="#,###.#"
	                        dataType="number">
	                    </w2:column>
	                    <w2:column blockSelect="false" displayMode="label" id="evdcTypeNm" inputType="text"
	                        removeBorderStyle="false" width="100">
	                    </w2:column>
	                    <w2:column blockSelect="false" displayMode="label" id="abstrCn" inputType="text"
	                        removeBorderStyle="false" width="200" textAlign="left">
	                    </w2:column>
	                    <w2:column removeBorderStyle="false" width="130" inputType="text" id="tradeNm"
	                        blockSelect="false" displayMode="label" textAlign="left">
	                    </w2:column>
	                    <w2:column removeBorderStyle="false" width="100" inputType="text" id="injtYm"
	                        blockSelect="false" displayMode="label" displayFormat="####-##">
	                    </w2:column>
	                    <w2:column removeBorderStyle="false" width="90" inputType="select" id="autoinjrslt"
	                    	blockSelect="false" displayMode="label" viewType="default" readOnly="false" allOption=""
	                    	chooseOption="" ref="">
	                    	<w2:choices>
	                    		<w2:item>
	                    			<w2:label><![CDATA[성공]]></w2:label>
	                    			<w2:value><![CDATA[S]]></w2:value>
	                    		</w2:item>
	                    		<w2:item>
	                    			<w2:label><![CDATA[실패]]></w2:label>
	                    			<w2:value><![CDATA[E]]></w2:value>
	                    		</w2:item>
	                    	</w2:choices>
	                    </w2:column>
	                    <w2:column removeBorderStyle="false" width="400" inputType="text" style="" id="autoinjmsg" value=""
	                        blockSelect="false" displayMode="label" textAlign="left">
	                    </w2:column>
	                </w2:row>
	            </w2:gBody>
	        </w2:gridView>
	        <xf:group class="lybox_wrap col_4_6" id="" style="">
	            <xf:group class="lybox" id="" style="">
	                <xf:group class="lycolumn" id="" style="">
	                    <xf:group class="lyinner" id="" style="">
	                        <xf:group class="defaultbox" id="" style="">
	                            <w2:textbox class="df_tt" id="" label="대상공종" style="" tagname="h3"></w2:textbox>
	                            <w2:udc_list_count id="cntDn1"></w2:udc_list_count>
	                            <xf:group class="right_wrap" id="" style="">
	                                <xf:group id="" style="">
	                                    <w2:anchor class="btn_gcm" id="btnInject" outerDiv="false" style=""
	                                        ev:onclick="scwin.btnInject_onclick">
	                                        <xf:label><![CDATA[공종투입]]></xf:label>
	                                    </w2:anchor>
	                                </xf:group>
	                            </xf:group>
	                        </xf:group>
	                        <w2:gridView autoFit="lastColumn" class="autoHeight" dataList="data:dsCM25000000UDn1"
	                        	fixedColumnWithHidden="true" focusMode="row" id="grdCM25000000UDn1" readOnly=""
	                        	rowNumHeaderValue="No" rowNumVisible="" rowStatusHeaderValue="" rowStatusVisible=""
	                        	rowStatusWidth="30" scrollByColumn="false" style="height: 300px;" useShiftKey="true"
	                        	visibleRowNum="" checkReadOnlyOnCut="true" checkReadOnlyOnPaste="true">
	                        	<w2:header id="header1" style="">
	                        		<w2:row id="row2" style="">
	                        			<w2:column blockSelect="false" displayMode="label" id="column49"
	                        				inputType="checkbox" removeBorderStyle="false" style="" width="60"
	                        				readOnly="false" viewType="icon">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column21" inputType="text" sortable="true"
	                        				style="" value="공종" width="140">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column19" inputType="text"
	                        				style="" value="Item" width="100">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column17" inputType="text"
	                        				style="" value="규격" width="100">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column15" inputType="text"
	                        				style="" value="단위" width="80">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="column37"
	                        				inputType="text" removeBorderStyle="false" style="" value="비목" width="80">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="column35"
	                        				inputType="text" removeBorderStyle="false" style="" value="실행예산" width="120">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="column51"
	                        				inputType="text" removeBorderStyle="false" style="" value="원가" width="120">
	                        			</w2:column>
	                        			<w2:column removeBorderStyle="false" width="70" inputType="text" style=""
	                        				id="column52" value="직영집행&lt;br/&gt;승인여부" blockSelect="false" displayMode="label">
	                        			</w2:column>
	                        		</w2:row>
	                        	</w2:header>
	                        	<w2:gBody id="gBody4" style="">
	                        		<w2:row id="row5" style="">
	                        			<w2:column blockSelect="false" displayMode="label" id="chk" inputType="checkbox"
	                        				removeBorderStyle="false" width="60" readOnly="" viewType="icon">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="upperBgtItemiNm" inputType="text"
	                        				textAlign="left" width="140" readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="bgtItemiNm" inputType="text" textAlign="left"
	                        				width="100" readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="bgtItemiStdr" inputType="text" width="100"
	                        				readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="bgtItemiUnit" inputType="text" width="80"
	                        				readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="itexpGb"
	                        				inputType="select" removeBorderStyle="false" width="80" readOnly="true">
	                        				<w2:choices></w2:choices>
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayFormat="#,###.#" displayMode="label"
	                        				id="plActbgtAmt" inputType="text" removeBorderStyle="false" textAlign="right" width="120"
	                        				dataType="number" readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="pcostAmt"
	                        				inputType="text" removeBorderStyle="false" width="120" displayFormat="#,###.#"
	                        				dataType="number" textAlign="right" readOnly="true">
	                        			</w2:column>
	                        			<w2:column removeBorderStyle="false" width="70" inputType="text" style=""
	                        				id="exctAproYn" value="" blockSelect="false" displayMode="label" textAlign="center" readOnly="true">
	                        			</w2:column>
	                        		</w2:row>
	                        	</w2:gBody>
	                        </w2:gridView>
	                    </xf:group>
	                </xf:group>
	                <xf:group class="lycolumn" id="" style="">
	                    <xf:group class="lyinner" id="" style="">
	                        <xf:group class="defaultbox" id="" style="">
	                            <w2:textbox class="df_tt" id="" label='공종투입현황' style="" tagname="h3"></w2:textbox>
	                            <w2:udc_list_count id="cntDn2"></w2:udc_list_count>
	                            <xf:group class="right_wrap" id="" style="">
	                                <xf:group id="" style="">
	                                    <w2:anchor class="btn_gcm" clickEventElement="" id="btnSave" outerDiv="false"
	                                        style="" ev:onclick="scwin.btnSave_onclick">
	                                        <xf:label><![CDATA[저장]]></xf:label>
	                                    </w2:anchor>
	                                    <w2:anchor class="btn_gcm row_add" clickEventElement="" id="btnAddRow"
	                                        outerDiv="false" style="" toolTip="행추가" ev:onclick="scwin.btnAddRow_onclick">
	                                        <xf:label><![CDATA[행추가]]></xf:label>
	                                    </w2:anchor>
	                                    <w2:anchor class="btn_gcm row_del" clickEventElement="" id="btnDelRow"
	                                        outerDiv="false" style="" toolTip="행삭제" ev:onclick="scwin.btnDelRow_onclick">
	                                        <xf:label><![CDATA[행삭제]]></xf:label>
	                                    </w2:anchor>
	                                </xf:group>
	                            </xf:group>
	                        </xf:group>
	                        <w2:gridView autoFit="allColumn" class="autoHeight" dataList="data:dsCM25000000UDn2"
	                            fixedColumnWithHidden="true" focusMode="row" id="grdCM25000000UDn2" readOnly=""
	                            rowNumHeaderValue="No" rowNumVisible="" rowStatusHeaderValue="" rowStatusVisible=""
	                            rowStatusWidth="30" scrollByColumn="false" style="height: 300px;" useShiftKey="true"
	                            visibleRowNum="" autoFitMinWidth=""
	                            ev:oncellclick="scwin.grdCM25000000UDn2_oncellclick"
	                            ev:onafteredit="scwin.grdCM25000000UDn2_onafteredit" checkReadOnlyOnCut="true" checkReadOnlyOnPaste="true" keyMoveEditMode="true" ignoreNonEditableCell="true" enterKeyMove="down">
	                            <w2:header id="header1" style="">
	                                <w2:row id="row2" style="">
	                                    <w2:column blockSelect="false" displayMode="label" id="column49"
	                                        inputType="text" removeBorderStyle="false" style="" value="No." width="40">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="column21" inputType="text" sortable="true"
	                                        style="" value="Item" width="120">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="column19" inputType="text" style=""
	                                        value="규격" width="70">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="column17" inputType="text" style=""
	                                        value="비목" width="60">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="column15" inputType="text" style=""
	                                        value="실행예산" width="120">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayMode="label" id="column37"
	                                        inputType="text" removeBorderStyle="false" style="" value="누계집행원가"
	                                        width="120">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="40" inputType="text" style=""
	                                        id="column62" value="공종&lt;br/&gt;선택" blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayMode="label" id="column35"
	                                        inputType="text" removeBorderStyle="false" style="" value="집행원가(A)"
	                                        width="120">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayMode="label" id="column41"
	                                        inputType="text" removeBorderStyle="false" style="" value="공동원가(A-C)"
	                                        width="120">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayMode="label" id="column51"
	                                        inputType="text" removeBorderStyle="false" style="" value="미인정공동원가(C)"
	                                        width="120">
	                                    </w2:column>
	                                </w2:row>
	                            </w2:header>
	                            <w2:gBody id="gBody4" style="">
	                                <w2:row id="row5" style="">
	                                    <w2:column blockSelect="false" displayMode="label" expression="rowindex()+1"
	                                        id="column24" inputType="expression" removeBorderStyle="false" width="40">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="bgtItemiNm" inputType="text" textAlign="left"
	                                        width="120" readOnly="true">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="bgtItemiStdr" inputType="text" width="70"
	                                        readOnly="true">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="itexpGb" inputType="select" width="60"
	                                        readOnly="true">
	                                        <w2:choices></w2:choices>
	                                    </w2:column>
	                                    <w2:column blockSelect="false" id="plActbgtAmt" inputType="text"
	                                        textAlign="right" width="120" displayFormat="#,##0" dataType="number"
	                                        readOnly="true">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayMode="label" id="pcostAmt"
	                                        inputType="text" removeBorderStyle="false" textAlign="right" width="120"
	                                        displayFormat="#,##0" dataType="number" readOnly="true">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="40" inputType="image" style=""
	                                        id="jobtyp" value="" blockSelect="false" displayMode="label"
	                                        imageSrc="/resources/images/content/ico_grid_find.png">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayFormat="#,##0" displayMode="label"
	                                        id="rcgtPcostAmt" inputType="text" removeBorderStyle="false"
	                                        textAlign="right" width="120" dataType="number" expression="" allowChar="0-9-" applyFormat="all">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayMode="label" id="diffAmt" inputType="text"
	                                        removeBorderStyle="false" width="120" displayFormat="#,##0" dataType="number"
	                                        textAlign="right" readOnly="true"
	                                        expression="'rcgtPcostAmt' - 'nrcgtPcostAmt'">
	                                    </w2:column>
	                                    <w2:column blockSelect="false" displayMode="label" id="nrcgtPcostAmt"
	                                        inputType="text" removeBorderStyle="false" width="120" displayFormat="#,##0"
	                                        dataType="number" textAlign="right" allowChar="0-9-" applyFormat="all">
	                                    </w2:column>
	                                </w2:row>
	                            </w2:gBody>
	                            <w2:footer style="" id="footer1">
	                                <w2:row style="" id="row6">
	                                    <w2:column removeBorderStyle="false" width="120" inputType="text"
	                                        style="height:20px;" id="column61" value="합계" blockSelect="false"
	                                        displayMode="label" colSpan="6">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="40" inputType="text" style=""
	                                        id="column64" value="" blockSelect="false" displayMode="label">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="120" inputType="expression"
	                                        style="height:20px;" id="totRcgtPcostAmt" blockSelect="false"
	                                        displayMode="label" expression="sum('rcgtPcostAmt')" textAlign="right"
	                                        dataType="number" displayFormat="#,##0">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="120" inputType="expression"
	                                        style="height:20px;" id="column54" blockSelect="false" displayMode="label"
	                                        expression="sum('diffAmt')" textAlign="right" dataType="number"
	                                        displayFormat="#,##0">
	                                    </w2:column>
	                                    <w2:column removeBorderStyle="false" width="120" inputType="expression"
	                                        style="height:20px;" id="column53" blockSelect="false" displayMode="label"
	                                        expression="sum('nrcgtPcostAmt')" textAlign="right" dataType="number"
	                                        displayFormat="#,##0">
	                                    </w2:column>
	                                </w2:row>
	                            </w2:footer>
	                        </w2:gridView>
	                    </xf:group>
	                </xf:group>
	            </xf:group>
	        </xf:group>
	    </xf:group>
	</body>
</html>
