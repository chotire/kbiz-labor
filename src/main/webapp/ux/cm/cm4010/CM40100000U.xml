<?xml version="1.0" encoding="UTF-8"?>
<!-- <?xml-stylesheet href="/src/main/webapp/resources_ux/css/common.css" type="text/css"?>
<?xml-stylesheet href="/src/main/webapp/resources_ux/css/content.css" type="text/css"?> -->

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" repeatNode="map" style="" id="dsTcmInsurAdjEtcDdctList"
					saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="chkSelect" name="선택" dataType="text"></w2:column>
						<w2:column id="calcTaxYn" name="세금계산서" dataType="text"></w2:column>
						<w2:column id="siteCd" name="현장코드" dataType="text"></w2:column>
						<w2:column id="erndSeq" name="근로_순번" dataType="text"></w2:column>
						<w2:column id="wkrNo" name="근로자번호" dataType="text"></w2:column>
						<w2:column id="wkrNm" name="근로자_명" dataType="text"></w2:column>
						<w2:column id="resnoEnc" name="주민등록번호_암호화" dataType="text"></w2:column>
						<w2:column id="erndLabrSalGbCd" name="근로구분코드/노무급여구분코드" dataType="text"></w2:column>
						<w2:column id="workYm" name="지급_연월" dataType="text"></w2:column>
						<w2:column id="payYm" name="지급_연월" dataType="text"></w2:column>
						<w2:column id="lbatnTm" name="출역_시간" dataType="text"></w2:column>
						<w2:column id="workDays" name="출역_일자" dataType="text"></w2:column>
						<w2:column id="avgDywgAmt" name="평균_일급_금액" dataType="text"></w2:column>
						<w2:column id="bsalAmt" name="기본급_금액" dataType="text"></w2:column>
						<w2:column id="extnExpyAmt" name="연장_수당_금액" dataType="text"></w2:column>
						<w2:column id="hldyErndExpyAmt" name="휴일_근로_수당_금액" dataType="text"></w2:column>
						<w2:column id="hldyExpyAmt" name="휴일_수당_금액" dataType="text"></w2:column>
						<w2:column id="yyvctExpyAmt" name="연차_수당_금액" dataType="text"></w2:column>
						<w2:column id="especExpyAmt" name="특별_수당_금액" dataType="text"></w2:column>
						<w2:column id="payAmt" name="지급_금액" dataType="text"></w2:column>
						<w2:column id="natnpPnsnAdjAmt" name="국민_연금_정산_금액" dataType="number"></w2:column>
						<w2:column id="hlthInsurAdjAmt" name="건강_보험_정산_금액" dataType="number"></w2:column>
						<w2:column id="taxnTargDys" name="과세_대상_일수" dataType="text"></w2:column>
						<w2:column id="taxnTargAmt" name="과세_대상_금액" dataType="text"></w2:column>
						<w2:column id="ictxAmt" name="소득세_금액" dataType="text"></w2:column>
						<w2:column id="rstxAmt" name="주민세_금액" dataType="text"></w2:column>
						<w2:column id="yeAdjIctxAmt" name="연말_정산_소득세_금액" dataType="text"></w2:column>
						<w2:column id="yeAdjRstxAmt" name="연말_정산_주민세_금액" dataType="text"></w2:column>
						<w2:column id="taxAmt" name="세액계" dataType="text"></w2:column>
						<w2:column id="eplmtInfeeAmt" name="고용_보험료_금액" dataType="text"></w2:column>
						<w2:column id="natnpPnsnAmt" name="국민_연금_금액" dataType="text"></w2:column>
						<w2:column id="hlthInfeeAmt" name="건강_보험료_금액" dataType="text"></w2:column>
						<w2:column id="etcDdctAmt" name="기타_공제_금액" dataType="number"></w2:column>
						<w2:column id="deductAmt" name="공제계" dataType="text"></w2:column>
						<w2:column id="fnlPayAmt" name="최종_지급_금액(차인지급금액)" dataType="text"></w2:column>
						<w2:column id="editYn" name="수정가능여부" dataType="text"></w2:column>
						<w2:column id="pcostYn" name="공종완료여부" dataType="text"></w2:column>
						<w2:column id="email" name="메일" dataType="text"></w2:column>
						<w2:column id="slipYn" name="전표여부" dataType="text"></w2:column>
						<w2:column id="prgsStusCd" name="전표 상태 " dataType="text"></w2:column>
						<w2:column id="prgsStusNm" name="전표 상태 명	" dataType="text"></w2:column>
						<w2:column id="injtYm" name="투입연월" dataType="text"></w2:column>
					</w2:columnInfo>
					<w2:data use="false">
						<!-- <w2:row></w2:row>
							<w2:row></w2:row>
							<w2:row></w2:row>
							<w2:row></w2:row>
							<w2:row></w2:row>
							<w2:row></w2:row>
							<w2:row></w2:row>
							<w2:row></w2:row>
							<w2:row></w2:row> -->
					</w2:data>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dsSrchMap" style="">
					<w2:keyInfo>
						<w2:key dataType="text" id="keySiteCd" name="현장코드"></w2:key>
						<w2:key dataType="text" id="keyLbatnYymm" name="출연년월"></w2:key>
						<w2:key dataType="text" id="keyAdpGbCd" name="근로구분"></w2:key>
						<w2:key id="erndGbCd" name="근로구분코드[CM005001] 세금계산/취소시 사용" dataType="text"></w2:key>
						<w2:key id="domainUrl" name="도메인" dataType="text"></w2:key>
						<w2:key id="laborGbn" name="원천세 구분" dataType="text"></w2:key>
						<w2:key id="closeYn" name="마감 여부" dataType="text"></w2:key>
						<w2:key id="slipYn" name="전표 여부" dataType="text"></w2:key>
						<w2:key id="aprvYn" name="name9" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dsSelMap" style="">
					<w2:keyInfo>
						<w2:key dataType="text" id="siteCd" name="현장코드"></w2:key>
						<w2:key dataType="number" id="row" name="진행하는 행번호"></w2:key>
						<w2:key dataType="text" id="pcostRsvGbVal" name="[공종]원가_예비_구분_값"></w2:key>
						<w2:key dataType="text" id="subRow" name="[공종]행번호"></w2:key>
						<w2:key dataType="text" id="yyyyMm" name="년월"></w2:key>
						<w2:key id="pageGb" name="페이지구분" dataType="text"></w2:key>
						<w2:key id="injtYm" name="투입연월" dataType="text"></w2:key>
						<w2:key id="wkrNo" name="name8" dataType="text"></w2:key>
						<w2:key id="erndSeq" name="name9" dataType="text"></w2:key>
						<w2:key id="erndGbCd" name="name10" dataType="text"></w2:key>
						<w2:key id="laborGbn" name="name11" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" id="dsStusCdList" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="cd" name="코드값"></w2:column>
						<w2:column dataType="text" id="cdNm" name="코드명"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" id="dsTcmConstPcostList" repeatNode="map" saveRemovedData="true"
					style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="siteCd" name="현장코드"></w2:column>
						<w2:column dataType="text" id="workYm" name="작업_연월"></w2:column>
						<w2:column dataType="text" id="tradeCd" name="거래처코드"></w2:column>
						<w2:column dataType="text" id="pcostSeq" name="원가_순번"></w2:column>
						<w2:column dataType="text" id="pcostRsvGbVal" name="원가_예비_구분_값"></w2:column>
						<w2:column dataType="text" id="bgtItemiCd" name="내역코드"></w2:column>
						<w2:column dataType="text" id="bgtItemiNm" name="내역명"></w2:column>
						<w2:column dataType="text" id="bgtItemiStdr" name="규격"></w2:column>
						<w2:column dataType="text" id="plActbgtAmt" name="손익실행예산"></w2:column>
						<w2:column dataType="text" id="pcostAmt" name="누계집행원가"></w2:column>
						<w2:column dataType="text" id="remnBgt" name="잔여예산"></w2:column>
						<w2:column dataType="text" id="rcpsRcgtPcostAmt" name="영수증_인정_원가_금액"></w2:column>
						<w2:column dataType="text" id="jobtyp" name="공정선택"></w2:column>
						<w2:column dataType="text" id="upperBgtItemiCd" name="상위_예산내역코드"></w2:column>
						<w2:column dataType="text" id="bgtStd" name="1:내역, 2:월예산, 3:중분류"></w2:column>
						<w2:column dataType="text" id="fnlPayAmt" name="name16"></w2:column>
						<w2:column id="wkrNo" name="근로자번호" dataType="text"></w2:column>
						<w2:column id="erndSeq" name="근로_순번" dataType="text"></w2:column>
						<w2:column id="payYm" name="지급_연월" dataType="text"></w2:column>
						<w2:column id="dstbSeq" name="근로_순번" dataType="text"></w2:column>
						<w2:column id="chkDel" name="삭제" dataType="text"></w2:column>
						<w2:column id="injtYm" name="name22" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" id="dsTcmConstPcostDnList" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="chk" ignoreStatus="true" name="선택"></w2:column>
						<w2:column dataType="text" id="siteCd" name="현장코드"></w2:column>
						<w2:column dataType="text" id="upperBgtItemiCd" name="상위내역코드"></w2:column>
						<w2:column dataType="text" id="upperBgtItemiNm" name="상위공종명"></w2:column>
						<w2:column dataType="text" id="bgtItemiCd" name="내역코드"></w2:column>
						<w2:column dataType="text" id="bgtItemiNm" name="내역명"></w2:column>
						<w2:column dataType="text" id="bgtItemiStdr" name="규격"></w2:column>
						<w2:column dataType="text" id="bgtItemiUnit" name="단위"></w2:column>
						<w2:column dataType="text" id="itexpGb" name="비목구분"></w2:column>
						<w2:column dataType="text" id="bgtStd" name="예산구분"></w2:column>
						<w2:column dataType="text" id="plActbgtAmt" name="손익실행예산"></w2:column>
						<w2:column dataType="text" id="pcostAmt" name="원가(실적)"></w2:column>
						<w2:column dataType="text" id="exctAproYn" name="직영집행승인여부"></w2:column>
						
						
						<w2:column dataType="text" id="itexpGbNm" name="비목">
                                                            </w2:column>
						<w2:column dataType="text" id="actbgtAmt" name="실행예산"></w2:column>
						<w2:column id="bamt" name="잔액" dataType="text"></w2:column>
						<w2:column id="itemiYn" name="내역_여부" dataType="text"></w2:column>
						<w2:column id="contAmt" name="도급_금액" dataType="text"></w2:column>
						<w2:column id="sortOdr" name="정렬_순서" dataType="text"></w2:column>
						<w2:column id="rmkCn" name="비고_내용" dataType="text"></w2:column>
						<w2:column id="stndItemiCd" name="표준내역코드" dataType="text"></w2:column>
						
					</w2:columnInfo>
					<w2:data use="false"></w2:data>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
		</xf:model>

		<script src="/resources/js/common/cmn_CM.js" type="javascript" lazy="false"  /><script type="javascript" lazy="false"><![CDATA[
/***************************************************************************
 * Program ID : CM40100000U.xml
 * Program Name : 노무비정산
 * Author : tpyhyoj (tpyhyoj)
 * Date : 2019.08.28
 *
 * History
 * ========================================
 * 변경일자     수정자   내 용
 * ========================================
 *
 **************************************************************************/
 
 
    /************************************************************************************
     *  [1] onpageload
     ************************************************************************************/
    scwin.onpageload = function() {

		//화면초기화
        scwin.fnInitial();

    };

    /** 화면초기화 **/
    scwin.fnInitial = function() {

		var sFrameId = "";
		if ( gcm.tab_main == undefined  ) {		//팝업인경우 
			var winPopParam = JSON.parse(sessionStorage.winpopParam);
			var parentId    = winPopParam.dataObj.data.pframeId;
			
			if(parentId != undefined && parentId != "") {
           		var parentObj = opener.frames[parentId].getWindow().com;
           		
		        //원천세 여부
           		//cmn_CM.js 에 있는 함수 호출 
           		if (typeof(parentObj["getLaborGbn"]) == "function"){
           			sLaborGbn = parentObj["getLaborGbn"](parentId,"MNU_LV_307050");
           		}else{
           			sLaborGbn   = cmCom.getLaborGbn(parentId, "MNU_LV_307050");
           		}
           		
           		if (typeof(parentObj["getSiteDeptNm"]) == "function"){
           			sSiteDeptNm = parentObj["getSiteDeptNm"](sLaborGbn);
           		}else{
           			sSiteDeptNm = cmCom.getSiteDeptNm(sLaborGbn);
           		}
           		
           		if (typeof(parentObj["getLaborGbn"]) == "function"){
           			objSiteDept = parentObj["setSiteOrDept"](sLaborGbn, wfmKeySiteInfo, wfmKeyDeptInfo, spnSiteDept);
           		}else{
           			objSiteDept = cmCom.setSiteOrDept(sLaborGbn, wfmKeySiteInfo, wfmKeyDeptInfo, spnSiteDept);
           		}
			}
		} else {								//팝업이 아닌경우
			sFrameId = com.getFrameId() ;
			
	        //원천세 여부
			sLaborGbn   = cmCom.getLaborGbn(sFrameId, "MNU_LV_307050");
	        sSiteDeptNm = cmCom.getSiteDeptNm(sLaborGbn);
	        objSiteDept = cmCom.setSiteOrDept(sLaborGbn, wfmKeySiteInfo, wfmKeyDeptInfo, spnSiteDept);
		}
		
		
        com.selCdList( "keyAdpGbCd", "CM005001", "Y", "Y");  									//근로구분코드

        dsSrchMap.set("laborGbn", sLaborGbn);   												//원천세 구분

        //초기값 설정
        com.setUdcValue("udcLbatnYymm", "calYearMonth", $p.getCurrentServerDate( "yyyyMM" ));  	//출연년월
        dsSrchMap.set("keyLbatnYymm",     com.getUdcValue("udcLbatnYymm", "calYearMonth"));   	//출연년월

        scwin.fnTopBtnDisabled(true);
        scwin.fnBtnDisabled(-1);    															//하단 공종배분 버튼 제어
        
        if( dsSrchMap.get("laborGbn") == "TX" ){    											//원천세 X
        	grdTcmInsurAdjEtcDdctList.setColumnVisible( "pcostYn"    , false );          	 	//공종 여부
        	
        	grdTcmInsurAdjEtcDdctList.setColumnVisible( "prgsStusNm"    , false );          	//전표 상태명
        }
        
        com.selCdListVrbl("grdTcmConstPcostDnList:itexpGb", {"upperCd": "CM004100","setCd": "charValN1"});
        
        //UI팀용 함수 호출
        scwin.commonUI();
    };

    /************************************************************************************
     *  [2] 전역변수
     ************************************************************************************/
    var svcId = "";
    var sLaborGbn = "";
    var sSiteDeptNm = "현장";
    var objSiteDept = null;
    /************************************************************************************
     *  [3] Event 함수
     ************************************************************************************/

    // 검색 버튼
    scwin.btnFind_onclick = function() {
        scwin.fnSearchList();
    };

    //세금계산 버튼
    scwin.btnTaxCacl_onclick = function() {
        scwin.fnTaxCacl();
    };

    //세금계산취소 버튼
    scwin.btnTaxCaclCncl_onclick = function() {
        scwin.fnTaxCaclCncl();
    };

    //엑셀다운 버튼
    scwin.btnExcelDwn_onclick = function() {
        if(dsTcmInsurAdjEtcDdctList.getTotalRow() <= 0){
            com.showMessage("CMW0042");     //다운로드할 내역이 존재하지 않습니다.
            return;
        }else{
            var excelOpt = {};  //excel download 옵션
            excelOpt.fileName = "노무비정산.xlsx";    //또는 xlsx 확장자 사용
            grdTcmInsurAdjEtcDdctList.advancedExcelDownload( excelOpt );
        }
    };

    //그리드 행 선택시
    scwin.grdTcmInsurAdjEtcDdctList_onrowindexchange = function(row,oldRow) {

        var sSiteCd  = dsTcmInsurAdjEtcDdctList.getCellData( row , "siteCd" );      //현장코드
        var sWkrNo   = dsTcmInsurAdjEtcDdctList.getCellData( row , "wkrNo" );       //근로자번호
        var sErndSeq = dsTcmInsurAdjEtcDdctList.getCellData( row , "erndSeq" );     //근로_순번

        dsSelMap.set("siteCd"  , sSiteCd);  										//현장코드
        dsSelMap.set("row"     , row);  											//행 번호
        
        if(  dsSrchMap.get( "closeYn" ) == "Y"  ) {
	        scwin.fnBtnDisabled(-1);       											//버튼 제어
        }else{
	        scwin.fnBtnDisabled(row);       										//버튼 제어
        }

        var sAdjStus = dsTcmInsurAdjEtcDdctList.getCellData( row , "adjStus" );   	//상태
        var sCalcTaxYn =  dsTcmInsurAdjEtcDdctList.getCellData( row , "calcTaxYn" );   //상태 (칼럼 변경 정지윤)
        var sPcostYn =  dsTcmInsurAdjEtcDdctList.getCellData( row , "pcostYn" );	// 공종배분여부
      //  var sWorkYm = dsTcmInsurAdjEtcDdctList.getCellData( row , "workYm" ); 		// 출역년월
        //미정산인 경우 공종배분 조회 로직을 탈필요 없음.
        if( sCalcTaxYn == "N" ){   //미정산  (2020.06.10 정지윤)
            dsTcmConstPcostList.setJSON( [] );
            scwin.fnTopBtnDisabled(false);
        }else{
        
        	scwin.fnTopBtnDisabled(true);
        	btnPrint.setDisabled( false );			//급여명세서출력
            btnEmail.setDisabled( false );			//급여명세서 메일 전송
                        
        
            var sWorkYm = dsTcmInsurAdjEtcDdctList.getCellData( row , "workYm" );   //지급_일자
            if(sPcostYn == "N" && sWorkYm == com.getUdcValue("udcLbatnYymm", "calYearMonth")) //공종배분X, 출역년월과 급여계산월 같은 지 여부
            	scwin.fnTopBtnDisabled(false);     
                        
            dsSelMap.set("pcostRsvGbVal" , sWkrNo+'_'+ sErndSeq+'_'+ sWorkYm);  	//행 번호 (근로자번호  + 근로순번 + 지급 연월)
            dsSelMap.set("yyyyMm"        , sWorkYm);  								//년월
            
            var sInjtYm = dsTcmInsurAdjEtcDdctList.getCellData( row , "injtYm" );   //지급_일자
            dsSelMap.set("injtYm"        , sInjtYm);  								//투입년월
            dsSelMap.set("wkrNo"         , sWkrNo);  								//근로자번호
            dsSelMap.set("erndSeq"       , sErndSeq);  								//근로_순번
            dsSelMap.set("laborGbn"      , dsSrchMap.get("laborGbn"));  			//원천세 여부
            
            if( dsSrchMap.get("laborGbn") != "TX" ){
	            scwin.fnConstPcostList();          			//공종 조회
            }
        }
    };

	//퇴직소득 정산처리 그리드 값 수정시 이벤트	
	scwin.grdTcmInsurAdjEtcDdctList_onafteredit = function(row,col,value) {
		var sColumnId =  grdTcmInsurAdjEtcDdctList.getColumnID( col );    //수정 컬럼 ID
	  
		if( sColumnId == "yyvctExpyAmt" || sColumnId == "especExpyAmt" ) {													//특별수당 연차수당
			var nYyvctExpyAmt = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( row , "yyvctExpyAmt" ),0);				//특별수당
			var nEspecExpyAmt = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( row , "especExpyAmt" ),0);				//연차수당
			dsTcmInsurAdjEtcDdctList.setCellData( row , "payAmt", nYyvctExpyAmt +  nEspecExpyAmt );							//총급여
		}
		
		if( sColumnId == "yeAdjIctxAmt" || sColumnId == "yeAdjRstxAmt" ) {													//연말정산 소득세, 연말정산 주민세
			var nYeAdjIctxAmt = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( row , "yeAdjIctxAmt" ),0);				//연말정산 소득세
			var nYeAdjRstxAmt = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( row , "yeAdjRstxAmt" ),0);				//연말정산 주민세
			dsTcmInsurAdjEtcDdctList.setCellData( row , "taxAmt", nYeAdjIctxAmt +  nYeAdjRstxAmt );							//세액계
		}
		
		if( sColumnId == "natnpPnsnAdjAmt" || sColumnId == "hlthInsurAdjAmt" || sColumnId == "etcDdctAmt" ) {				//국민연금, 건강보험, 기타공제
			var nNatnpPnsnAdjAmt = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( row , "natnpPnsnAdjAmt" ),0);		//국민연금
			var nHlthInsurAdjAmt = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( row , "hlthInsurAdjAmt" ),0);		//건강보험
			var nEtcDdctAmt      = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( row , "etcDdctAmt" ),0);			//기타공제
			dsTcmInsurAdjEtcDdctList.setCellData( row , "deductAmt", nNatnpPnsnAdjAmt +  nHlthInsurAdjAmt + nEtcDdctAmt );	//공제계
		}
	};
	
    // 그리드 저장
    scwin.btnSave_onclick = function() {
        scwin.fnUpdate();
    };

    // 그리드 저장
    scwin.btnCostSave_onclick = function() {
        scwin.fnCostUpdate();
    };

    // 그리드 행 추가
    scwin.btnAddRow_onclick = function() {
        var rowIndex = dsTcmConstPcostList.insertRow();

        dsSelMap.set("subRow"     , rowIndex);  //공종 배분 행 번호

        grdTcmConstPcostList.setCellReadOnly( rowIndex , "chkDel"  			 , false ); //삭제
        grdTcmConstPcostList.setCellReadOnly( rowIndex , "rcpsRcgtPcostAmt"  , false ); //집행원가
        grdTcmConstPcostList.setCellReadOnly( rowIndex , "jobtyp"            , false ); //공종선택
    };

    //그리드 삭제
    scwin.btnDelRow_onclick = function() {
		var chkArr = grdTcmConstPcostList.getCheckedIndex( "chkDel" );	//삭제
	 	dsTcmConstPcostList.removeRows( chkArr );
    };

   	// 급여명세서 출력
	scwin.btnPrint_onclick = function() {
    	var nRow		= dsSelMap.get( "row" );

    	if( nRow.length == 0 ){
           com.showMessage("CMW0034");     //선택된 항목이 존재하지 않습니다.
           return ;
        }
        
        var sCalcTaxYn =  dsTcmInsurAdjEtcDdctList.getCellData( nRow , "calcTaxYn" );
		if( sCalcTaxYn == 'N'){
        	com.showMessage("CMW0108", "", "", "", grdTcmInsurAdjEtcDdctList.id, i, "chkSelect");
        	//완료된 세금계산 항목만 선택해주세요.
        	return ;
        }

    	var sSiteCd		= dsTcmInsurAdjEtcDdctList.getCellData( nRow , "siteCd" );
    	var sWkrNo		= dsTcmInsurAdjEtcDdctList.getCellData( nRow , "wkrNo" );
    	var sErndSeq	= dsTcmInsurAdjEtcDdctList.getCellData( nRow , "erndSeq" );
    	var sPayYm		= dsTcmInsurAdjEtcDdctList.getCellData( nRow , "workYm" );
    	
    	var param = { SITE_CD  : sSiteCd
                    , WKR_NO   : sWkrNo
                    , ERND_SEQ : sErndSeq
                    , PAY_YM : sPayYm
                    };
        
        com.ubiReportPopup("CM40100005R.jrf", param, "CM", "");
        
	};

	scwin.btnEmail_onclick = function() {
    	var nRow		= dsSelMap.get( "row" );

        var rowCount = dsTcmInsurAdjEtcDdctList.getRowCount();

        var bflag = false;
        for( var i = 0 ; i < rowCount; i++){
            var sChkSelect =  dsTcmInsurAdjEtcDdctList.getCellData( i , "chkSelect" );
            var sCalcTaxYn =  dsTcmInsurAdjEtcDdctList.getCellData( i , "calcTaxYn" );
            var sEmail 	   =  dsTcmInsurAdjEtcDdctList.getCellData( i , "email" );
            var rowstatus  = dsTcmInsurAdjEtcDdctList.getRowStatus( i );

            if ( sChkSelect == 'Y'){
            	if( sCalcTaxYn == 'N'){
            	  	com.showMessage("CMW0108", "", "", "", grdTcmInsurAdjEtcDdctList.id, i, "chkSelect");//완료된 급여계산 항목만 선택해주세요.
                   	return ;
            	}
            	
            	if( com.isEmpty(sEmail) ){
            	  	com.showMessage("CMW0149", "", "", "", grdTcmInsurAdjEtcDdctList.id, i, "chkSelect");//메일주소가 존재하지 않습니다
                   	return ;
            	}


                bflag = true;
            }
        }

        if( !bflag ){
            com.showMessage("CMW0034");     //선택된 항목이 존재하지 않습니다.
            return ;
        }

        svcId = "saveTcmInsurAdjEtcDdctEmail";

        if (confirm("급여명세서 메일전송하시겠습니까?")) {

            ajaxLib.ajax("/cm/cm4010/CM40100000U/saveTcmInsurAdjEtcDdctEmail", {
                mode : "asynchronous",
                method : "POST",
                requestData : {
                                param : dsSrchMap.getJSON()
                             , tcmInsurAdjEtcDdctList : dsTcmInsurAdjEtcDdctList.getModifiedJSON()
                              },
                callback : "fnCallback",
                errCallback : "fnErrCallBack"
            });
        }
        
  	};      
  	
    //공종 그리드 이벤트
    scwin.grdTcmConstPcostList_oncellclick = function(row,col) {
        dsSelMap.set("subRow"     , row);  //공종 배분 행 번호

        var sColumnId =  grdTcmConstPcostList.getColumnID( col );    //수정 컬럼 ID
        if( sColumnId == "jobtyp" ){
            var popOps = {
                          popup_name:"공종검색"
                        , url:"/ux/cm/cm4010/CM40100505P.xml"
                        , data:{paramKeySiteCd  : dsSelMap.get("siteCd")   	//현장코드
                              , paramKeyItexpGb : 'L'                   	//비목구분 자재[M], 노무[L], 경비[O]
                              , paramKeyPageGb  : 'CM40100000U'          	//페이지 구분 CM40150000U : 퇴직정정산 처리
                              , paramKeyChkCnt  : '2'                    	//체크 항목  1 : 단건 , 1이 아닌경우 다건
                              , paramKeyYyyyMm  : dsSelMap.get("yyyyMm")
                               }
                        , callbackFn : "scwin.fnPopupCallback"
                        , widType:"XL"
                        , height:"700"
                     };

            svcIdPop = "constPcostPopup";

            com.popup_open(popOps);
        }
    };

    //집행원가 입력시
    scwin.grdTcmConstPcostList_onafteredit = function(row,col,value) {
        dsSelMap.set("subRow"     , row);  //공종 배분 행 번호
         var sColumnId =  grdTcmConstPcostList.getColumnID( col );    //수정 컬럼 ID
         if( sColumnId == "rcpsRcgtPcostAmt" ){
             scwin.fnCheckTcmConstPcostItem();
         }
    };

    /**************************************************************************
     * 함 수 명: scwin.btnInject_onclick
     * 기 능: 공종투입버튼 클릭
     **************************************************************************/
    scwin.btnInject_onclick = function() {
    	var chkIdxArr = grdTcmConstPcostDnList.getCheckedIndex( "chk" );
		if (chkIdxArr == "") {
            com.showMessage("CFA0018", "대상공종에서 투입할 내역"); //$를 선택해 주십시오.
			return false;
		}
		
		for (var i = 0; i < chkIdxArr.length; i++) {
			if (dsTcmConstPcostDnList.getCellData(chkIdxArr[i] , "bgtStd" ) == "1" || dsTcmConstPcostDnList.getCellData(chkIdxArr[i] , "bgtStd" ) == "4") {
				if (dsTcmConstPcostDnList.getCellData(chkIdxArr[i], "itexpGb" ) == "L" || dsTcmConstPcostDnList.getCellData(chkIdxArr[i], "itexpGb" ) == "O") {
					if (dsTcmConstPcostDnList.getCellData( chkIdxArr[i] , "exctAproYn" ) != "Y") {
						com.showMessage("CFW0010",dsTcmConstPcostDnList.getCellData( chkIdxArr[i] , "bgtItemiCd" )+" "+dsTcmConstPcostDnList.getCellData( chkIdxArr[i] , "bgtItemiNm" )+" 은 직영집행 미승인 아이템입니다."+"\r\n작업을 취소합니다.");//$1
						return;
					}
				}
			}
		}
		
		if (confirm("공종투입 하시겠습니까?")) {
	        //단건일 경우
	        var nRow = dsSelMap.get("row");
	        var nSubRow = dsSelMap.get("subRow");
	                 
	        var cnt = 0;
			var rowIndex = nSubRow;
			var injectJSON = grdTcmConstPcostDnList.getCheckedJSON( "chk" );
	        $.each(injectJSON, function(key, value){
	        
				rowIndex = dsTcmConstPcostList.insertRow();
				
				dsTcmConstPcostList.setCellData( rowIndex , 'siteCd' , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'siteCd' ) );   	//현장코드
	            dsTcmConstPcostList.setCellData( rowIndex , 'workYm' , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'workYm' ) );   	//작업_연월
	
	            dsTcmConstPcostList.setCellData( rowIndex , 'bgtItemiCd'       , value.bgtItemiCd);        								//내역코드
	            dsTcmConstPcostList.setCellData( rowIndex , 'bgtItemiNm'       , value.bgtItemiNm);        								//내역명
	
	            dsTcmConstPcostList.setCellData( rowIndex , 'bgtItemiStdr'     , value.bgtItemiStdr);      								//규격
	
	            dsTcmConstPcostList.setCellData( rowIndex , 'plActbgtAmt'      , value.plActbgtAmt);       								//손익실행예산
	            dsTcmConstPcostList.setCellData( rowIndex , 'pcostAmt'         , value.pcostAmt);          								//누계집행원가
	
	            dsTcmConstPcostList.setCellData( rowIndex , 'upperBgtItemiCd'  , value.upperBgtItemiCd);   								//상위_예산내역코드
	            dsTcmConstPcostList.setCellData( rowIndex , 'bgtStd'           , value.bgtStd);            								//1:내역, 2:월예산, 3:중분류
	
	            dsTcmConstPcostList.setCellData( rowIndex , 'wkrNo'   , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'wkrNo' ) );   	//근로자번호
	            dsTcmConstPcostList.setCellData( rowIndex , 'erndSeq' , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'erndSeq' ) );   	//근로_순번
	              
				grdTcmConstPcostList.setFocusedCell( rowIndex , "bgtItemiNm" , false );
	           	
	            dsTcmConstPcostList.setCellData( rowIndex , 'injtYm'           , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'injtYm' ) );            //투입연월
	            var nPayAmt    = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'payAmt' ),0);   		//총급여
	            if(cnt == 0){
	            	dsTcmConstPcostList.setCellData( rowIndex , 'rcpsRcgtPcostAmt' , nPayAmt);                		//누계집행원가
	            }
	            dsTcmConstPcostList.setCellData( rowIndex , 'pcostRsvGbVal'    , dsSelMap.get("pcostRsvGbVal"));    //원가_예비_구분_값(근로자번호  + 근로순번 + 지급 연월)    
				cnt++;
			});
			
			grdTcmConstPcostDnList.checkAll( "chk" , false );//대상공종 check 전체 해제
	                 
		}
    };
    
   /**************************************************************************
     * 함 수 명: scwin.WFrameSiteInfo_change_callback
     * 기 능: 현장코드 변경 이벤트
     **************************************************************************/    
	scwin.WFrameSiteInfo_change_callback = function() {
        dsTcmInsurAdjEtcDdctList.removeAll();
        dsTcmConstPcostList.removeAll();
        dsTcmConstPcostDnList.removeAll();
	};  
	
    /**************************************************************************
     *  [4] Callback
     **************************************************************************/

    // 결과 후처리
    scwin.fnCallback = function(result, e) {

        switch (svcId) {
            case "selectTcmInsurAdjEtcDdctList" :       //노무비 정산 조회

                dsTcmInsurAdjEtcDdctList.setJSON(result.data.tcmInsurAdjEtcDdctList);               	//그리드 검색 결과
                dsTcmConstPcostList.setJSON([]);      													//공종 배분 그리드 초기화
                dsSrchMap.set( "closeYn"  , result.data.checkEditYn.closeYn );							//마감 여부
                if( dsSrchMap.get("laborGbn") == "TX") {
                	dsSrchMap.set( "slipYn"   , "N" );													//전표 여부
                }else{
                	dsSrchMap.set( "slipYn"   , result.data.checkEditYn.slipYn );						//전표 여부
                }

				var aprvYn = result.data.aprvYn ;
                var nRowTotCnt = dsTcmInsurAdjEtcDdctList.getRowCount();                            	//노무지 총 그리드 갯수
				dsSrchMap.set( "aprvYn"   , aprvYn );		

				if( dsSrchMap.get( "closeYn" )== "Y" ) { 
					tbxCloseDisp.setValue( "해당월의 노무비가 마감되었습니다." );
				} else if( dsSrchMap.get( "slipYn" ) == "Y" && dsSrchMap.get("laborGbn") == "TX" ) { 
					tbxCloseDisp.setValue( "해당월의 전표중이거나 마감되었습니다." );
				} else if( dsSrchMap.get( "aprvYn" ) == "Y" ) { 
					tbxCloseDisp.setValue( "해당월의 결제중이거나 마감되었습니다." );
				}
					
                if(  dsSrchMap.get( "closeYn" ) == "Y" || nRowTotCnt == 0  || aprvYn == "Y") {
					scwin.fnTopBtnDisabled(true);				//상단 노무비정산 버튼 제어
                	scwin.fnBtnDisabled(-1);     				//하단 공종배분 버튼 제어

                	if(nRowTotCnt != 0  ) {
                		btnPrint.setDisabled( false );			//급여명세서출력
                		btnEmail.setDisabled( false );			//급여명세서 메일 전송
                	}

                	for( var nRow = 0 ; nRow < nRowTotCnt ; nRow++){
                		var sEditYn = dsTcmInsurAdjEtcDdctList.getCellData( nRow , "editYn" );  
                		
	                	grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "natnpPnsnAdjAmt"  , true );  		//국민연금
	                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "hlthInsurAdjAmt"  , true );  		//건강보험
	                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "etcDdctAmt"       , true );  		//기타공제
	                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjIctxAmt"     , true );  		//연말정산 소득세
	                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjRstxAmt"     , true );  		//연말정산 주민세
	                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yyvctExpyAmt"     , true );	 	//특별수당
        				grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "especExpyAmt"     , true ); 		//연차수당
        				
        				if( sEditYn == "Y" ){
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "natnpPnsnAdjAmt" , false );  	//국민연금
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "hlthInsurAdjAmt" , false );  	//건강보험
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "etcDdctAmt"      , false );  	//기타공제
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjIctxAmt"    , false );  	//연말정산 소득세
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjRstxAmt"    , false );  	//연말정산 주민세
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yyvctExpyAmt"    , false );	//특별수당
        				grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "especExpyAmt"    , false ); 	//연차수당
                   		}
                    }

                	return ;
                } else {
                	scwin.fnTopBtnDisabled(false);
                }
                

                for( var nRow = 0 ; nRow < nRowTotCnt ; nRow++){ 
                    var sEditYn = dsTcmInsurAdjEtcDdctList.getCellData( nRow , "editYn" );          	//수정 여부

                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "natnpPnsnAdjAmt"  , true );  		//국민연금
                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "hlthInsurAdjAmt"  , true );  		//건강보험
                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "etcDdctAmt"       , true );  		//기타공제
                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjIctxAmt"     , true );  		//연말정산 소득세
                    grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjRstxAmt"     , true );  		//연말정산 주민세
					grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yyvctExpyAmt"     , true );	 	//특별수당
        			grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "especExpyAmt"     , true ); 		//연차수당
        			
                    if( sEditYn == "Y" ){
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "natnpPnsnAdjAmt" , false );  	//국민연금
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "hlthInsurAdjAmt" , false );  	//건강보험
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "etcDdctAmt"      , false );  	//기타공제
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjIctxAmt"    , false );  	//연말정산 소득세
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yeAdjRstxAmt"    , false );  	//연말정산 주민세
                        grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "yyvctExpyAmt"    , false );	//특별수당
        				grdTcmInsurAdjEtcDdctList.setCellReadOnly( nRow, "especExpyAmt"    , false ); 	//연차수당
                    }
                }

                if( nRowTotCnt > 0 ){            	//행이 존재할경우
                	grdTcmInsurAdjEtcDdctList.setFocusedCell( 0 , "wkrNm" ,false);
	                scwin.fnBtnDisabled(0);     	//하단 공종배분 버튼 제어
                } else {
	                scwin.fnBtnDisabled(-1);     	//하단 공종배분 버튼 제어
                }

                break;
            case "saveTcmInsurAdjEtcDdct" :             //노무비정산 저장
                com.showMessage("CFA0012");      		//저장되었습니다.
                scwin.fnSearchList();
                break;
            case "saveTcmInsurAdjEtcDdctTaxCacl" :      //세금계산
                com.showMessage("CMW0046");      		//급여계산되었습니다.
                scwin.fnSearchList();
                break;
            case "saveTcmInsurAdjEtcDdctTaxCaclCncl" :  //세금계산 취소
                com.showMessage("CMW0047");      		//급여계산 취소되었습니다.
                scwin.fnSearchList();                   //상단 노무비 정산 조회
                dsTcmConstPcostList.setJSON( [] );      //하단 공종배분 그리드 내용 제거
                break;
            case "saveTcmConstPcost" :                  //공종 등록
                com.showMessage("CFA0012");      		//저장되었습니다.
                scwin.fnConstPcostList();
                var nRow = dsSelMap.get("row");
                dsTcmInsurAdjEtcDdctList.setCellData( nRow , 'pcostYn' , "Y");
                break;
            case "selectTcmConstPcostList" :            //공종 그리드 조회
                dsTcmConstPcostList.setJSON(result.data.tcmConstPcostList);      	//그리드 검색 결과
                dsTcmConstPcostDnList.setJSON(result.data.tcmConstPcostDnList);     //그리드 검색 결과
                com.setUdcValue("cntDn1","udcListCount",result.data.tcmConstPcostDnList.length);
                
                if(  dsSrchMap.get( "closeYn" ) == "Y"  ) {
                 	for( var nRow = 0 ; nRow < dsTcmConstPcostList.getRowCount() ; nRow++){
                    	grdTcmConstPcostList.setCellReadOnly( nRow, "chkDel" 		   , true );  		//삭제
                    	grdTcmConstPcostList.setCellReadOnly( nRow, "rcpsRcgtPcostAmt" , true );  		//집행원가
                    	grdTcmConstPcostList.setCellDisabled( nRow, 'jobtyp'           , true );		//공종선택
                    }
                }
                
                for(var i=0; i<dsTcmConstPcostDnList.getTotalRow(); i++){
                	var _obj = dsTcmConstPcostDnList.getRowJSON( i );
                	/*
                	 * bgtStd
                	 * 표준내역이 없는 경우 : 1(내역)
                	 * 표준내역이 있고 + 통제성 : 2(월예산)
                	 * 표준내역이 있고 + 비통제성 : 3(중분류)
                	 * 표준내역이 있고 + 통제유형값(X) : 4(내역)
                	 */
                	if(_obj.bgtStd == "1" || _obj.bgtStd == "4") {
                		if(_obj.itexpGb == "O" || _obj.itexpGb == "L"){//O:경비, L:노무, S:외주, M:장비
                			if(_obj.exctAproYn != "Y"){//직영집행승인여부
                				grdTcmConstPcostDnList.setCellDisabled( i , "chk" , true );//체크박스 비활성화
                			}
                		}
                	}
                	
                	if(  dsSrchMap.get( "closeYn" ) == "Y"  ) {
                		grdTcmConstPcostDnList.setCellDisabled( i , "chk" , true );//체크박스 비활성화
                	}
                }
                
                break;
            case "selectCheckTcmConstPcostItem" :   	//공종 체크

                var nMstRow           = cmCom.parseInt(dsSelMap.get("row"));												//노무비정산 그리드 행번호
                var nSubRow           = cmCom.parseInt(dsSelMap.get("subRow"));												//공종배분 그리드 행 번호
                var nContAmt          = cmCom.parseInt(result.data.checkTcmConstPcostItem.contAmt,0);						//집행원가
                var sRcpsRcgtPcostAmt = cmCom.parseInt(dsTcmConstPcostList.getCellData( nSubRow , "rcpsRcgtPcostAmt" ),0);  //집행원가
                var nFnlPayAmt        = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( nMstRow , 'fnlPayAmt' ),0);    //차인지급금액

                if( nContAmt < sRcpsRcgtPcostAmt){
                	if( nContAmt == 0 ){
	                    com.showMessage("CMW0048","0");      											//$1원 이상 등록이 불가능합니다.
	                    dsTcmConstPcostList.setCellData( nSubRow , 'rcpsRcgtPcostAmt' , 0);             //누계집행원가
                	}else{
	                    com.showMessage("CMW0048",com.formatComma(nContAmt, "false"));      			//$1원 이상 등록이 불가능합니다.
	                    dsTcmConstPcostList.setCellData( nSubRow , 'rcpsRcgtPcostAmt' , nContAmt);      //누계집행원가
                	}
                    return ;
                }

                break;
                
            case "saveTcmInsurAdjEtcDdctEmail" :    			//급여명세서 메일 전송
            	 com.showMessage("CMW0148");      				//메일 전송이 완료되었습니다.
                break;
        }
    };

    // 에러 후처리
    scwin.fnErrCallBack = function(e) {
        switch (svcId) {
            case "selectTcmInsurAdjEtcDdctList" :               //노무비 정산 조회
                console.log('조회오류: ' + e);
                break;
            case "saveTcmInsurAdjEtcDdct" :                     //노무비정산 저장
                console.log('저장오류: ' + e);
                break;
            case "saveTcmInsurAdjEtcDdctTaxCacl" :              //세금계산
                console.log('세금계산 오류: ' + e);
                break;
            case "saveTcmInsurAdjEtcDdctTaxCaclCncl" :          //세금계산 취소
                console.log('세금계산취소 오류: ' + e);
                break;
            case "saveTcmConstPcost" :                          //공종 등록
                console.log('저장오류: ' + e);
                break;
            case "selectTcmConstPcostList" :                    //공종 그리드 조회
                console.log('조회오류: ' + e);
                break;
            case "selectCheckTcmConstPcostItem" :    			//공종 그리드 조회
                console.log('조회오류: ' + e);
                break;
            case "saveTcmInsurAdjEtcDdctEmail" :    			//급여명세서 메일 전송
                console.log('조회오류: ' + e);
                break;
        }
    }

    //팝업 콜백함수
    scwin.fnPopupCallback = function(arg) {

        switch (svcIdPop) {
            case "constPcostPopup" :   //공종팝업
                if(arg != ""){
                     //단건일 경우
                    var nRow = dsSelMap.get("row");
                    var nSubRow = dsSelMap.get("subRow");

		            var cnt = 0;
					var rowIndex = nSubRow;
		            $.each(arg, function(key, value){		            
		            	if(cnt == 0){
		            		rowIndex = nSubRow; 
		            	}else{
							rowIndex = dsTcmConstPcostList.insertRow();
						}
						
	   					dsTcmConstPcostList.setCellData( rowIndex , 'siteCd' , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'siteCd' ) );   //현장코드
	                    dsTcmConstPcostList.setCellData( rowIndex , 'workYm' , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'workYm' ) );   //작업_연월
	
	                    dsTcmConstPcostList.setCellData( rowIndex , 'bgtItemiCd'       , value.bgtItemiCd);        							//내역코드
	                    dsTcmConstPcostList.setCellData( rowIndex , 'bgtItemiNm'       , value.bgtItemiNm);        							//내역명
	
	                    dsTcmConstPcostList.setCellData( rowIndex , 'bgtItemiStdr'     , value.bgtItemiStdr);      							//규격
	
	                    dsTcmConstPcostList.setCellData( rowIndex , 'plActbgtAmt'      , value.plActbgtAmt);       							//손익실행예산
	                    dsTcmConstPcostList.setCellData( rowIndex , 'pcostAmt'         , value.pcostAmt);          							//누계집행원가
	
	                    dsTcmConstPcostList.setCellData( rowIndex , 'upperBgtItemiCd'  , value.upperBgtItemiCd);   							//상위_예산내역코드
	                    dsTcmConstPcostList.setCellData( rowIndex , 'bgtStd'           , value.bgtStd);            							//1:내역, 2:월예산, 3:중분류
	
	                    dsTcmConstPcostList.setCellData( rowIndex , 'wkrNo'   , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'wkrNo' ) );   //근로자번호
	                    dsTcmConstPcostList.setCellData( rowIndex , 'erndSeq' , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'erndSeq' ) ); //근로_순번
	                    
						grdTcmConstPcostList.setFocusedCell( rowIndex , "bgtItemiNm" , false );
		            	
	                    dsTcmConstPcostList.setCellData( rowIndex , 'injtYm'           , dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'injtYm' ) );            //투입연월

	                    var nPayAmt    = cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'payAmt' ),0);   		//총급여

	                	if(cnt == 0){
	                		dsTcmConstPcostList.setCellData( rowIndex , 'rcpsRcgtPcostAmt' , nPayAmt);                		//누계집행원가
	                	}
                    	dsTcmConstPcostList.setCellData( rowIndex , 'pcostRsvGbVal'    , dsSelMap.get("pcostRsvGbVal"));    //원가_예비_구분_값(근로자번호  + 근로순번 + 지급 연월)    
		 				cnt++;
		            });
                }
                break;
        }
    }

    /**************************************************************************
     *  [5] 사용자정의 함수
     **************************************************************************/

    // 조회 List
    scwin.fnSearchList = function() {

		tbxCloseDisp.setValue( "" );   //노무비정산 체크 메세지 초기화
		tbxCloseDisp2.setValue( "" );  //공종배분 체크 메세지 초기화

        //DS 매핑
        if( dsSrchMap.get("laborGbn") == "TX") {
        	dsSrchMap.set("keySiteCd"   , wfmKeyDeptInfo.getWindow().ibxKeySiteCd.getValue() );  	//부서 코드
        }else{
	        dsSrchMap.set("keySiteCd"   , wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue() );  	//현장 코드
        }
        dsSrchMap.set("keyLbatnYymm", com.getUdcValue("udcLbatnYymm", "calYearMonth"));      		//출연년월

        if( dsSrchMap.get("keySiteCd").length == 0  ){
             if( dsSrchMap.get("laborGbn") == "TX") {
	            var focusId = wfmKeyDeptInfo.getWindow().ibxKeySiteNm.id;
	            com.showMessage("CMW0025", "부서", "", "", focusId);     //$1은(는) 필수입력사항입니다.
            }else{
	            var focusId = wfmKeySiteInfo.getWindow().ibxKeySiteNm.id;
	            com.showMessage("CMW0025", "현장", "", "", focusId);     //$1은(는) 필수입력사항입니다.
            }
            return ;
        }

        if( dsSrchMap.get("keyLbatnYymm").length == 0  ){
            var focusId = com.getUdcComp("udcLbatnYymm", "calYearMonth").id;
            com.showMessage("CMW0025", "출연년월", "", "", focusId); //$1은(는) 필수입력사항입니다.

            return ;
        }

        svcId = "selectTcmInsurAdjEtcDdctList";

        ajaxLib.ajax("/cm/cm4010/CM40100000U/selectTcmInsurAdjEtcDdctList", {
            mode : "asynchronous",
            method : "POST",
            requestData : dsSrchMap.getJSON(),
            callback : "fnCallback",
            errCallback : "fnErrCallBack"
        });

    };

    // 저장
    scwin.fnUpdate = function() {

        if( dsTcmInsurAdjEtcDdctList.getModifiedJSON().length == 0 ){
            com.showMessage("CMW0024"); //저장(변경)할 내용이 없습니다.
            return ;
        }

        svcId = "saveTcmInsurAdjEtcDdct";

        if (confirm("저장 하시겠습니까?")) {

            ajaxLib.ajax("/cm/cm4010/CM40100000U/saveTcmInsurAdjEtcDdct", {
                mode : "asynchronous",
                method : "POST",
                requestData : {
                                param : dsSrchMap.getJSON()
                              , tcmInsurAdjEtcDdctList : dsTcmInsurAdjEtcDdctList.getModifiedJSON()
                              },
                callback : "fnCallback",
                errCallback : "fnErrCallBack"
            });
        }
    };

    // 세금계산
    scwin.fnTaxCacl = function() {

        var rowCount = dsTcmInsurAdjEtcDdctList.getRowCount();

        var bflag = false;
        for( var i = 0 ; i < rowCount; i++){
            var sChkSelect =  dsTcmInsurAdjEtcDdctList.getCellData( i , "chkSelect" );
            var sCalcTaxYn =  dsTcmInsurAdjEtcDdctList.getCellData( i , "calcTaxYn" );
            var rowstatus   = dsTcmInsurAdjEtcDdctList.getRowStatus( i );

            if ( sChkSelect == 'Y'){
            	if( sCalcTaxYn == 'Y'){
            	  	com.showMessage("CMW0107", "", "", "", grdTcmInsurAdjEtcDdctList.id, i, "chkSelect");//미 완료된 급여계산 항목만 선택해주세요.
                   	return ;
            	}

                bflag = true;
            }
        }

        if( !bflag ){
            com.showMessage("CMW0034");     //선택된 항목이 존재하지 않습니다.
            return ;
        }

        svcId = "saveTcmInsurAdjEtcDdctTaxCacl";

        dsSrchMap.set( "erndGbCd" , "CM00500102" );  //CM00500101  일용 /  CM00500102  상용

        if (confirm("급여계산 하시겠습니까?")) {

            ajaxLib.ajax("/cm/cm4010/CM40100000U/saveTcmInsurAdjEtcDdctTaxCacl", {
                mode : "asynchronous",
                method : "POST",
                requestData : {
                                param : dsSrchMap.getJSON()
                             , tcmInsurAdjEtcDdctList : dsTcmInsurAdjEtcDdctList.getModifiedJSON()
                              },
                callback : "fnCallback",
                errCallback : "fnErrCallBack"
            });
        }
    };

    // 세금계산 취소
    scwin.fnTaxCaclCncl = function() {

        var rowCount = dsTcmInsurAdjEtcDdctList.getRowCount();

        var bflag = false;
        for( var i = 0 ; i < rowCount; i++){
            var sChkSelect =  dsTcmInsurAdjEtcDdctList.getCellData( i , "chkSelect" );
            var sCalcTaxYn =  dsTcmInsurAdjEtcDdctList.getCellData( i , "calcTaxYn" );
            var rowstatus = dsTcmInsurAdjEtcDdctList.getRowStatus( i );

            if ( sChkSelect == 'Y'){
            	if( sCalcTaxYn == 'N'){
            	  	com.showMessage("CMW0108", "", "", "", grdTcmInsurAdjEtcDdctList.id, i, "chkSelect");//완료된 급여계산 항목만 선택해주세요.
                   	return ;
            	}

                bflag = true;
            }
        }

        if( !bflag ){
            com.showMessage("CMW0034");     //선택된 항목이 존재하지 않습니다.
            return ;
        }

        dsSrchMap.set( "erndGbCd" , "CM00500102" );  //CM00500101  일용 /  CM00500102  상용

        svcId = "saveTcmInsurAdjEtcDdctTaxCaclCncl";

        if (confirm("급여계산 취소하시겠습니까?")) {

            ajaxLib.ajax("/cm/cm4010/CM40100000U/saveTcmInsurAdjEtcDdctTaxCaclCncl", {
                mode : "asynchronous",
                method : "POST",
                requestData : {
                                param : dsSrchMap.getJSON()
                             , tcmInsurAdjEtcDdctList : dsTcmInsurAdjEtcDdctList.getModifiedJSON()
                              },
                callback : "fnCallback",
                errCallback : "fnErrCallBack"
            });
        }
    };

    //버튼 제어
    scwin.fnBtnDisabled = function(row) {

        btnCostSave.setDisabled( true );             	//저장
        btnAddRow.setDisabled( true );               	//행추가
        btnDelRow.setDisabled( true );               	//행삭제
        btnInject.setDisabled( true );               	//공통투입

		if( row >= 0  && dsSrchMap.get("laborGbn") != "TX" ){
	        var sCalcTaxYn       = dsTcmInsurAdjEtcDdctList.getCellData( row , "calcTaxYn" );       //상태
	        if( sCalcTaxYn == 'Y'){                     //세금계산
	            btnCostSave.setDisabled( false );       //저장
	            btnAddRow.setDisabled( false );         //행추가
	            btnDelRow.setDisabled( false );         //행삭제
	            btnInject.setDisabled( false );         //공통투입
	        } else {
				tbxCloseDisp2.setValue( "정산이 미완료되었습니다." );
	        }
	        
	        var sSlipYn       = dsTcmInsurAdjEtcDdctList.getCellData( row , "slipYn" );       //전표생성 여부
	        
	        if( sSlipYn == 'N'){                      	//세금계산
	            btnCostSave.setDisabled( false );       //저장
	            btnAddRow.setDisabled( false );         //행추가
	            btnDelRow.setDisabled( false );         //행삭제
	            btnInject.setDisabled( false );         //공통투입
	        }
        }
        
        if( dsSrchMap.get("laborGbn") != "TX" ){
	       	if( dsSrchMap.get( "closeYn" ) == "Y" ) { 
				tbxCloseDisp2.setValue( "해당월의 노무비가 마감되었습니다." );
			} else if( dsSrchMap.get( "slipYn" ) == "Y" && dsSrchMap.get("laborGbn") == "TX" ) { 
				tbxCloseDisp2.setValue( "해당월의 전표중이거나 마감되었습니다." );
			} else if( dsSrchMap.get( "aprvYn" ) == "Y" ) { 
				tbxCloseDisp2.setValue( "해당월의 결제중이거나 마감되었습니다." );
			}
		}

    };

    //버튼 제어
    scwin.fnTopBtnDisabled = function(bFlag) {

    	btnTaxCacl.setDisabled( bFlag );			//세금계산
        btnTaxCaclCncl.setDisabled( bFlag );		//세금계산 취소
        btnPrint.setDisabled( bFlag );				//급여명세서출력
        btnEmail.setDisabled( bFlag );				//급여명세서 메일전송
        btnSave.setDisabled( bFlag );				//저장

    };

    // 저장
    scwin.fnCostUpdate = function() {

        svcId = "saveTcmConstPcost";

        if( dsTcmConstPcostList.getModifiedJSON().length == 0 ){
            com.showMessage("CMW0024"); //저장(변경)할 내용이 없습니다.
            return ;
        }

       for( var nRow = 0 ; nRow < dsTcmConstPcostList.getRowCount() ; nRow++){
            var sRcpsRcgtPcostAmt = dsTcmConstPcostList.getCellData( nRow , "rcpsRcgtPcostAmt" );   		//집행원가
            var sBgtItemiCd       = dsTcmConstPcostList.getCellData( nRow , "bgtItemiCd" );         		//내역코드

            if( com.isEmpty(sBgtItemiCd)  ){  //
                com.showMessage("CMW0049", "", "", "", grdTcmConstPcostList.id, nRow, "jobtyp");			//item를 선택해주세요.
                return ;
            }

            if( cmCom.parseInt(sRcpsRcgtPcostAmt, 0) == 0  ){  //
                com.showMessage("CMW0050", "", "", "", grdTcmConstPcostList.id, nRow, "rcpsRcgtPcostAmt");	//집행원가를 입력해주세요.
                return ;
            }

            for( var nSubRow = 0 ; nSubRow < dsTcmConstPcostList.getRowCount() ; nSubRow++){
                if( sBgtItemiCd == dsTcmConstPcostList.getCellData( nSubRow , "bgtItemiCd" ) && nRow != nSubRow ){
                    com.showMessage("CMW0051", "", "", "", grdTcmConstPcostList.id, nRow, "jobtyp");		//item이 중복 등록되었습니다.

                    return ;
                }
            }
        }

        var nRow = dsSelMap.get("row");

		if( cmCom.parseInt(grdTcmConstPcostList.getFooterData( 'totRcpsRcgtPcostAmt' ),0) != 0  ){
	        if( cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'payAmt' ),0)
	          < cmCom.parseInt(grdTcmConstPcostList.getFooterData( 'totRcpsRcgtPcostAmt' ),0)){
	            com.showMessage("CMW0052", "총급여", "", "", grdTcmConstPcostList.id, nRow, "payAmt");		//집행원가 합이 $1를 초과하였습니다.
	            return ;
	        }
	        
	        if(dsTcmConstPcostList.getTotalRow() != 0 && cmCom.parseInt(dsTcmInsurAdjEtcDdctList.getCellData( nRow , 'payAmt' ),0)					//총급여
	          != cmCom.parseInt(grdTcmConstPcostList.getFooterData( 'totRcpsRcgtPcostAmt' ),0)){
	   				com.showMessage("CMW0141", "총급여", "", "", grdTcmConstPcostList.id, nRow, "payAmt");	//집행원가 금액과 $1 금액이 동일하지 않습니다.
	            return ;
	        }
        }
        
        if (confirm("저장 하시겠습니까?")) {

            ajaxLib.ajax("/cm/cm4010/CM40100000U/saveTcmConstPcost", {
                mode : "asynchronous",
                method : "POST",
                requestData : { param : dsSelMap.getJSON()
                              , tcmConstPcostList : dsTcmConstPcostList.getModifiedJSON()
                              },
                callback : "fnCallback",
                errCallback : "fnErrCallBack"
            });
        }
    };

	// 공종조회
    scwin.fnConstPcostList = function() {
        svcId = "selectTcmConstPcostList";

        dsSelMap.set( "pageGb" , "CM40100000U" );
        ajaxLib.ajax("/cm/cm4010/CM40100000U/selectTcmConstPcostList", {
            mode : "asynchronous",
            method : "POST",
            requestData : dsSelMap.getJSON(),
            callback : "fnCallback",
            errCallback : "fnErrCallBack"
        });

    };

    // 공종체크
    scwin.fnCheckTcmConstPcostItem = function() {
        svcId = "selectCheckTcmConstPcostItem";

        ajaxLib.ajax("/cm/cm4010/CM40100000U/selectCheckTcmConstPcostItem", {
            mode : "asynchronous",
            method : "POST",
            requestData : dsTcmConstPcostList.getRowJSON( dsSelMap.get("subRow")),
            callback : "fnCallback",
            errCallback : "fnErrCallBack"
        });

    };
	]]></script>


		<w2:require src="/WEB-INF/ux/common/udc/udcYearMonthcalendar.xml"></w2:require>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">

		<xf:group style="" id="" class="content_body">
			<xf:group class="navigator_wrap" id="" style="">
				<w2:wframe id="wfm_title" src="/ux/common/navigator.xml" style=""></w2:wframe>	<!-- 노무비정산 -->
			</xf:group>
			<xf:group class="tbl_search" id="" style="">


				<xf:group class="tb_list" id="" style="" tagname="table">
					<w2:attributes>
						<w2:summary>조회조건 테이블 입니다.</w2:summary>
					</w2:attributes>
					<xf:group tagname="colgroup">
						<xf:group style="width:81px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
						<xf:group style="width:94px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
						<xf:group style="width:94px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group class="w2tb_th req" style="" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span class="" id="spnSiteDept" label="현장명" style=""></w2:span>
						</xf:group>
						<xf:group class="w2tb_td" style="" tagname="td">
                            <w2:wframe id="wfmKeySiteInfo" src="/WEB-INF/ux/cm/cmcomm/schSiteInfo.xml" style=""></w2:wframe>
                            <w2:wframe id="wfmKeyDeptInfo" src="/WEB-INF/ux/cm/cmcomm/schDeptInfo.xml" style="display: none;"></w2:wframe>
						</xf:group>
						<xf:group class="w2tb_th req" style="" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span class="" id="" label="출역연월" style=""></w2:span>
						</xf:group>
						<xf:group class="w2tb_td" style="" tagname="td">
							<w2:udc_yearMonthcalendar id="udcLbatnYymm" style=""></w2:udc_yearMonthcalendar>
						</xf:group>
						<xf:group class="w2tb_th" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span class="" id="" label="근로구분" style=""></w2:span>
						</xf:group>
						<xf:group class="w2tb_td" tagname="td">
							<w2:attributes></w2:attributes>
							<xf:select1 allOption="" appearance="minimal" chooseOption="true" class="" direction="auto"
								disabled="false" disabledClass="w2selectbox_disabled" displayMode="label" id="keyAdpGbCd" ref="data:dsSrchMap.keyAdpGbCd" style="width:100px;"
								submenuSize="auto" textAlign="left">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[전체]]></xf:label>
										<xf:value><![CDATA[]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[new row]]></xf:label>
										<xf:value><![CDATA[]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[new row]]></xf:label>
										<xf:value><![CDATA[]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group class="btn_tbl_search" style="" tagname="">
					<w2:anchor class="btn_sh" id="btnFind" outerDiv="false" style="" ev:onclick="scwin.btnFind_onclick">
						<xf:label><![CDATA[조회]]></xf:label>
					</w2:anchor>
				</xf:group>

			</xf:group>

			<xf:group style="" id="" class="defaultbox">
				<w2:textbox label="노무비정산" style="" id="" class="df_tt" tagname="h3"></w2:textbox>

				<xf:group class="right_wrap" id="" style="">
				
					<xf:group class="descbox" id="" style="">
						<w2:textbox class="" id="tbxCloseDisp" label="" tagname=""></w2:textbox>
					</xf:group>
					
					<xf:group style="height:27px;" id="">
						<w2:anchor class="btn_gcm" id="btnTaxCacl" outerDiv="false" style="" ev:onclick="scwin.btnTaxCacl_onclick">
							<xf:label><![CDATA[급여계산]]></xf:label>
						</w2:anchor>
						<w2:anchor class="btn_gcm" id="btnTaxCaclCncl" outerDiv="false" style="" ev:onclick="scwin.btnTaxCaclCncl_onclick">
							<xf:label><![CDATA[급여계산취소]]></xf:label>
						</w2:anchor>
						<w2:anchor outerDiv="false" style="" id="btnPrint" class="btn_gcm" ev:onclick="scwin.btnPrint_onclick">
							<xf:label><![CDATA[급여명세서출력]]></xf:label>
						</w2:anchor>
						
						<w2:anchor outerDiv="false" style="" id="btnEmail" class="btn_gcm" ev:onclick="scwin.btnEmail_onclick">
							<xf:label><![CDATA[급여명세서 메일전송]]></xf:label>
						</w2:anchor>
						
						<w2:anchor outerDiv="false" clickEventElement="" style="" id="btnSave" class="btn_gcm" ev:onclick="scwin.btnSave_onclick">
							<xf:label><![CDATA[저장]]></xf:label>
						</w2:anchor>
						<w2:anchor outerDiv="false" localeRef="" toolTip="엑셀다운로드" clickEventElement="" style=""
							id="btnExcelDwn" class="btn_gcm excel_down" ev:onclick="scwin.btnExcelDwn_onclick">
							<xf:label><![CDATA[엑셀다운로드]]></xf:label>
						</w2:anchor>
					</xf:group></xf:group>
			</xf:group>
			<w2:gridView readOnly="true" autoFit="lastColumn" class="" dataList="data:dsTcmInsurAdjEtcDdctList"
				fixedColumnWithHidden="true" focusMode="row" id="grdTcmInsurAdjEtcDdctList" rowNumHeaderValue="No" rowNumVisible=""
				rowStatusHeaderValue="" rowStatusVisible="" rowStatusWidth="30" scrollByColumn="false" style="height: 350px;"
				useShiftKey="true" visibleRowNum="" fixedColumn="7" ev:onviewchange=""
				ev:onrowindexchange="scwin.grdTcmInsurAdjEtcDdctList_onrowindexchange" ev:oncellclick="" ev:ondateselect=""
				editModeEvent="onclick" enterKeyMove="down" keyMoveEditMode="true"
				ev:onafteredit="scwin.grdTcmInsurAdjEtcDdctList_onafteredit">
				<w2:header id="header1" style="">
					<w2:row id="row2" style="">
						<w2:column blockSelect="false" displayMode="label" id="column49" inputType="checkbox"
							removeBorderStyle="false" value="선택" width="60" rowSpan="2" style="">
						</w2:column>
						<w2:column blockSelect="false" id="column21" inputType="text" value="급여계산" width="70"
							sortable="true" rowSpan="2" style="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" id="column197" value="공종여부"
							blockSelect="false" displayMode="label" rowSpan="2" style="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="120" inputType="text" style="" id="column209"
							value="전표상태" blockSelect="false" displayMode="label" rowSpan="2">
						</w2:column>
						<w2:column removeBorderStyle="false" width="80" inputType="text" id="column205" value="출역연월"
							blockSelect="false" displayMode="label" rowSpan="2" style="">
						</w2:column>
						<w2:column blockSelect="false" id="column19" inputType="text" value="근로자번호" width="80"
							rowSpan="2" style="">
						</w2:column>
						<w2:column blockSelect="false" id="column17" inputType="text" value="성명" width="100"
							rowSpan="2" style="">
						</w2:column>
						<w2:column blockSelect="false" id="column15" inputType="text" value="주민번호" width="120"
							rowSpan="2" style="">
						</w2:column>
						<w2:column blockSelect="false" displayMode="label" id="column37" inputType="text"
							removeBorderStyle="false" value="근로구분" width="120" rowSpan="2" style="">
						</w2:column>
						<w2:column blockSelect="false" displayMode="label" id="column35" inputType="text"
							removeBorderStyle="false" value="출역일수" width="80" rowSpan="2" style="">
						</w2:column>
						<w2:column blockSelect="false" displayMode="label" id="column41" inputType="text"
							removeBorderStyle="false" value="계약급여" width="100" rowSpan="2" style="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column105" value="지급내역"
							blockSelect="false" displayMode="label" colSpan="7" style="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column125" value="세액"
							blockSelect="false" displayMode="label" colSpan="7" style="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column173" value="공제내역"
							blockSelect="false" displayMode="label" colSpan="5" style="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column153"
							value="차인&lt;br&gt;지급액" blockSelect="false" displayMode="label" rowSpan="2" style="">
						</w2:column>
						<w2:column removeBorderStyle="false" width="200" inputType="text" id="column201" value="메일"
							blockSelect="false" displayMode="label" rowSpan="2" style="">
						</w2:column>
					</w2:row>
					<w2:row style="" id="row8">
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column106" value="기본급"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column102" value="연장수당"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column98" value="휴일근로수당"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column94" value="주휴수당"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column190" value="특별수당"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column186" value="연차수당"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column90" value="총급여"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column126" value="과세대상일"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column122" value="과세대상액"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column118" value="소득세"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column114" value="주민세"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column110"
							value="연말정산&lt;br&gt;소득세" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column182"
							value="연말정산&lt;br/&gt;주민세" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column178" value="세액계"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column174" value="고용보험"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column170" value="국민연금"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column166" value="건강보험"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column162" value="기타공제"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column158" value="공제계"
							blockSelect="false" displayMode="label">
						</w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody id="gBody4" style="">
					<w2:row id="row5" style="">
						<w2:column blockSelect="false" displayMode="label" id="chkSelect" inputType="checkbox"
							removeBorderStyle="false" width="60" readOnly="false" valueType="other" falseValue="N" trueValue="Y" value="N">
						</w2:column>
						<w2:column blockSelect="false" id="calcTaxYn" inputType="checkbox" width="70" readOnly="true"
							falseValue="N" trueValue="Y" defaultValue="N" valueType="other">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="select" id="pcostYn"
							blockSelect="false" displayMode="label">
							<w2:choices>
								<w2:item>
									<w2:label><![CDATA[미완료]]></w2:label>
									<w2:value><![CDATA[N]]></w2:value>
								</w2:item>
								<w2:item>
									<w2:label><![CDATA[완료]]></w2:label>
									<w2:value><![CDATA[Y]]></w2:value>
								</w2:item>
							</w2:choices>
						</w2:column>
						<w2:column removeBorderStyle="false" width="120" inputType="text" style="" id="prgsStusNm"
							value="" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="80" inputType="text" id="workYm" blockSelect="false"
							displayMode="label" displayFormat="####-##">
						</w2:column>
						<w2:column blockSelect="false" id="wkrNo" inputType="text" width="80"></w2:column>
						<w2:column blockSelect="false" id="wkrNm" inputType="text" width="100"></w2:column>
						<w2:column blockSelect="false" id="resnoEnc" inputType="text" textAlign="right" width="120"
							displayFormat="######-#######">
						</w2:column>
						<w2:column blockSelect="false" displayMode="label" id="erndLabrSalGbCd" inputType="text"
							removeBorderStyle="false" width="120">
						</w2:column>
						<w2:column blockSelect="false" displayFormat="#,###.#" displayMode="label" id="workDays"
							inputType="text" removeBorderStyle="false" value="0" width="80" dataType="number" class="fc_blue">
						</w2:column>
						<w2:column blockSelect="false" displayMode="label" id="avgDywgAmt" inputType="text"
							removeBorderStyle="false" value="0" width="100" textAlign="right" displayFormat="#,###" dataType="number">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="bsalAmt" value="0"
							blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="extnExpyAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="hldyErndExpyAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="hldyExpyAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="yyvctExpyAmt" value="0"
							blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" allowChar="0-9-" maxLength="9"
							readOnly="false" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="especExpyAmt" value="0"
							blockSelect="false" displayMode="label" dataType="number" allowChar="0-9-" displayFormat="#,###" maxLength="9"
							readOnly="false" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="payAmt" value="0"
							blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="taxnTargDys"
							blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="taxnTargAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="ictxAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="rstxAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="yeAdjIctxAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###"
							allowChar="0-9-">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="yeAdjRstxAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###"
							allowChar="0-9-">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="taxAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="eplmtInfeeAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="natnpPnsnAdjAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###"
							readOnly="false" allowChar="0-9-" maxLength="9">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="hlthInsurAdjAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###"
							readOnly="false" allowChar="0-9-" maxLength="9">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="etcDdctAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###"
							readOnly="false" allowChar="0-9-" maxLength="9">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="deductAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="fnlPayAmt" value="0"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="200" inputType="text" id="email" blockSelect="false"
							displayMode="label" textAlign="left">
						</w2:column>
					</w2:row>
				</w2:gBody>
				<w2:footer style="" id="footer2">
					<w2:row style="" id="row7">
						<w2:column removeBorderStyle="false" width="60" inputType="text" id="column72"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" id="column71" value="합계"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" id="column200"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="120" inputType="text" style="" id="column212"
							value="" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="80" inputType="text" id="column208"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="80" inputType="text" id="column70"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="text" id="column69"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="120" inputType="text" id="column68"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="120" inputType="text" id="column67"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="80" inputType="expression" id="column66"
							blockSelect="false" displayMode="label" expression="sum('workDays')" displayFormat="#,###.#" dataType="number">
						</w2:column>
						<w2:column removeBorderStyle="false" width="100" inputType="expression" id="column65"
							blockSelect="false" displayMode="label" expression="sum('avgDywgAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column108"
							blockSelect="false" displayMode="label" expression="sum('bsalAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column104"
							blockSelect="false" displayMode="label" expression="sum('extnExpyAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column100"
							blockSelect="false" displayMode="label" expression="sum('hldyErndExpyAmt')" dataType="number"
							displayFormat="#,###.#" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column96"
							blockSelect="false" displayMode="label" expression="sum('hldyExpyAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column192"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column188"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column92"
							blockSelect="false" displayMode="label" expression="sum('payAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column128"
							blockSelect="false" displayMode="label" expression="sum('taxnTargDys')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column124"
							blockSelect="false" displayMode="label" expression="sum('taxnTargAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column120"
							blockSelect="false" displayMode="label" expression="sum('ictxAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column116"
							blockSelect="false" displayMode="label" expression="sum('rstxAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column112"
							blockSelect="false" displayMode="label" expression="sum('yeAdjIctxAmt')" dataType="number"
							displayFormat="#,###.#" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column184"
							blockSelect="false" displayMode="label" expression="sum('yeAdjRstxAmt')" dataType="number"
							displayFormat="#,###.#" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column180"
							blockSelect="false" displayMode="label" expression="sum('taxAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column176"
							blockSelect="false" displayMode="label" expression="sum('eplmtInfeeAmt')" dataType="number"
							displayFormat="#,###.#" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column172"
							blockSelect="false" displayMode="label" expression="sum('natnpPnsnAmt')" dataType="number"
							displayFormat="#,###.#" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column168"
							blockSelect="false" displayMode="label" expression="sum('hlthInfeeAmt')" dataType="number"
							displayFormat="#,###.#" textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column164"
							blockSelect="false" displayMode="label" expression="sum('etcDdctAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column160"
							blockSelect="false" displayMode="label" expression="sum('deductAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="expression" id="column156"
							blockSelect="false" displayMode="label" expression="sum('fnlPayAmt')" dataType="number" displayFormat="#,###.#"
							textAlign="right">
						</w2:column>
						<w2:column removeBorderStyle="false" width="200" inputType="text" id="column204"
							blockSelect="false" displayMode="label">
						</w2:column>
					</w2:row>
				</w2:footer>
			</w2:gridView>


      <xf:group class="lybox_wrap col_4_6" id="" style="">
	            <xf:group class="lybox" id="" style="">
	            
	                 <xf:group class="lycolumn" id="" style="">
	                    <xf:group class="lyinner" id="" style="">
	                    
	                        <xf:group class="defaultbox" id="" style="">
	                            <w2:textbox class="df_tt" id="" label="대상공종" style="" tagname="h3"></w2:textbox>
	                            <w2:udc_list_count id="cntDn1"></w2:udc_list_count>
	                            <xf:group class="right_wrap" id="" style="">
	                                <xf:group id="" style="">
	                                    <w2:anchor class="btn_gcm" id="btnInject" outerDiv="false" style=""
	                                        ev:onclick="scwin.btnInject_onclick">
	                                        <xf:label><![CDATA[공종투입]]></xf:label>
	                                    </w2:anchor>
	                                </xf:group>
	                            </xf:group>
	                        </xf:group>
	                        
	                        <w2:gridView autoFit="lastColumn" class="autoHeight" dataList="data:dsTcmConstPcostDnList"
	                        	fixedColumnWithHidden="true" focusMode="row" id="grdTcmConstPcostDnList" readOnly=""
	                        	rowNumHeaderValue="No" rowNumVisible="" rowStatusHeaderValue="" rowStatusVisible=""
	                        	rowStatusWidth="30" scrollByColumn="false" style="height: 300px;" useShiftKey="true"
	                        	visibleRowNum="" checkReadOnlyOnCut="true" checkReadOnlyOnPaste="true">
	                        	<w2:header id="header1" style="">
	                        		<w2:row id="row2" style="">
	                        			<w2:column blockSelect="false" displayMode="label" id="column49"
	                        				inputType="checkbox" removeBorderStyle="false" style="" width="60"
	                        				readOnly="false" viewType="icon">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column21" inputType="text" sortable="true"
	                        				style="" value="공종" width="140">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column19" inputType="text"
	                        				style="" value="Item" width="100">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column17" inputType="text"
	                        				style="" value="규격" width="100">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="column15" inputType="text"
	                        				style="" value="단위" width="80">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="column37"
	                        				inputType="text" removeBorderStyle="false" style="" value="비목" width="80">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="column35"
	                        				inputType="text" removeBorderStyle="false" style="" value="실행예산" width="120">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="column51"
	                        				inputType="text" removeBorderStyle="false" style="" value="원가" width="120">
	                        			</w2:column>
	                        			<w2:column removeBorderStyle="false" width="70" inputType="text" style=""
	                        				id="column52" value="직영집행&lt;br/&gt;승인여부" blockSelect="false" displayMode="label">
	                        			</w2:column>
	                        		</w2:row>
	                        	</w2:header>
	                        	<w2:gBody id="gBody4" style="">
	                        		<w2:row id="row5" style="">
	                        			<w2:column blockSelect="false" displayMode="label" id="chk" inputType="checkbox"
	                        				removeBorderStyle="false" width="60" readOnly="" viewType="icon">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="upperBgtItemiNm" inputType="text"
	                        				textAlign="left" width="140" readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="bgtItemiNm" inputType="text" textAlign="left"
	                        				width="100" readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="bgtItemiStdr" inputType="text" width="100"
	                        				readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" id="bgtItemiUnit" inputType="text" width="80"
	                        				readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="itexpGb"
	                        				inputType="select" removeBorderStyle="false" width="80" readOnly="true">
	                        				<w2:choices></w2:choices>
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayFormat="#,###.#" displayMode="label"
	                        				id="plActbgtAmt" inputType="text" removeBorderStyle="false" textAlign="right" width="120"
	                        				dataType="number" readOnly="true">
	                        			</w2:column>
	                        			<w2:column blockSelect="false" displayMode="label" id="pcostAmt"
	                        				inputType="text" removeBorderStyle="false" width="120" displayFormat="#,###.#"
	                        				dataType="number" textAlign="right" readOnly="true">
	                        			</w2:column>
	                        			<w2:column removeBorderStyle="false" width="70" inputType="text" style=""
	                        				id="exctAproYn" value="" blockSelect="false" displayMode="label" textAlign="center" readOnly="true">
	                        			</w2:column>
	                        		</w2:row>
	                        	</w2:gBody>
	                        </w2:gridView>
	                    </xf:group>
	                    
	                </xf:group>

	<xf:group class="lycolumn" id="" style="">
	   	<xf:group class="lyinner" id="" style="">

			<xf:group class="defaultbox" id="" style="">
                <w2:textbox class="df_tt" id="" label="공종배분" style="" tagname="h3"></w2:textbox>
                <xf:group class="right_wrap" id="" style="">
                
                	<xf:group class="descbox" id="" style="">
						<w2:textbox class="" id="tbxCloseDisp2" label="" tagname=""></w2:textbox>
					</xf:group>
					
					
                    <xf:group class="" id="" style="">
                        <w2:anchor class="btn_gcm" clickEventElement="" id="btnCostSave" outerDiv="false" style="" ev:onclick="scwin.fnCostUpdate">
                            <xf:label><![CDATA[저장]]></xf:label>
                        </w2:anchor>
                        <w2:anchor class="btn_gcm row_add" clickEventElement="" id="btnAddRow" outerDiv="false" style=""
                            toolTip="행추가" ev:onclick="scwin.btnAddRow_onclick">
                            <xf:label><![CDATA[행추가]]></xf:label>
                        </w2:anchor>
                        <w2:anchor class="btn_gcm row_del" clickEventElement="" id="btnDelRow" outerDiv="false" style=""
                            toolTip="행삭제" ev:onclick="scwin.btnDelRow_onclick">
                            <xf:label><![CDATA[행삭제]]></xf:label>
                        </w2:anchor>
                    </xf:group>
                </xf:group>
            </xf:group>

			<w2:gridView autoFit="allColumn" class="autoHeight" dataList="data:dsTcmConstPcostList" fixedColumn=""
				fixedColumnWithHidden="true" focusMode="row" id="grdTcmConstPcostList" readOnly="true" rowNumHeaderValue="No"
				rowNumVisible="" rowStatusHeaderValue="" rowStatusVisible="" rowStatusWidth="30" scrollByColumn="false"
				style="height: 162px;" useShiftKey="true" visibleRowNum="" ev:oncellclick="scwin.grdTcmConstPcostList_oncellclick"
				ev:onafteredit="scwin.grdTcmConstPcostList_onafteredit">
				<w2:header id="header1" style="">
					<w2:row id="row2" style="">
						<w2:column removeBorderStyle="false" width="70" inputType="checkbox" style="" id="column349"
							value="" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="300" inputType="text" id="column331" value="Item"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="text" id="column328" value="규격"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="text" id="column336" value="손익실행예산"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="text" id="column342" value="누계집행원가"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column334" value="공종선택"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="200" inputType="text" id="column338" value="집행원가"
							blockSelect="false" displayMode="label">
						</w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody id="gBody4" style="">
					<w2:row id="row5" style="">
						<w2:column removeBorderStyle="false" width="70" inputType="checkbox" style="" id="chkDel"
							value="" blockSelect="false" displayMode="label" readOnly="false">
						</w2:column>
						<w2:column removeBorderStyle="false" width="300" inputType="text" id="bgtItemiNm"
							blockSelect="false" displayMode="label" textAlign="left">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="text" id="bgtItemiStdr"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="text" id="plActbgtAmt"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="text" id="pcostAmt"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
						</w2:column>

						<w2:column blockSelect="false" displayMode="label" id="jobtyp" inputType="image"
							removeBorderStyle="false" width="100" imageSrc="/resources/images/content/ico_grid_find.png">
						</w2:column>

						<w2:column removeBorderStyle="false" width="200" inputType="text" id="rcpsRcgtPcostAmt"
							blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###"
							readOnly="false">
						</w2:column>
					</w2:row>
				</w2:gBody>
				<w2:footer style="" id="footer1">
					<w2:row style="" id="row6">
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column351"
							value="" blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="300" inputType="text" id="column348"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="text" id="column347" value="합계"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="expression" id="column346"
							blockSelect="false" displayMode="label" expression="sum('bgtAmt')" dataType="number" textAlign="right"
							displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="150" inputType="expression" id="column345"
							blockSelect="false" displayMode="label" expression="sum('asumPfmcAmt')" dataType="number" textAlign="right"
							displayFormat="#,###">
						</w2:column>
						<w2:column removeBorderStyle="false" width="90" inputType="text" id="column344"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="200" inputType="expression" id="totRcpsRcgtPcostAmt"
							blockSelect="false" displayMode="label" expression="sum('rcpsRcgtPcostAmt')" dataType="number" textAlign="right"
							displayFormat="#,###">
						</w2:column>
					</w2:row>
				</w2:footer>
			</w2:gridView>


			</xf:group>
		</xf:group>
	</xf:group>
</xf:group>



		</xf:group>
	</body>
</html>
