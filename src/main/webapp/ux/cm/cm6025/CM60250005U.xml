<?xml version="1.0" encoding="UTF-8"?>
<!-- <?xml-stylesheet href="/src/main/webapp/resources_ux/css/common.css" type="text/css"?>
<?xml-stylesheet href="/src/main/webapp/resources_ux/css/content.css" type="text/css"?> -->

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
			    <w2:dataList baseNode="list" repeatNode="map" style="" id="dsList" saveRemovedData="true"
			        ev:oncelldatachange="scwin.dsList_oncelldatachange" ev:oninsertrow="" ev:onbeforecelldatachange="">
			        <w2:columnInfo>
			            <w2:column id="siteCd" name="현장코드" dataType="text"></w2:column>
			            <w2:column id="chkDel" name="체크박스" dataType="text"></w2:column>
			            <w2:column id="siteNm" name="현장명" dataType="text"></w2:column>
			            <w2:column id="secResno" name="주민등록번호암호화" dataType="text"></w2:column>
			            <w2:column id="lbatnDt" name="출역일자" dataType="text"></w2:column>
			            <w2:column id="wkrNo" name="근로자번호" dataType="text"></w2:column>
			            <w2:column id="lbantSeq" name="출역순번" dataType="text"></w2:column>
			            <w2:column id="lbatnQty" name="출역수량" dataType="text"></w2:column>
			            <w2:column id="lbatnUct" name="출역단가" dataType="number"></w2:column>
			            <w2:column id="ivstGbVal" name="투자구분값" dataType="text"></w2:column>
			            <w2:column id="payGbVal" name="지급구분값" dataType="text"></w2:column>
			            <w2:column id="payDt" name="지급일자" dataType="text"></w2:column>
			            <w2:column id="payAmt" name="지급금액" dataType="number"></w2:column>
			            <w2:column id="ictxAmt" name="소득세금액" dataType="number"></w2:column>
			            <w2:column id="rstxAmt" name="주민세금액" dataType="number"></w2:column>
			            <w2:column id="ockndCd" name="직종코드" dataType="text"></w2:column>
			            <w2:column id="ockndNm" name="직종명" dataType="text"></w2:column>
			            <w2:column id="workCn" name="작업내용" dataType="text"></w2:column>
			            <w2:column id="netpayAmt" name="실지급금액" dataType="number"></w2:column>
			            <w2:column id="wkrNm" name="근로자명" dataType="text"></w2:column>
			            <w2:column id="fstRegprEmpno" name="최초등록자사번" dataType="text"></w2:column>
			            <w2:column id="fnlModprEmpno" name="최종등록자사번" dataType="text"></w2:column>
			            <w2:column id="bgtItemiCd" name="투입공종코드" dataType="text"></w2:column>
			            <w2:column id="bgtItemiNm" name="투입공종명" dataType="text"></w2:column>
			            <w2:column id="mskSecResno" name="주민번호마스킹" dataType="text"></w2:column>
			            <w2:column id="mskWkrNm" name="근로자명마스킹" dataType="text"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="true">
			            <!-- <w2:row></w2:row>
			                <w2:row></w2:row>
			                <w2:row></w2:row>
			                <w2:row></w2:row>
			                <w2:row></w2:row>
			                <w2:row></w2:row>
			                <w2:row></w2:row>
			                <w2:row></w2:row>
			                <w2:row></w2:row> -->
			        </w2:data>
			    </w2:dataList>
			    <w2:dataMap baseNode="map" id="dsSearchMap">
			        <w2:keyInfo>
			            <w2:key id="siteCd" name="현장코드" dataType="text"></w2:key>
			            <w2:key id="siteNm" name="현장명" dataType="text"></w2:key>
			            <w2:key id="lbatnDt" name="출역일자" dataType="text"></w2:key>
			        </w2:keyInfo>
			    </w2:dataMap>
			    <w2:dataList baseNode="list" ev:oncelldatachange="" id="dsTaxRate" repeatNode="map"
			        saveRemovedData="true" style="">
			        <w2:columnInfo>
			            <w2:column id="ddctAmt" name="공제금액" dataType="text"></w2:column>
			            <w2:column id="ictxRt" name="소득세율" dataType="text"></w2:column>
			            <w2:column id="rstxRt" name="주민세율" dataType="text"></w2:column>
			            <w2:column id="ddctRt" name="공제율" dataType="text"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="true"></w2:data>
			    </w2:dataList>
			    <w2:dataList baseNode="list" ev:oncelldatachange="" id="dsPreLbatnDt" repeatNode="map"
			        saveRemovedData="true" style="">
			        <w2:columnInfo>
			            <w2:column dataType="text" id='lbatnDt' name="출역일자"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="true"></w2:data>
			    </w2:dataList>
			    <w2:dataList baseNode="list" ev:oncelldatachange="" id="dsNextLbatnDt" repeatNode="map"
			        saveRemovedData="true" style="">
			        <w2:columnInfo>
			            <w2:column dataType="text" id="lbatnDt" name="출역일자"></w2:column>
			        </w2:columnInfo>
			        <w2:data use="true"></w2:data>
			    </w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
		</xf:model>
		<script src="/resources/js/common/cmn_CM.js" type="javascript" lazy="false"/>
		<script type="javascript" ><![CDATA[
/***************************************************************************
 * Program ID : CM60250005U.xml
 * Program Name : 일자별 출역일보 등록
 * Author : JHLEE
 * Date : 2022.06.15
 * 
 * History 
 * ======================================== 
 * 변경일자     수정자   내 용 
 * ======================================== 
 *    
 **************************************************************************/

	/**************************************************************************
	 * [1] 전역변수 선언
	 **************************************************************************/
 
	/**************************************************************************
	 * [2] onpageload(초기화포함)
	 **************************************************************************/
    scwin.onpageload = function() {   
        //추가 코드값 맵핑 호출
        scwin.fnInitial();
    };

    /** 화면초기화 **/
    scwin.fnInitial = function() {
		cmCom.setSite(wfmKeySiteInfo.getWindow());	               //세션의 현장코드를 셋팅
        calLbatnDt.setValue($p.getCurrentServerDate("yyyyMMdd"));  //당일날짜 셋팅
 		grdList.initGrid();	                                       //전도금사용내역목록 GRID 초기화
        com.commonUI();		                                       //UI팀용 함수 호출
        scwin.btnFind_onclick();                                   //자동조회
    };

	/**************************************************************************
	 * [3] 사용자정의 함수
	 **************************************************************************/
  	/**************************************************************************
	 * 함 수 명: scwin.fnSearchList
	 * 기 능: 일자별 출역일보 정보 조회
	 **************************************************************************/
	scwin.fnSearchList = function() {
        ajaxLib.ajax("/cm/cm6025/CM60250000U/selectTcmLabrLbatnDailyList",{
			method : "POST",
            requestData : dsSearchMap.getJSON(),
			callback : function(result, e){      
				dsList.setJSON(result.data.dsList); 
				com.setUdcValue("dsListCount", "udcListCount", dsList.getRowCount()); 		
                
                for(let fi = 0; fi < dsList.getRowCount(); fi++)
                {
                    let sLbatnQty = dsList.getCellData( fi ,  "lbatnQty");
                    if(sLbatnQty.indexOf(".") == -1)
                    {
                        dsList.setCellData( fi , "lbatnQty" , sLbatnQty + ".0");
                    } 
                }
                
                dsList.initRowStatus(); 
                
                //투입일보가 마감된 경우 추가,삭제,저장버튼 hidden 처리 
                ajaxLib.ajax("/cm/cm6025/CM60250000U/selectItemiCloseYn",{
                    method : "POST",
                    requestData : {
                            siteCd    : dsSearchMap.get("siteCd"),
                            lbatnDt   : dsSearchMap.get("lbatnDt")
                    },
                    callback : function(result, e){      
                       if (!com.isEmpty(result.data.dsItemiCloseYnMap)) {           
                            if(result.data.dsItemiCloseYnMap.closeYn == "Y"){  
                                btnSave.setStyle("display","none");
                                btnAddRow.setStyle("display","none");
                                btnDelRow.setStyle("display","none"); 
                            }
                            else
                            {
                                btnSave.setStyle("display","");
                                btnAddRow.setStyle("display","");
                                btnDelRow.setStyle("display","");
                            }
                       }
                       else
                       {
                            btnSave.setStyle("display","");
                            btnAddRow.setStyle("display","");
                            btnDelRow.setStyle("display",""); 
                       }
                    },
                     errCallback: function(result, e) {
                        console.log(result);
                    }
                });   
                		 
			},
			 errCallback: function(result, e) {
                console.log(result);
            }
		});
    };
    
    //출역자 (팝업) 호출
    scwin.fnWkrNmCall = function(data, callback){
        let popWkrNmOps = {
            popup_name :"출역자 목록",
            url :"/ux/cm/cm6020/CM60200021P.xml",
            data : {siteCd:dsSearchMap.get("siteCd"),colType:"S"},
            widType:"S",
            height:"620",
            callbackFn : callback
        };
        com.popup_open(popWkrNmOps);
    }

    //출역자 팝업선택 후 callback
    scwin.popWkrNmCallback = function(obj){
        if(obj != ""){
            let nPopFocusedRowIndex = grdList.getFocusedRowIndex();
            let sPopSecResno    = obj.secResno;
            let sPopWkrNm       = obj.wkrNm;
            let sPopOckndNm     = obj.ockndNm;
            let sPopOckndCd     = obj.ockndCd;
            let nPopOckndUct    = obj.ockndUct;
            let sPopWkrNo       = obj.wkrNo;
            let sPopMskWkrNm    = obj.mskWkrNm;
            let sPopMskSecResno = obj.mskSecResno;
            let sPopBgtItemiCd  = obj.bgtItemiCd;
            let sPopBgtItemiNm  = obj.bgtItemiNm;
            
            dsList.setCellData( nPopFocusedRowIndex , "mskSecResno" , sPopMskSecResno);  //주민번호 마스킹
            dsList.setCellData( nPopFocusedRowIndex , "secResno"    , sPopSecResno);     //주민번호
            dsList.setCellData( nPopFocusedRowIndex , "wkrNm"       , sPopWkrNm );       //근로자명 마스킹
            dsList.setCellData( nPopFocusedRowIndex , "mskWkrNm"    , sPopMskWkrNm );    //근로자명
            dsList.setCellData( nPopFocusedRowIndex , "ockndNm"     , sPopOckndNm );     //직종명
            dsList.setCellData( nPopFocusedRowIndex , "ockndCd"     , sPopOckndCd );     //직종코드
            dsList.setCellData( nPopFocusedRowIndex , "lbatnUct"    , nPopOckndUct );    //단가
            dsList.setCellData( nPopFocusedRowIndex , "wkrNo"       , sPopWkrNo );       //근로자번호
            
            // 노무자 기본사항에 투입공종이 있으면 default 공종을 입력해준다.
            dsList.setCellData( nPopFocusedRowIndex , "bgtItemiCd"   , sPopBgtItemiCd ); //투입공종코드
            dsList.setCellData( nPopFocusedRowIndex , "bgtItemiNm"   , sPopBgtItemiNm ); //투입공종명
            
            scwin.fnCal("1.0",nPopFocusedRowIndex);
            //개인별 출역일보 등록 화면에서는 신규 추가 시 체크, 일자별 출역일보 등록 화면에서는 신규 추가시 노무자 찾기 팝업이 자동호출되므로 이부분에 정의해야 함
            //fn_check_invest(row); AS-IS 투입공종 확인 (추후 반영 예정) 
        }
    } 

    //직종 (팝업) 호출
    scwin.fnOckndNmCall = function(data, callback){
        let popOckndNmOps = {
            popup_name :"직종 조회",
            url :"/ux/cm/cm6020/CM60200005P.xml",
            data : {},
            widType:"S",
            height:"620",
            callbackFn : callback
        };
        com.popup_open(popOckndNmOps);
    }

    //직종 팝업선택 후 callback
    scwin.popOckndNmCallback = function(obj){
        if(obj != ""){
            let nOckndRowIndex = grdList.getFocusedRowIndex();
            dsList.setCellData( nOckndRowIndex , "ockndCd" , obj.ockndCd ); //직종코드
            dsList.setCellData( nOckndRowIndex , "ockndNm" , obj.ockndNm ); //직종명
        }
    }      
       
    //투입공종 (팝업) 호출
    scwin.fnBgtItemiCall = function(data, callback){
        let popBgtItemiOps = {
            popup_name :"투입공종 조회",
            url :"/ux/cm/cm4010/CM40100515P.xml",
            data : data,
            widType:"XL",
            height:"700",
            callbackFn : callback
        };
        com.popup_open(popBgtItemiOps);
    }

    //투입공종 팝업선택 후 callback
    scwin.popBgtItemiNmCallback = function(obj){
        if(obj != ""){
            let nBgtItemRowIndex = grdList.getFocusedRowIndex();
            dsList.setCellData( nBgtItemRowIndex , "bgtItemiCd" , obj.bgtItemiCd );       //투입공종코드
            dsList.setCellData( nBgtItemRowIndex , "bgtItemiNm" , obj.bgtItemiNmNavi );   //투입공종명
        }
    }
    
	/**************************************************************************
	 * [4] Callback
	 **************************************************************************/


	/************************************************************************************
	 *  [5] Event 함수
	 ************************************************************************************/
    /**************************************************************************
     * Event: scwin.WFrameSiteInfo_change_callback
     * 기 능: 현장코드 변경 이벤트
     **************************************************************************/
	scwin.WFrameSiteInfo_change_callback = function() {
		dsSearchMap.set( "siteCd" , wfmKeySiteInfo.getWindow().ibxKeySiteCd.getValue());
		dsSearchMap.set( "siteNm" , wfmKeySiteInfo.getWindow().ibxKeySiteNm.getValue());	
        
        if (!com.isEmpty(dsSearchMap.get("lbatnDt"))){
            scwin.btnFind_onclick();
        }
	};

    /**************************************************************************
     * Event: scwin.btnFind_onclick
     * 기 능: 조회 버튼 Click 이벤트
     **************************************************************************/
	scwin.btnFind_onclick = function() {
	    if (com.isEmpty(dsSearchMap.get("siteCd"))){
	        com.showMessage("CMW0025", "현장");    //$1은(는) 필수입력사항입니다.
	        return false;
	    }
	    
	    if (com.isEmpty(dsSearchMap.get("lbatnDt"))){
	        com.showMessage("CMW0025", "출역일자"); //$1은(는) 필수입력사항입니다.
	        return false;
	    }

		scwin.fnSearchList();
	};
	
	/**************************************************************************
     * 함 수 명: scwin.btnExcelDwn_onclick
     * 기 능: 엑셀다운버튼 Click 이벤트
     **************************************************************************/
    scwin.btnExcelDwn_onclick = function() {
        let result = [];
        result.push(1);//checkbox 제외
       
        let totalCol = grdList.getTotalCol();
       
        for(let ex = 0; ex < totalCol; ex++) {
            if (!grdList.getColumnVisible(ex)) {
                result.push(ex);
            }
        }
        
        let excelOpt = {
             fileName: "일자별_출역일보_등록.xlsx"    //또는 xlsx 확장자 사용
            ,removeColumns: result.join(",")
            ,useSubTotal: true                      //colMerge된 컬럼을 Merge해서 출력 할 지 여부
            ,colMergeTextAlign: "center"            //colMerge된 컬럼의 textAlign설정 (bottom, center, top 설정)
            //,useStyle: "true"
            ,indent: 1
            ,useDataFormat : true
            , headerFontColor : "#FFFFFF"    // Header Font Color
            , headerColor : "#D9D9D9"        // Header Back Color
            , subTotalColor : "#FCE4D6"      // SubTotal Back Color
            , footerColor : "#BDD7EE"         // Footer Color
        };  //excel download 옵션
        
        grdList.advancedExcelDownload( excelOpt );          
    };

	/**************************************************************************
     * 함 수 명: scwin.btnBDt1D_onclick
     * 기 능: 이전버튼 Click 이벤트
     **************************************************************************/
	scwin.btnBDt1D_onclick = function() {
        ajaxLib.ajax("/cm/cm6025/CM60250000U/selectPreTcmLabrLbatnDaily",{
            method : "POST",
            mode : "synchronous",
            requestData : dsSearchMap.getJSON(),
            callback : function(result, e){      
               dsPreLbatnDt.setJSON(result.data.dsPreLbatnDt);
               
               if(dsPreLbatnDt.getRowCount() <= 0)
               {
                  com.showMessage("SCA0121", "이전자료가", "", "");   // 이전자료가 존재하지 않습니다.
                  return; 
               }
               
               calLbatnDt.setValue(dsPreLbatnDt.getCellData( 0 , "lbatnDt" ));
               scwin.btnFind_onclick();
            },
             errCallback: function(result, e) {
                console.log(result);
            }
        }); 
	};
    
	/**************************************************************************
     * 함 수 명: scwin.btnADt1D_onclick
     * 기 능: 다음버튼 Click 이벤트
     **************************************************************************/
	scwin.btnADt1D_onclick = function() {
        ajaxLib.ajax("/cm/cm6025/CM60250000U/selectNextTcmLabrLbatnDaily",{
            method : "POST",
            mode : "synchronous",
            requestData : dsSearchMap.getJSON(),
            callback : function(result, e){      
               dsNextLbatnDt.setJSON(result.data.dsNextLbatnDt);
               
               if(dsNextLbatnDt.getRowCount() <= 0)
               {
                  com.showMessage("SCA0121", "다음자료가", "", "");   // 다음자료가 존재하지 않습니다.
                  return; 
               }
               calLbatnDt.setValue(dsNextLbatnDt.getCellData( 0 , "lbatnDt" ));
               scwin.btnFind_onclick();
            },
             errCallback: function(result, e) {
                console.log(result);
            }
        });
	};
	
    /**************************************************************************
     * 함 수 명: scwin.grdList_oncellclick
     * 기 능: 일자별 출역일보 목록 그리드  Click 이벤트
     **************************************************************************/
	scwin.grdList_oncellclick = function(row,col) {
        let sColunmName = grdList.getColumnID( col );
        
        if(sColunmName == "popWkrNm") //출역자(팝업)
        {
            //신규입력시에 출역자 팝업을 호출할 수 있습니다.
            if(dsList.getRowStatus( row ) != "C")
            {
                com.showMessage("SMA0058", "신규입력시에만 출역자 팝업을 호출할 수 있습니다.");   
                return;   
            }
            else
            {
                scwin.fnWkrNmCall(
                    {},
                    "scwin.popWkrNmCallback"
                );
            }
        }
        else if(sColunmName == "popOckndNm")    //직종(팝업)	
        {
            scwin.fnOckndNmCall(
                {},
                "scwin.popOckndNmCallback"
            );        
        }	
        else if(sColunmName == "popBgtItemiNm") //투입공종(팝업)    
        {
            scwin.fnBgtItemiCall(
                {
                    siteCd  : dsSearchMap.get("siteCd"),
                    itexpGb : 'O,D,T',
                    multiSelectYn : false
                },
                "scwin.popBgtItemiNmCallback"
            );        
        }           
	};
	
    /*신규 행 추가 */
	scwin.btnAddRow_onclick = function(val) {
        if(com.isEmpty(val))
        {
            //신규 추가  전 투입일보 마감 여부 체크
            ajaxLib.ajax("/cm/cm6025/CM60250000U/selectItemiCloseYn",{
                    method : "POST",
                    requestData : {
                            siteCd    : dsSearchMap.get("siteCd"),
                            lbatnDt   : dsSearchMap.get("lbatnDt")
                    },
                    callback : function(result, e){      
                       if (!com.isEmpty(result.data.dsItemiCloseYnMap)) {           
                            if(result.data.dsItemiCloseYnMap.closeYn == "Y"){   
                                com.showMessage("CMW0018", "투입일보"); //해당월의 $1이(가) 마감되었습니다
                                return false;
                            }
                        }
                        
                        scwin.btnAddRow_onclick("ADD");
                    },
                     errCallback: function(result, e) {
                        console.log(result);
                    }
            });   
        }
        
        if(val == "ADD")
        {
            //현장코드 입력이 되어있는지 체크 
            if (com.getUdcValue("wfmKeySiteInfo", "ibxKeySiteNm") == "" || com.getUdcValue("wfmKeySiteInfo", "ibxKeySiteCd") == "")
            {
                com.showMessage("EMW0001", "현장");       // $1을(를) 입력하십시오.
                return;
            }
     
            if (calLbatnDt.getValue() == "")
            {
                com.showMessage("EMW0001", "출역일자");   // $1을(를) 입력하십시오.
                return;
            }
            
            //위에 항목중 변경된 row가 있는지 체크 변경된 사항이 있으면 저장후 신규 추가되도록 수정
            let checkList = dsList.getModifiedJSON();

            // 수정여부 체크
            if (checkList.length > 0) {
                com.showMessage("SMA0048", ""); // 변경된 내용이 있습니다. 저장 후 진행하시기 바랍니다.
                return;
            }
            
            let rowInsertIndex = dsList.insertRow();
            
            dsList.setCellData( rowInsertIndex , "lbatnDt" , calLbatnDt.getValue());  //출역일자
            dsList.setCellData( rowInsertIndex , "lbatnQty" ,"1.0");                  //출역수량
            dsList.setCellData( rowInsertIndex , "payGbVal" ,"2");                    //지급구분(1:전도금 2:미지급금)
    		dsList.setCellData( rowInsertIndex , "lbatnUct" ,0);                      //단가
    		dsList.setCellData( rowInsertIndex , "payAmt"   ,0);                      //지급액
    		dsList.setCellData( rowInsertIndex , "ictxAmt"  ,0);                      //소득세
    		dsList.setCellData( rowInsertIndex , "rstxAmt"  ,0);                      //주민세
    		dsList.setCellData( rowInsertIndex , "netpayAmt",0);                      //실지급액
            
            grdList.setFocusedCell( rowInsertIndex , "netpayAmt" , false ); 
            
            //행 추가시 노무자 조회 팝업 자동 open
            scwin.fnWkrNmCall(
                {},
                "scwin.popWkrNmCallback"
            );
        }
	};
    
    /*그리드 행삭제*/
	scwin.btnDelRow_onclick = function() {
        //삭제 전 투입일보 마감 여부 체크
        ajaxLib.ajax("/cm/cm6025/CM60250000U/selectItemiCloseYn",{
                method : "POST",
                requestData : {
                        siteCd    : dsSearchMap.get("siteCd"),
                        lbatnDt   : dsSearchMap.get("lbatnDt")
                },
                callback : function(result, e){      
                   if (!com.isEmpty(result.data.dsItemiCloseYnMap)) {			
    					if(result.data.dsItemiCloseYnMap.closeYn == "Y"){	
    						com.showMessage("CMW0018", "투입일보");	//해당월의 $1이(가) 마감되었습니다
    	        			return false;
    					}
         			}
                    
                    let idxArr = grdList.getCheckedIndex("chkDel");

                    if (idxArr.length == 0) {
                        com.showMessage("SMA0031", "삭제"); //$1할 행이 선택되지 않았습니다.
                        return;
                    }
                
                    dsList.removeRows( idxArr );     
                },
                 errCallback: function(result, e) {
                    console.log(result);
                }
        });   
	};
	
    /*출력일자 커서 이동 시 자동 조회*/
	scwin.calLbatnDt_onviewchange = function(info) {
		scwin.btnFind_onclick();
	};
	
    /*출력일자 엔터키 입력 시 자동 조회*/
	scwin.calLbatnDt_onkeydown = function(e) {
        if(e.keyCode == '13'){
			scwin.btnFind_onclick();
    	}
	};
    
    /*출역자 검색 후 단가로 인한 값 계산 자동 처리*/
    scwin.fnCal = function(newValue,rowIndex)
    {
        if(newValue.indexOf(".") == -1)
            {
                dsList.setCellData( rowIndex , "lbatnQty", newValue + ".0" );
            }
            else
            {
                //소수점.뒤에 한자리까지만 표기하도록 처리 
                let selIdx2  =  newValue.indexOf(".");
                let lenSize2 =  selIdx2+2;
                dsList.setCellData( rowIndex , "lbatnQty", newValue.substring(0,lenSize2));
            }
            
            let rowIndex2         = rowIndex;
            let val2              = newValue;
            let payAmt2           = 0;   //지급액
            let deductionAmt2     = 0;   //공제금액
            let netpayAmt2        = 0;   //실지급액
            let ictxAmt2          = 0;   //소득세액
            let rstxAmt2          = 0;   //주민세액
            let workAmt2          = 0;   //과세금액
            let compAmt2          = 0;   //산출세액
            let taxDeduction2     = 0;   //세액공제
            let ictxAmtTaxRate2   = 0;   //소득세율
            let deductionTaxRate2 = 0;   //공제세율
            let rstxAmtTaxRate2   = 0;   //주민세율
            
            ajaxLib.ajax("/cm/cm6025/CM60250000U/selectTcmLabrLbatnDailyTaxRate",{
                method : "POST",
                requestData : dsSearchMap.getJSON(),
                callback : function(result, e){      
                   dsTaxRate.setJSON(result.data.dsTaxRate);
                   
                   if(dsTaxRate.getRowCount() > 0)
                   {
                       deductionAmt2     = dsTaxRate.getCellData( 0 , "ddctAmt");        //공제금액
                       ictxAmtTaxRate2   = dsTaxRate.getCellData( 0 , "ictxRt") * 0.01;  //소득세율
                       rstxAmtTaxRate2   = dsTaxRate.getCellData( 0 , "rstxRt") * 0.01;  //주민세율
                       deductionTaxRate2 = dsTaxRate.getCellData( 0 , "ddctRt") * 0.01;  //공제율
                   }
                   //지급총액
                   payAmt2 = val2 *  dsList.getCellData( rowIndex , "lbatnUct"); //공수*단가
                   
                   // 지급총액 > 공제금액
                   if(payAmt2 > deductionAmt2)
                   {
                       workAmt2 =  payAmt2 - deductionAmt2;                         // 과세금액 : 지급총액 - 공제금액 
                       compAmt2 =  parseInt(workAmt2 * ictxAmtTaxRate2);            // 산출세액 : 과세금액 * 소득세율
                       taxDeduction2 =  parseInt(compAmt2 * deductionTaxRate2);     // 세액공제 : 산출세액 * 공제세율
                       ictxAmt2 = parseInt((compAmt2 - taxDeduction2) * 0.1) * 10;  // 소득세액 : 산출세액 - 세액공제 (원단위절삭, 100원미만 면세)
                       
                       if (ictxAmt2 < 100) {
                           ictxAmt2 = 0; 
                       }
                       
                       rstxAmt2   = ictxAmt2 * rstxAmtTaxRate2 * 0.1 * 10;          // 주민세액 : 소득세액 * 주민세율 (원단위절삭)
                       netpayAmt2 = payAmt2 - ictxAmt2 - rstxAmt2;                  // 실지급액 : 지급총액 - ( 소득세 + 주민세)
                   }        
                   else
                   {
                       // 실지급액
                       netpayAmt2 = payAmt2;
                       // 소득세액
                       ictxAmt2   = 0;
                       // 주민세액
                       rstxAmt2   = 0;
                   }
                   
                   // 지급액
                   dsList.setCellData( rowIndex , "payAmt" , payAmt2 );
                   // 실지급액
                   dsList.setCellData( rowIndex , "netpayAmt" , netpayAmt2 );
                   // 소득세액
                   dsList.setCellData( rowIndex , "ictxAmt" , ictxAmt2 );
                   // 주민세액
                   dsList.setCellData( rowIndex , "rstxAmt" , rstxAmt2 );                    
                },
                 errCallback: function(result, e) {
                    console.log(result);
                }
            });     
    }

    /*그리드 공수 변경 시 */
	scwin.dsList_oncelldatachange = function(info) {
        // 공수
        if(info.colID == "lbatnQty"){ 
            if(info.newValue.indexOf(".") == -1)
            {
                dsList.setCellData( info.rowIndex , "lbatnQty", info.newValue + ".0" );
            }
            else
            {
                //소수점.뒤에 한자리까지만 표기하도록 처리 
                let selIdx  =  info.newValue.indexOf(".");
                let lenSize =  selIdx+2;
                dsList.setCellData( info.rowIndex , "lbatnQty", info.newValue.substring(0,lenSize));
            }
            
            let rowIndex         = info.rowIndex;
            let colId            = info.colID;
            let val              = info.newValue;
            let payAmt           = 0;   //지급액
            let deductionAmt     = 0;   //공제금액
            let netpayAmt        = 0;   //실지급액
            let ictxAmt          = 0;   //소득세액
            let rstxAmt          = 0;   //주민세액
            let workAmt          = 0;   //과세금액
            let compAmt          = 0;   //산출세액
            let taxDeduction     = 0;   //세액공제
            let ictxAmtTaxRate   = 0;   //소득세율
            let deductionTaxRate = 0;   //공제세율
            let rstxAmtTaxRate   = 0;   //주민세율
            
            ajaxLib.ajax("/cm/cm6025/CM60250000U/selectTcmLabrLbatnDailyTaxRate",{
                method : "POST",
                requestData : dsSearchMap.getJSON(),
                mode : "synchronous",
                callback : function(result, e){      
                   dsTaxRate.setJSON(result.data.dsTaxRate);
                   
                   if(dsTaxRate.getRowCount() > 0)
                   {
                       deductionAmt     = dsTaxRate.getCellData( 0 , "ddctAmt");        //공제금액
                       ictxAmtTaxRate   = dsTaxRate.getCellData( 0 , "ictxRt") * 0.01;  //소득세율
                       rstxAmtTaxRate   = dsTaxRate.getCellData( 0 , "rstxRt") * 0.01;  //주민세율
                       deductionTaxRate = dsTaxRate.getCellData( 0 , "ddctRt") * 0.01;  //공제율
                   }
                   //지급총액
                   payAmt = val *  dsList.getCellData( rowIndex , "lbatnUct"); //공수*단가
                   
                   // 지급총액 > 공제금액
                   if(payAmt > deductionAmt)
                   {
                       workAmt =  payAmt - deductionAmt;                         // 과세금액 : 지급총액 - 공제금액 
                       compAmt =  parseInt(workAmt * ictxAmtTaxRate);            // 산출세액 : 과세금액 * 소득세율
                       taxDeduction =  parseInt(compAmt * deductionTaxRate);     // 세액공제 : 산출세액 * 공제세율
                       ictxAmt = parseInt((compAmt - taxDeduction) * 0.1) * 10;  // 소득세액 : 산출세액 - 세액공제 (원단위절삭, 100원미만 면세)
                       
                       if (ictxAmt < 100) {
                           ictxAmt = 0; 
                       }
                       
                       rstxAmt   = ictxAmt * rstxAmtTaxRate * 0.1 * 10;          // 주민세액 : 소득세액 * 주민세율 (원단위절삭)
                       netpayAmt = payAmt - ictxAmt - rstxAmt;                   // 실지급액 : 지급총액 - ( 소득세 + 주민세)
                   }        
                   else
                   {
                       // 실지급액
                       netpayAmt = payAmt;
                       // 소득세액
                       ictxAmt   = 0;
                       // 주민세액
                       rstxAmt   = 0;
                   }
                   
                   // 지급액
                   dsList.setCellData( rowIndex , "payAmt" , payAmt );
                   // 실지급액
                   dsList.setCellData( rowIndex , "netpayAmt" , netpayAmt );
                   // 소득세액
                   dsList.setCellData( rowIndex , "ictxAmt" , ictxAmt );
                   // 주민세액
                   dsList.setCellData( rowIndex , "rstxAmt" , rstxAmt );                    
                },
                 errCallback: function(result, e) {
                    console.log(result);
                }
            });  
        }
	};
	
    //저장 
	scwin.btnSave_onclick = function() {
		scwin.fnSave("");
	};
    
    //일자별 출역일보 저장
    scwin.fnSave = function(val) {
        let saveList = dsList.getModifiedJSON();

        // 수정여부 체크
        if (saveList.length == 0) {
            com.showMessage("SCA0007", "", "", ""); // 저장(변경된)할 목록이 없습니다.
            return;
        }
        
        if(com.isEmpty(val))
        {
            //수정 전 투입일보 마감 여부 체크
            ajaxLib.ajax("/cm/cm6025/CM60250000U/selectItemiCloseYn",{
                    method : "POST",
                    requestData : {
                            siteCd    : dsSearchMap.get("siteCd"),
                            lbatnDt   : dsSearchMap.get("lbatnDt")
                    },
                    callback : function(result, e){      
                       if (!com.isEmpty(result.data.dsItemiCloseYnMap)) {			
        					if(result.data.dsItemiCloseYnMap.closeYn == "Y"){	
        						com.showMessage("CMW0018", "투입일보");	//해당월의 $1이(가) 마감되었습니다
        	        			return false;
        					}
             			}
                        
                        scwin.fnSave("SAVE"); 
                    },
                     errCallback: function(result, e) {
                        console.log(result);
                    }
            });   
        }
        else if(val == "SAVE")
        {
            // 유효성 체크
            for (let si = 0; si < dsList.getRowCount(); si++)
            {
                let sWkrNm      = dsList.getCellData(si,"wkrNm"   );     //출역자
                let sOckndCd    = dsList.getCellData(si,"ockndCd" );     //직종코드
                let sBgtItemiCd = dsList.getCellData(si,"bgtItemiCd" );  //예산내역코드
                let sSecResno   = dsList.getCellData(si,"secResno" );    //주민번호
                
                if(dsList.getRowStatus(i) != "R")
                {
                    if(sWkrNm == "")
                    {
                        com.showMessage("CMW0025", (si + 1) + "행의 출역자"); //$1은(는) 필수입력사항입니다.
                        return false;
                    }
                    
                    if (sOckndCd == "") {
                        com.showMessage("CMW0025", (si + 1) + "행의 직종");  //$1은(는) 필수입력사항입니다.
                        return false;
                    }
                    
                    if (sBgtItemiCd == "") {
                        com.showMessage("CMW0025", (si + 1) + "행의 투입공종");  //$1은(는) 필수입력사항입니다.
                        return false;
                    } 
                }
                //주민번호,투입공종 중복 체크 
                for(let sj = si+1; sj < dsList.getRowCount(); sj++)
                {
                    let conBgtItemiCd = dsList.getCellData(sj,"bgtItemiCd");
                    let conSecResno   = dsList.getCellData(sj,"secResno");
                    
                    if(conBgtItemiCd == sBgtItemiCd && conSecResno == sSecResno)
                    {
                        com.showMessage("EMA0043", "주민번호|투입공종이 중복되었습니다. 확인 해 주세요.");
                        return false;
                    }
                }
                
                if(dsList.getRowStatus(si) == "C")
                {
                    dsList.setCellData(si,"siteCd",dsSearchMap.get("siteCd"));
                }
            }
    
            //fn_check_invest(row); AS-IS 투입공종 확인 (추후반영예정)
    
            if (confirm("저장 하시겠습니까?")) {
                ajaxLib.ajax("/cm/cm6025/CM60250000U/insertTcmLabrLbatnDaily", {
                    method : "POST",
                    requestData : {
                        tcmLabrLbatnDailyList : dsList.getModifiedJSON()
                    },
                    callback : function(result, e){
                        if (result.data.R_FLAG == "S"){
                            com.showMessage("CFA0012"); //저장되었습니다.
                            scwin.btnFind_onclick();
                        } else {                            
                            com.showMessage("CFW0010", result.data.R_MSG);  //에러메세지.        
                        }
                    },
                    errCallback: function(result, e) {
                       com.showMessage("CFE0200","일자별 출역일보 등록");// $1 처리시 오류가 발생하였습니다.
                    }
                });
            }        
        }
    };    
	

]]></script>
	<w2:require src="/ux/common/udc/udcListCount.xml"></w2:require>
	<w2:require src="/ux/common/udc/udcPeriodcalendar.xml"></w2:require>
	<w2:require src="/ux/common/udc/udcYearMonthcalendar.xml"></w2:require>
	<!-- <w2:require src="/sono-ep-web/src/main/webapp/WEB-INF/ux/common/udc/udcYearMonthcalendar.xml"></w2:require>
	<w2:require src="/src/main/webapp/WEB-INF/ux/common/udc/udcAddress.xml"></w2:require>
	<w2:require src="/src/main/webapp/WEB-INF/ux/common/udc/udcYearMonthcalendar.xml"></w2:require> -->

	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">

		<xf:group style="" id="" class="content_body">
			<xf:group class="navigator_wrap" id="" style="">
				<xf:group class="navigator" id="" style="">
					<w2:wframe id="wfm_title" src="/ux/common/navigator.xml" style=""></w2:wframe>
				</xf:group>
			</xf:group>
			<xf:group class="tbl_search" id="" style="">


				<xf:group class="tb_list" id="" style="" tagname="table">
					<w2:attributes>
						<w2:summary>조회조건 테이블 입니다.</w2:summary>
					</w2:attributes>
					<xf:group tagname="colgroup">
						<xf:group style="width:94px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
						<xf:group style="width:94px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
						<xf:group style="width:94px;" tagname="col"></xf:group>
						<xf:group style="width:auto;" tagname="col"></xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group class="w2tb_th req" style="" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span class="" id="" label="현장명" style=""></w2:span>
						</xf:group>
						<xf:group class="w2tb_td" style="" tagname="td">
							<w2:wframe id="wfmKeySiteInfo" src="/WEB-INF/ux/cm/cmcomm/schSiteInfo.xml" style=""></w2:wframe>
						</xf:group>
						
						<xf:group class="w2tb_th req" style="" tagname="th">
							<w2:attributes>
								<w2:scope>row</w2:scope>
							</w2:attributes>
							<w2:span class="" id="" label="출역일자" style=""></w2:span>
						</xf:group>
						<xf:group class="w2tb_td" style="" tagname="td">
							<w2:inputCalendar calendarClass="" calendarValueType="yearMonthDate" focusOnDateSelect="false"
                                footerDiv="false" id="calLbatnDt" renderDiv="true" renderType="component" rightAlign="false" style="width: 100px;"
                                weekStartsOn="0" ref="data:dsSearchMap.lbatnDt" ev:ondateselect="" ev:onkeyup="" ev:onviewchange="scwin.calLbatnDt_onviewchange" ev:onkeydown="scwin.calLbatnDt_onkeydown">
                            </w2:inputCalendar>
							<w2:anchor class="btn_gcm period" clickEventElement="outerDiv" id="btnBDt1D" outerDiv="false"
								style="" ev:onclick="scwin.btnBDt1D_onclick">
								<xf:label><![CDATA[이전]]></xf:label>
							</w2:anchor>
							<w2:anchor class="btn_gcm period" clickEventElement="outerDiv" id="btnADt1D" outerDiv="false"
								style="" ev:onclick="scwin.btnADt1D_onclick">
								<xf:label><![CDATA[다음]]></xf:label>
							</w2:anchor>
						</xf:group>
					</xf:group>
				</xf:group>
				<xf:group class="btn_tbl_search" style="" tagname="">
					<w2:anchor class="btn_sh" id="btnFind" outerDiv="false" style="" ev:onclick="scwin.btnFind_onclick">
						<xf:label><![CDATA[조회]]></xf:label>
					</w2:anchor>
				</xf:group>

			</xf:group>

			<xf:group style="" id="" class="defaultbox">
				<w2:udc_list_count id="dsListCount"></w2:udc_list_count>
				<xf:group class="right_wrap" id="" style="">
					<xf:group id="" style="height:27px;">
						<w2:anchor class="btn_gcm" clickEventElement="" id="btnSave" outerDiv="false" style="" ev:onclick="scwin.btnSave_onclick">
                            <xf:label><![CDATA[저장]]></xf:label>
                        </w2:anchor>
                        <w2:anchor class="btn_gcm row_add" clickEventElement="" id="btnAddRow" outerDiv="false" style=""
                            toolTip="행추가" ev:onclick="scwin.btnAddRow_onclick">
                            <xf:label><![CDATA[행추가]]></xf:label>
                        </w2:anchor>
                        <w2:anchor class="btn_gcm row_del" clickEventElement="" id="btnDelRow" outerDiv="false" style=""
                            toolTip="행삭제" ev:onclick="scwin.btnDelRow_onclick">
                            <xf:label><![CDATA[행삭제]]></xf:label>
                        </w2:anchor>
                        <w2:anchor class="btn_gcm excel_down" clickEventElement="" ev:onclick="scwin.btnExcelDwn_onclick" id="btnExcelDwn"
							localeRef="" outerDiv="false" style="" toolTip="엑셀다운로드">
							<xf:label><![CDATA[엑셀다운로드]]></xf:label>
						</w2:anchor>
					</xf:group>
				</xf:group>
			</xf:group>
			<w2:gridView autoFit="allColumn" class="autoHeight" id="grdList" dataList="data:dsList" editModeEvent="onclick"
			    fixedColumnWithHidden="true" focusMode="row" keyMoveEditMode="true" readOnly="true" rowNumHeaderValue="No" rowNumVisible=""
			    rowStatusHeaderValue="" rowStatusVisible="" rowStatusWidth="30" scrollByColumn="false" style="height: 215px;"
			    tooltipDisplay="true" useShiftKey="true" visibleRowNum="" preventAddRowOnPaste="true" enterKeyMove="down" ev:oncellindexchange=""
			    ev:oncellclick="scwin.grdList_oncellclick" preventPaste="true">
			    <w2:header id="header1" style="">
			        <w2:row id="row2" style="">
			            <w2:column blockSelect="false" id="column21" fixColumnWidth="true" inputType="text" value="No" width="40"
			                style="height:68px;" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="37" inputType="checkbox" style="height:69px;" id="column259" value=""
			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="text" style="height:69px;" id="column255" value="개인번호"
			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column blockSelect="false" id="column81" displayMode="label" inputType="text" removeBorderStyle="false"
			                value="주민번호" width="120" style="height:69px;" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column blockSelect="false" id="column78" colSpan="2" class="req" displayMode="label" inputType="text"
			                removeBorderStyle="false" value="출역자" width="100" rowSpan="2" style="height:68px;">
			            </w2:column>
			            <w2:column blockSelect="false" id="column76" displayMode="label" fixColumnWidth="" inputType="text"
			                removeBorderStyle="false" value="직종" width="100" style="height:68px;" colSpan="2" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="text" style="height:69px;" id="column221" value="공수"
			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="80" inputType="text" style="height:69px;" id="column223" value="단가"
			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="330" inputType="text" style="height:68px;" id="column229" value="투입공종"
			                blockSelect="false" displayMode="label" class="req" colSpan="2" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="height:69px;" id="column262" value="지급액"
			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="140" inputType="text" style="height:35px;" id="column265" value="공제내역"
			                blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="height:69px;" id="column271" value="실지급액"
			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="250" inputType="text" style="height:69px;" id="column274" value="작업내용"
			                blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
			            </w2:column>
			        </w2:row>
			        <w2:row style="" id="row11">
			            <w2:column removeBorderStyle="false" width="75" inputType="text" style="" id="column280" value="소득세"
			                blockSelect="false" displayMode="label">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="75" inputType="text" style="" id="column279" value="주민세"
			                blockSelect="false" displayMode="label">
			            </w2:column>
			        </w2:row>
			    </w2:header>
			    <w2:gBody id="gBody4" style="">
			        <w2:row id="row5" style="">
			            <w2:column blockSelect="false" expression="rowindex()+1" fixColumnWidth="true" id="column24" inputType="expression"
			                readOnly="true" width="40">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="checkbox" style="" id="chkDel" value=""
			                blockSelect="false" displayMode="label" readOnly="false">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="wkrNo" value="" blockSelect="false"
			                displayMode="label" dataType="text" textAlign="center">
			            </w2:column>
			            <w2:column blockSelect="false" displayMode="label" id="mskSecResno" dataType="text" inputType="text" readOnly="true"
			                removeBorderStyle="false" width="120" viewType="" textAlign="center">
			            </w2:column>
			            <w2:column blockSelect="false" displayMode="label" id="wkrNm" inputType="text" readOnly="true"
			                removeBorderStyle="false" textAlign="left" width="70" dataType="text">
			            </w2:column>

			            <w2:column removeBorderStyle="false" width="30" inputType="image" style="" id="popWkrNm" value=""
			                blockSelect="false" displayMode="label" class="bl0" imageSrc="/resources/images/content/ico_grid_find.png"
			                viewType="icon" textAlign="right" readOnly="false">
			            </w2:column>
			            <w2:column blockSelect="false" displayMode="label" id="ockndNm" dataType="text" fixColumnWidth="" inputType="text"
			                removeBorderStyle="false" width="70" textAlign="left" displayFormat="">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="30" inputType="image" style="" id="popOckndNm" value=""
			                blockSelect="false" displayMode="label" viewType="icon" textAlign="right" class="bl0"
			                imageSrc="/resources/images/content/ico_grid_find.png" readOnly="false">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="lbatnQty" value="" blockSelect="false"
			                displayMode="label" dataType="text" displayFormat="" textAlign="right" readOnly="false" allowChar="0-9.">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="80" inputType="text" style="" id="lbatnUct" value=""
			                blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right" readOnly="true" allowChar="0-9">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="300" inputType="text" style="" id="bgtItemiNm" value="" blockSelect="false"
			                displayMode="label" textAlign="left" dataType="text">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="30" inputType="image" style="" id="popBgtItemiNm" value=""
			                blockSelect="false" displayMode="label" viewType="icon" textAlign="right"
			                imageSrc="/resources/images/content/ico_grid_find.png" class="bl0" readOnly="false">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="payAmt" value=""
			                blockSelect="false" displayMode="label" textAlign="right" dataType="number" displayFormat="#,###">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="75" inputType="text" style="" id="ictxAmt" value=""
			                blockSelect="false" displayMode="label" textAlign="right" displayType="" displayFormat="#,###" dataType="number">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="75" inputType="text" style="" id="rstxAmt" value=""
			                blockSelect="false" displayMode="label" textAlign="right" displayType="" displayFormat="#,###" dataType="number">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="" id="netpayAmt" value=""
			                blockSelect="false" displayMode="label" textAlign="right" displayType="" displayFormat="#,###" dataType="number">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="250" inputType="text" style="" id="workCn" value=""
			                blockSelect="false" displayMode="label" textAlign="left" dataType="text" readOnly="false">
			            </w2:column>
			        </w2:row>
			    </w2:gBody>
			    <w2:footer style="" id="footer2">
			        <w2:row style="" id="row10">
			            <w2:column removeBorderStyle="false" width="40" inputType="text" style="height:35px;" id="column254" value=""
			                blockSelect="false" displayMode="label">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="text" style="" id="column261" value=""
			                blockSelect="false" displayMode="label">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="text" style="height:35px;" id="column258"
			                value="합 &amp;nbsp;계" blockSelect="false" displayMode="label">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="129" inputType="text" style="height:35px;" id="column253" value=""
			                blockSelect="false" displayMode="label">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="text" style="height:35px;" id="column251" value=""
			                blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="" style="height:35px;" id="column250" value=""
			                blockSelect="false" displayMode="label" expression="" dataType="text" displayFormat="" textAlign="right" colSpan="2"
			                rowSpan="">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="70" inputType="expression" style="height:35px;" id="column249" value=""
			                blockSelect="false" displayMode="label" dataType="number" displayFormat="#.0" textAlign="right"
			                expression="sum('lbatnQty')">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="80" inputType="expression" style="height:35px;" id="column299" value=""
			                blockSelect="false" displayMode="label" dataType="number" displayFormat="#,###" textAlign="right"
			                expression="sum('lbatnUct')">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="330" inputType="text" style="height:35px;" id="column245" value=""
			                blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="expression" style="" id="column264" value=""
			                blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" expression="sum('payAmt')" textAlign="right">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="75" inputType="expression" style="" id="column267" value=""
			                blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" expression="sum('ictxAmt')" textAlign="right">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="75" inputType="expression" style="" id="column270" value=""
			                blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" expression="sum('rstxAmt')" textAlign="right">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="100" inputType="expression" style="" id="column273" value=""
			                blockSelect="false" displayMode="label" displayFormat="#,###" dataType="number" expression="sum('netpayAmt')" textAlign="right">
			            </w2:column>
			            <w2:column removeBorderStyle="false" width="250" inputType="text" style="" id="column276" value=""
			                blockSelect="false" displayMode="label">
			            </w2:column>
			        </w2:row>
			    </w2:footer>
			</w2:gridView>
		</xf:group>
	</body>
</html>
